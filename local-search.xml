<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>TCPç²˜åŒ…å’Œæ‹†åŒ…</title>
    <link href="/2022/08/08/net-04/"/>
    <url>/2022/08/08/net-04/</url>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ªä¸œè¥¿åœ¨ç½‘ç»œç¼–ç¨‹ä¸­è€ç”Ÿå¸¸è°ˆçš„ä¸€ä¸ªé—®é¢˜äº†ï¼Œç½‘ä¸Šè¿™ä¸ªç›¸å…³çš„çŸ¥è¯†éå¸¸ä¹‹å¤šã€‚å¤šåˆ°æˆ‘å…³äºè¿™æ–¹ä¾¿å¤šæ‰“ä¸€ä¸ªå­—ï¼Œéƒ½æ˜¯é‡å¤çš„é‚£ç§ï¼Œå“ˆå“ˆå“ˆã€‚è¿˜æ˜¯ä»¥ç†è§£ä¸ºä¸»ã€‚</p><h2 id="TCP-x2F-IPåè®®åˆ†å±‚æ¨¡å‹"><a href="#TCP-x2F-IPåè®®åˆ†å±‚æ¨¡å‹" class="headerlink" title="TCP&#x2F;IPåè®®åˆ†å±‚æ¨¡å‹"></a>TCP&#x2F;IPåè®®åˆ†å±‚æ¨¡å‹</h2><p>ç½‘ç»œåˆ°åº•åˆ†å‡ å±‚ï¼Œæœ‰åˆ†ä¸ƒå±‚çš„ï¼Œæœ‰åˆ†å››å±‚çš„ï¼Œä¹Ÿæœ‰åˆ†äº”å±‚çš„ã€‚ä¸é’»ç‰›è§’å°–å“ˆï¼Œå¤§è‡´çœ‹ä¸€ä¸‹ã€‚</p><div class="note note-info">            <p>å¤§å­¦æ•™ç§‘ä¹¦ä¸­æœ‰è¯´åˆ†æˆ7å±‚ï¼Œä¹Ÿæœ‰è¯´åˆ†æˆ4å±‚çš„ï¼Œç¬”è€…è§‰å¾—4å±‚æ›´åˆé€‚ä¸€äº›ï¼Œåƒä¸ƒå±‚ä¸­çš„ç¬¬5ã€6å±‚å®Œå…¨ä¸æ˜¯å¿…é¡»çš„ï¼Œå°±ç®—æœ‰ä¹Ÿæ˜¯å„è‡ªåˆ¶å®šåè®®ï¼Œè€Œåˆ¶å®šåè®®çš„äººåŸºæœ¬ä¸ä¼šå»è€ƒè™‘ç¬¬5å±‚å«ä¼šè¯å±‚ç¬¬6å±‚å«è¡¨ç¤ºå±‚ï¼Œåœ¨ç§æœ‰åº”ç”¨å±‚åè®®ä¸­ï¼Œæ›´å¤šçš„æ˜¯ä¼šç§å®šä¸€ä¸ªæ¡æ‰‹äº’ä¿¡åè®®ï¼Œä»¥è¡¨ç¤ºé€šè®¯åŒæ–¹æ˜¯äº’ä¿¡çš„</p>          </div><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1h4z73s0oplj32yo1o01kx.jpg" alt="ç½‘ç»œé€šä¿¡åè®®åˆ†å±‚å›¾"></p><h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h3><ul><li>ä½ æƒ³ç”¨javaå†™ä¸€ä¸ªç½‘ç»œç¨‹åºï¼Œä½ å†™çš„è¿™ä¸ªç¨‹åºå°±æ˜¯åº”ç”¨å±‚</li><li>æ‰€ä»¥QQã€å¾®ä¿¡ã€ä»¥åŠä½ æ­£åœ¨ä½¿ç”¨çš„æµè§ˆå™¨ï¼Œéƒ½æ˜¯åº”ç”¨å±‚</li></ul><p>è¿™å±‚å°±æ˜¯æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„ï¼Œæˆ‘ä»¬å†™çš„ç»å¤§éƒ¨åˆ†ä»£ç å†™çš„ä¹Ÿå°±æ˜¯è¿™å±‚ã€‚</p><h3 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h3><ul><li>ä¼ è¾“å±‚è¦ä¹ˆèµ°TCPåè®®ï¼Œè¦ä¹ˆèµ°UDPåè®®ï¼Œæ²¡æœ‰ç¬¬ä¸‰ç§åè®®ã€‚</li><li>TCPåè®®çš„é€šä¿¡åŒæ–¹ï¼Œéœ€è¦çŸ¥é“å½¼æ­¤éƒ½åœ¨å®¶å‘†ç€ï¼Œä¸”ç”±å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥ã€‚</li><li>UDPåè®®ï¼Œå®¢æˆ·ç«¯çŸ¥é“æœåŠ¡å™¨å®¶ä½åœ¨å“ªï¼Œä½†å¹¶ä¸çŸ¥é“æœåŠ¡å™¨åœ¨ä¸åœ¨å®¶ï¼Œæ‰”æ¡æ¶ˆæ¯å»æœåŠ¡å™¨å®¶ï¼Œå¦‚æœæœåŠ¡å™¨ä¸åœ¨å®¶è¿™æ¡æ¶ˆæ¯å°±è¢«ä¸¢äº†ã€‚</li></ul><h3 id="å…¶ä»–çš„"><a href="#å…¶ä»–çš„" class="headerlink" title="å…¶ä»–çš„"></a>å…¶ä»–çš„</h3><p>å¤ªè¿‡åº•å±‚çš„æˆ‘ä»¬æ¥è§¦ä¸åˆ°ï¼Œç¼–ç¨‹è¯­è¨€å·²ç»å°è£…å¥½äº†ã€‚å†æˆ–è€…å¯èƒ½æ“ä½œç³»ç»Ÿä¹Ÿç»™ä½ å°è£…å¥½äº†ã€‚ç”¨å°±è¡Œäº†ã€‚</p><h2 id="ç²˜åŒ…å’Œæ‹†åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„"><a href="#ç²˜åŒ…å’Œæ‹†åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„" class="headerlink" title="ç²˜åŒ…å’Œæ‹†åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„"></a>ç²˜åŒ…å’Œæ‹†åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„</h2><p>å½’æ ¹ç»“åº•ï¼Œå°±æ˜¯TCPæ˜¯ä¸ªâ€œæµâ€åè®®ï¼Œæ²¡æœ‰ç•Œé™çš„ä¸€ä¸²æ•°æ®ã€‚TCPåº•å±‚å¹¶ä¸äº†è§£ä¸Šå±‚ä¸šåŠ¡æ•°æ®çš„å…·ä½“å«ä¹‰ï¼Œå®ƒä¼šæ ¹æ®TCPç¼“å†²åŒºçš„å®é™…æƒ…å†µè¿›è¡ŒåŒ…çš„åˆ’åˆ†ï¼Œæ‰€ä»¥åœ¨ä¸šåŠ¡ä¸Šè®¤ä¸ºï¼Œä¸€ä¸ªå®Œæ•´çš„åŒ…å¯èƒ½ä¼šè¢«TCPæ‹†åˆ†æˆå¤šä¸ªåŒ…è¿›è¡Œå‘é€ï¼Œä¹Ÿæœ‰å¯èƒ½æŠŠå¤šä¸ªå°çš„åŒ…å°è£…æˆä¸€ä¸ªå¤§çš„æ•°æ®åŒ…å‘é€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„TCPç²˜åŒ…å’Œæ‹†åŒ…é—®é¢˜ã€‚è¿™æ ·è¯´å¯èƒ½ä¸å¤ªç†è§£ï¼Œéšä¾¿æœç´¢ä¸€ä¸‹ä¸€å¤§å †ï¼Œçœ‹å‡ ç¯‡å°±å°±ç†è§£äº†ã€‚</p><h2 id="å¦‚ä½•è§£å†³"><a href="#å¦‚ä½•è§£å†³" class="headerlink" title="å¦‚ä½•è§£å†³"></a>å¦‚ä½•è§£å†³</h2><p>ä¸Šé¢è¯´äº†ï¼Œæ˜¯ä¸€ä¸ªæ²¡æœ‰ç•Œé™ä¸€ä¸²æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ è¾“æ•°æ®çš„æ—¶å€™åŠ ä¸ªç•Œé™ä¸å°±å¥½äº†ã€‚åŠ ç•Œé™çš„æ–¹å¼ä¹Ÿå°±æ˜¯è§£å†³æ–¹æ¡ˆï¼Œæœ‰ç›´æ¥åŠ åˆ†éš”ç¬¦çš„ï¼Œæœ‰è§„å®šæ¯æ¬¡æ¥æ”¶å­—èŠ‚é•¿åº¦çš„ï¼ˆä¸æ€ä¹ˆå¸¸ç”¨ï¼‰ï¼Œè¿˜æœ‰å°±æ˜¯æ¯æ¬¡å‘æŠ¥æ–‡ï¼Œåœ¨æŠ¥æ–‡çš„å¤´éƒ¨å‡ ä¸ªå­—èŠ‚ï¼Œå’Œæ¥æ”¶æ–¹è¯´ï¼Œæˆ‘è¦å‘å¤šå°‘å­—èŠ‚æ•°æ®çš„ï¼ˆå¸¸ç”¨ï¼ï¼ï¼‰ã€‚</p><p>nettyè§£å†³æ–¹æ¡ˆï¼šå…³æ³¨ä¸€ä¸‹è¿™ä¸¤ä¸ªç±»å³å¯ã€‚<code>LengthFieldBasedFrameDecoder</code>,<code>LengthFieldPrepender</code>è¿™ä¸¤ä¸ªç±»é‡‡ç”¨äº†åœ¨æŠ¥æ–‡å¤´éƒ¨å¢åŠ è¡¨ç¤ºæŠ¥æ–‡é•¿åº¦çš„æ•°æ®ã€‚</p><p>TIOé‡Œï¼Œå®˜ç½‘ä¸Šç¤ºä¾‹çš„ç¼–è§£ç è§£ç å™¨å·²ç»åšäº†ç²˜åŒ…å’Œæ‹†åŒ…çš„å¤„ç†ã€‚å¤„ç†æ–¹å¼åŒä¸Šã€‚ä¹‹å‰å†™çš„é‚£ç¯‡åšæ–‡å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œå°±æ˜¯é‡Œé¢çš„ç¼–è§£ç ä»£ç ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å¤šå¤šç†è§£ï¼Œç†è§£ä¹‹åå“ªæ€•è®©ä½ å†™ä¸€ä¸ªç®€å•çš„æ‹†åŒ…ç²˜åŒ…å¤„ç†æ–¹æ¡ˆä½ ä¹Ÿèƒ½å†™å‡ºæ¥ï¼Œä½†æ˜¯ï¼Œåœ¨æ¡†æ¶çš„æœ‰çš„æƒ…å†µä¸‹ï¼Œä¸å»ºè®®è‡ªå·±å»å†™ï¼Œå› ä¸ºè¿™ä¸ªç²˜åŒ…å’ŒåŠåŒ…å¤„ç†åœ¨å¤šçº¿ç¨‹ä¸­å¤„ç†èµ·æ¥ï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦æ‹¼æ¥æ•°æ®ï¼Œå¦‚æœç¬¬ä¸€æ¬¡å‘äº†ä¸€åŠï¼Œç¬¬äºŒæ¬¡æ€ä¹ˆå¤„ç†ï¼Œå¦‚æœæ”¶å¤šäº†ï¼Œåˆæ€ä¹ˆå¤„ç†ï¼Œå¹¶ä¸ç®€å•ã€‚ç°æˆçš„è½®å­å°±å¥½å¥½ç”¨ã€‚ğŸ˜ƒğŸ˜ƒ</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h50ai5k50pj32yo1o0dqo.jpg" alt="å¿«ä¹å·¥ä½œ æ—©æ—¥é€€ä¼‘"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>net</tag>
      
      <tag>netty</tag>
      
      <tag>tio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨T-IOå†™çš„ä¸€ä¸ªç®€æ˜“çš„èŠå¤©å®¤Demo</title>
    <link href="/2022/08/06/net-03/"/>
    <url>/2022/08/06/net-03/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ä¾æ®å®˜ç½‘ä¸Šçš„æ ·ä¾‹ç¨åŠ æ”¹é€ ï¼Œæ”¹æˆäº†ä¸€ä¸ªç®€çº¦çš„èŠå¤©å®¤Demoï¼Œå¦‚å®˜ç½‘ä¸Šæ‰€è¯´ï¼Œè¿™ä¸ªDemoå®é™…ä¸Šéƒ½å¯ä»¥æ”¾ç”Ÿäº§ä¸Šï¼ŒåŸºæœ¬çš„é€šä¿¡å·²ç»è§£å†³äº†ã€‚åªéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡é€‚é…ä¸€ä¸‹å³å¯ã€‚è¯ä¸å¤šè¯´ï¼Œç›´æ¥æ•´æµç¨‹ã€‚</p><h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>ç›®å‰åªç”¨åˆ°äº†æ ¸å¿ƒï¼Œå¼•å…¥å³å¯</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.t-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tio-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.8.2.v20220628-RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="ä¸€äº›å¸¸é‡"><a href="#ä¸€äº›å¸¸é‡" class="headerlink" title="ä¸€äº›å¸¸é‡"></a>ä¸€äº›å¸¸é‡</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatConst</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * ç»‘å®šçš„ç¾¤ç»„æ ‡è¯†     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> groupNo <span class="token operator">=</span> <span class="token string">"2333"</span><span class="token punctuation">;</span>    <span class="token comment">/**     * æœåŠ¡çš„ç«¯å£     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token number">8011</span><span class="token punctuation">;</span>    <span class="token comment">/**     * é»˜è®¤ä¸ºæœ¬æœºçš„IP     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ip <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ•°æ®åŒ…è½½ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºVo"><a href="#æ•°æ®åŒ…è½½ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºVo" class="headerlink" title="æ•°æ®åŒ…è½½ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºVo"></a>æ•°æ®åŒ…è½½ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºVo</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatPack</span> <span class="token keyword">extends</span> <span class="token class-name">Packet</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> body<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBody</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>body <span class="token operator">=</span> body<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æ¶ˆæ¯å¤´çš„é•¿åº¦ï¼Œåœ¨è¯»å–å†™å…¥æ—¶æˆ‘ä»¬ç”¨äº†Intç±»å‹</span>    <span class="token comment">// buffer.putInt(),ä»¥åŠbuffer.getInt()</span>    <span class="token comment">// æ‰€ä»¥ è¿™é‡Œä¸º4ä¸ªå­—èŠ‚é•¿åº¦ã€‚</span>    <span class="token comment">// æ³¨æ„è¿™é‡Œçš„é•¿åº¦ï¼Œå¹¶ä¸æ˜¯æŒ‡æ•°å­—çš„é•¿åº¦ï¼Œè€Œæ˜¯å­—èŠ‚é•¿åº¦ï¼è¯·åŠ¡å¿…ç†è§£ï¼Œ</span>    <span class="token comment">// æœ¬äººåœ¨è¿™é‡Œè¿·æƒ‘äº†æŒºé•¿æ—¶é—´ã€‚</span>    <span class="token comment">// æ­¤å¤„ä»£ç ä¹Ÿä¸å»ºè®®ä¿®æ”¹ï¼Œä¿®æ”¹çš„è¯éœ€è¦åŠ¨ç¼–è§£ç ä¸­çš„ä»£ç </span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> HEAD_LENGTH <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ChatPack</span> <span class="token function">getPack</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ChatPack</span> pack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChatPack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pack<span class="token punctuation">.</span><span class="token function">setBody</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> pack<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="ç¼–ç è§£ç "><a href="#ç¼–ç è§£ç " class="headerlink" title="ç¼–ç è§£ç "></a>ç¼–ç è§£ç </h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * å®¢æˆ·ç«¯æœåŠ¡ç«¯ç¼–ç è§£ç é€šç”¨ï¼Œä¸€èˆ¬æ— éœ€ä¿®æ”¹ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DecodeOrEncode</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * è§£ç      * @param buffer buffer     * @param readableLength å®é™…æ•°æ®é•¿åº¦     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Packet</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ByteBuffer</span> buffer<span class="token punctuation">,</span><span class="token keyword">int</span> readableLength<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TioDecodeException</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//æé†’ï¼šbufferçš„å¼€å§‹ä½ç½®å¹¶ä¸ä¸€å®šæ˜¯0ï¼Œåº”ç”¨éœ€è¦ä»buffer.position()å¼€å§‹è¯»å–æ•°æ®</span>        <span class="token comment">//æ”¶åˆ°çš„æ•°æ®ç»„ä¸äº†ä¸šåŠ¡åŒ…ï¼Œåˆ™è¿”å›nullä»¥å‘Šè¯‰æ¡†æ¶æ•°æ®ä¸å¤Ÿ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>readableLength <span class="token operator">&lt;</span> <span class="token class-name">ChatPack</span><span class="token punctuation">.</span>HEAD_LENGTH<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//è¯»å–æ¶ˆæ¯ä½“çš„é•¿åº¦</span>        <span class="token keyword">int</span> bodyLength <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ•°æ®ä¸æ­£ç¡®ï¼Œåˆ™æŠ›å‡ºAioDecodeExceptionå¼‚å¸¸</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bodyLength <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TioDecodeException</span><span class="token punctuation">(</span><span class="token string">"bodyLength ["</span> <span class="token operator">+</span> bodyLength <span class="token operator">+</span> <span class="token string">"] is not right, remote:"</span> <span class="token operator">+</span> channelContext<span class="token punctuation">.</span><span class="token function">getClientNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//è®¡ç®—æœ¬æ¬¡éœ€è¦çš„æ•°æ®é•¿åº¦</span>        <span class="token keyword">int</span> neededLength <span class="token operator">=</span> <span class="token class-name">ChatPack</span><span class="token punctuation">.</span>HEAD_LENGTH <span class="token operator">+</span> bodyLength<span class="token punctuation">;</span>        <span class="token comment">//æ”¶åˆ°çš„æ•°æ®æ˜¯å¦è¶³å¤Ÿç»„åŒ…</span>        <span class="token keyword">int</span> isDataEnough <span class="token operator">=</span> readableLength <span class="token operator">-</span> neededLength<span class="token punctuation">;</span>        <span class="token comment">// ä¸å¤Ÿæ¶ˆæ¯ä½“é•¿åº¦(å‰©ä¸‹çš„bufferç»„ä¸äº†æ¶ˆæ¯ä½“)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isDataEnough <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token comment">//ç»„åŒ…æˆåŠŸ</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">ChatPack</span> chatPack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChatPack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>bodyLength <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>bodyLength<span class="token punctuation">]</span><span class="token punctuation">;</span>                buffer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>                chatPack<span class="token punctuation">.</span><span class="token function">setBody</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> chatPack<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ç¼–ç      * @param packet æ•°æ®åŒ…     * @param tioConfig æŠ½è±¡     * @return buffer     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ByteBuffer</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token class-name">TioConfig</span> tioConfig<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ChatPack</span> chatPack <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ChatPack</span><span class="token punctuation">)</span> packet<span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> chatPack<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> bodyLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>body <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            bodyLen <span class="token operator">=</span> body<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//bytebufferçš„æ€»é•¿åº¦æ˜¯ = æ¶ˆæ¯å¤´çš„é•¿åº¦ + æ¶ˆæ¯ä½“çš„é•¿åº¦</span>        <span class="token keyword">int</span> allLen <span class="token operator">=</span> <span class="token class-name">ChatPack</span><span class="token punctuation">.</span>HEAD_LENGTH <span class="token operator">+</span> bodyLen<span class="token punctuation">;</span>        <span class="token comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„bytebuffer</span>        <span class="token class-name">ByteBuffer</span> buffer <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>allLen<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®å­—èŠ‚åº</span>        buffer<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span>tioConfig<span class="token punctuation">.</span><span class="token function">getByteOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å†™å…¥æ¶ˆæ¯å¤´----æ¶ˆæ¯å¤´çš„å†…å®¹å°±æ˜¯æ¶ˆæ¯ä½“çš„é•¿åº¦</span>        buffer<span class="token punctuation">.</span><span class="token function">putInt</span><span class="token punctuation">(</span>bodyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å†™å…¥æ¶ˆæ¯ä½“</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>body <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            buffer<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> buffer<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><p>æœåŠ¡ç«¯åŒ…æ‹¬ä¸‰ä¸ªç±»ï¼Œä¸€ä¸ªå¯åŠ¨ç±»ï¼Œä¸€ä¸ªHandlerå¤„ç†ç±»ï¼Œä¸€ä¸ªç›‘å¬ç±»</p><p>ç›‘å¬ç±»<br>ChatServerListener.java</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatServerListener</span> <span class="token keyword">implements</span> <span class="token class-name">TioServerListener</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * æœåŠ¡å™¨æ£€æŸ¥åˆ°å¿ƒè·³è¶…æ—¶æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼ˆä¸€èˆ¬åœºæ™¯ï¼Œè¯¥æ–¹æ³•åªéœ€è¦ç›´æ¥è¿”å›falseå³å¯ï¼‰     *     * @param interval              å·²ç»å¤šä¹…æ²¡æœ‰æ”¶å‘æ¶ˆæ¯äº†ï¼Œå•ä½ï¼šæ¯«ç§’     * @param heartbeatTimeoutCount å¿ƒè·³è¶…æ—¶æ¬¡æ•°ï¼Œç¬¬ä¸€æ¬¡è¶…æ—¶æ­¤å€¼æ˜¯1ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ­¤å€¼è¢«ä¿å­˜åœ¨ï¼šchannelContext.stat.heartbeatTimeoutCount     * @return è¿”å›trueï¼Œé‚£ä¹ˆæœåŠ¡å™¨åˆ™ä¸å…³é—­æ­¤è¿æ¥ï¼›è¿”å›falseï¼ŒæœåŠ¡å™¨å°†æŒ‰å¿ƒè·³è¶…æ—¶å…³é—­è¯¥è¿æ¥     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onHeartbeatTimeout</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token class-name">Long</span> interval<span class="token punctuation">,</span> <span class="token keyword">int</span> heartbeatTimeoutCount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>heartbeatTimeoutCount <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * å»ºé“¾åè§¦å‘æœ¬æ–¹æ³•ï¼Œæ³¨ï¼šå»ºé“¾ä¸ä¸€å®šæˆåŠŸï¼Œéœ€è¦å…³æ³¨å‚æ•°isConnected     *     * @param channelContext åŒ…ç½—ä¸‡è±¡     * @param isConnected    æ˜¯å¦è¿æ¥æˆåŠŸ,true:è¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œfalse:è¡¨ç¤ºè¿æ¥å¤±è´¥     * @param isReconnect    æ˜¯å¦æ˜¯é‡è¿, true: è¡¨ç¤ºè¿™æ˜¯é‡æ–°è¿æ¥ï¼Œfalse: è¡¨ç¤ºè¿™æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAfterConnected</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isConnected<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isReconnect<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isConnected<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--è¿›å…¥æˆ¿é—´..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">sendToGroup</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span>tioConfig<span class="token punctuation">,</span> <span class="token class-name">ChatConst</span><span class="token punctuation">.</span>groupNo<span class="token punctuation">,</span><span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--è¿›å…¥æˆ¿é—´..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ç»‘å®šç¾¤ç»„</span>            <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">bindGroup</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">,</span> <span class="token class-name">ChatConst</span><span class="token punctuation">.</span>groupNo<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åŸæ–¹æ³•åï¼šonAfterDecoded     * è§£ç æˆåŠŸåè§¦å‘æœ¬æ–¹æ³•     *     * @param channelContext åŒ…ç½—ä¸‡è±¡     * @param packet æ•°æ®åŒ…     * @param packetSize æ•°æ®åŒ…å¤§å°     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAfterDecoded</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token keyword">int</span> packetSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ¥æ”¶åˆ°TCPå±‚ä¼ è¿‡æ¥çš„æ•°æ®å     *     * @param receivedBytes  æœ¬æ¬¡æ¥æ”¶äº†å¤šå°‘å­—èŠ‚     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAfterReceivedBytes</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token keyword">int</span> receivedBytes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ¶ˆæ¯åŒ…å‘é€ä¹‹åè§¦å‘æœ¬æ–¹æ³•     *     * @param isSentSuccess  true:å‘é€æˆåŠŸï¼Œfalse:å‘é€å¤±è´¥     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAfterSent</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isSentSuccess<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * å¤„ç†ä¸€ä¸ªæ¶ˆæ¯åŒ…å     * @param cost           æœ¬æ¬¡å¤„ç†æ¶ˆæ¯è€—æ—¶ï¼Œå•ä½ï¼šæ¯«ç§’     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAfterHandled</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token keyword">long</span> cost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è¿æ¥å…³é—­å‰è§¦å‘æœ¬æ–¹æ³•     *     * @param channelContext the channelcontext     * @param throwable      the throwable æœ‰å¯èƒ½ä¸ºç©º     * @param remark         the remark æœ‰å¯èƒ½ä¸ºç©º     * @author tanyaowu     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBeforeClose</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> throwable<span class="token punctuation">,</span> <span class="token class-name">String</span> remark<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isRemove<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>channelContext<span class="token operator">+</span><span class="token string">"--ç¦»å¼€æˆ¿é—´..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">sendToGroup</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span>tioConfig<span class="token punctuation">,</span> <span class="token class-name">ChatConst</span><span class="token punctuation">.</span>groupNo<span class="token punctuation">,</span>                <span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--ç¦»å¼€æˆ¿é—´..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¤„ç†ç±»<br>ChatServerHandler.java</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatServerHandler</span> <span class="token keyword">implements</span> <span class="token class-name">TioServerHandler</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Packet</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ByteBuffer</span> buffer<span class="token punctuation">,</span> <span class="token keyword">int</span> limit<span class="token punctuation">,</span> <span class="token keyword">int</span> position<span class="token punctuation">,</span> <span class="token keyword">int</span> readableLength<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TioDecodeException</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¿™é‡Œå¯ä»¥åšä¸€äº›é¢å¤–æ“ä½œ</span>        <span class="token keyword">return</span> <span class="token class-name">DecodeOrEncode</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> channelContext<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">ByteBuffer</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token class-name">TioConfig</span> tioConfig<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¿™é‡Œå¯ä»¥åšä¸€äº›é¢å¤–æ“ä½œ</span>        <span class="token keyword">return</span> <span class="token class-name">DecodeOrEncode</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> tioConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>        <span class="token class-name">ChatPack</span> pack <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ChatPack</span><span class="token punctuation">)</span> packet<span class="token punctuation">;</span>        <span class="token class-name">String</span> msg <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">toStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>channelContext <span class="token operator">+</span> <span class="token string">"-å‘é€æ¶ˆæ¯="</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å•ä½“ä¸éœ€è¦äº†</span>        <span class="token comment">//Tio.send(channelContext, ChatPack.getPack("æœåŠ¡ç«¯æ”¶åˆ°äº†ä½ çš„æ¶ˆæ¯-" + msg));</span>        <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">sendToGroup</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span>tioConfig<span class="token punctuation">,</span> <span class="token class-name">ChatConst</span><span class="token punctuation">.</span>groupNo<span class="token punctuation">,</span><span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span>channelContext<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"--å‘é€æ¶ˆæ¯ï¼š"</span><span class="token operator">+</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¯åŠ¨ç±»<br>ChatServer.java</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatServer</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">new</span> <span class="token class-name">TioServer</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">TioServerConfig</span><span class="token punctuation">(</span><span class="token string">"chatServer"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ChatServerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ChatServerListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token class-name">ChatConst</span><span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®¢æˆ·ç«¯ä»£ç ç±»ä¼¼"><a href="#å®¢æˆ·ç«¯ä»£ç ç±»ä¼¼" class="headerlink" title="å®¢æˆ·ç«¯ä»£ç ç±»ä¼¼"></a>å®¢æˆ·ç«¯ä»£ç ç±»ä¼¼</h2><p>å®¢æˆ·ç«¯ä»£ç æ²¡æœ‰ç¼–å†™ç›‘å¬ç±»ï¼Œå…¶å®å’ŒæœåŠ¡ç«¯å·®ä¸å¤šã€‚</p><p>å¤„ç†ç±»<br>ChatClientHandler.java</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatClientHandler</span> <span class="token keyword">implements</span> <span class="token class-name">TioClientHandler</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Packet</span> <span class="token function">heartbeatPacket</span><span class="token punctuation">(</span><span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span><span class="token string">"ping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Packet</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ByteBuffer</span> buffer<span class="token punctuation">,</span> <span class="token keyword">int</span> limit<span class="token punctuation">,</span> <span class="token keyword">int</span> position<span class="token punctuation">,</span> <span class="token keyword">int</span> readableLength<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TioDecodeException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">DecodeOrEncode</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> channelContext<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">ByteBuffer</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token class-name">TioConfig</span> tioConfig<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">DecodeOrEncode</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>packet<span class="token punctuation">,</span> tioConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Packet</span> packet<span class="token punctuation">,</span> <span class="token class-name">ChannelContext</span> channelContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ChatPack</span> pack <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ChatPack</span><span class="token punctuation">)</span> packet<span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ”¶åˆ°æ¶ˆæ¯ï¼š"</span><span class="token operator">+</span>pack<span class="token punctuation">.</span><span class="token function">toStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¯åŠ¨ç±»<br>ChatClient.java</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatClient</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ReconnConf</span> reconnConf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReconnConf</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¤±è´¥åæ¬¡å°±ä¸å†é‡è¿</span>        reconnConf<span class="token punctuation">.</span><span class="token function">setRetryCount</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">ChatConst</span><span class="token punctuation">.</span>ip<span class="token punctuation">,</span> <span class="token class-name">ChatConst</span><span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TioClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TioClient</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">TioClientConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChatClientHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        <span class="token keyword">null</span><span class="token punctuation">,</span>                        reconnConf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ClientChannelContext</span> connect <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>connect<span class="token punctuation">,</span><span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½ä¸–ç•Œ"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> str <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>connect<span class="token punctuation">,</span><span class="token string">"å…³é—­è¿æ¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Tio</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>connect<span class="token punctuation">,</span><span class="token class-name">ChatPack</span><span class="token punctuation">.</span><span class="token function">getPack</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>ä»£ç é‡ç®—æœ‰ä¸€ç‚¹å°å¤šçš„ï¼Œä½†æ˜¯è¿™ä¸ªä»£ç ç¡®å®å¯ä»¥ç›´æ¥æ”¾ç”Ÿäº§ä¸Šï¼Œç”¨æ¥åšä¸€äº›æŠ¥æ–‡çš„ä¼ è¾“ä¹‹ç±»çš„ï¼Œåº”è¯¥æŒºç¨³çš„ã€‚ä¸»è¦å¤šå¤šå­¦ä¹ è¿™ä¸ªå¤šå®¢æˆ·ç«¯ä¹‹é—´çš„é€šä¿¡æ“ä½œå§ï¼Œç”¨è¿™ä¸ªTioå¯ä»¥çœå¾ˆå¤šæ—¶é—´ã€‚</p>          </div><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1h4wgwuso4bj32yo1p3kjl.jpg" alt="é›†åŸç¾ æ¹–å…‰ä¸­çš„ç¡ç¾äºº"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œç¼–ç¨‹</tag>
      
      <tag>TIO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BIOçš„ä»£ç å®ç°ï¼Œå®¢æˆ·ç«¯ä»¥åŠæœåŠ¡ç«¯</title>
    <link href="/2022/08/03/net-02/"/>
    <url>/2022/08/03/net-02/</url>
    
    <content type="html"><![CDATA[<p>BIO-åŒæ­¥é˜»å¡IOï¼Œç›´æ¥ä¸Šä»£ç ã€‚</p><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">ServerSocket</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">Socket</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SocketServer</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>          <span class="token comment">// ç»‘å®šç«¯å£</span>            <span class="token class-name">ServerSocket</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8082</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// åŒæ­¥é˜»å¡ï¼Œç›´åˆ°å»ºç«‹è¿æ¥ï¼Œæ„æ€å°±æ˜¯åœ¨è¿™é‡Œä¼šå µå¡ï¼Œå¦‚æœæ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥çš„è¯ï¼Œ</span>                <span class="token comment">// ä»£ç ä¼šåœåœ¨è¿™é‡Œã€‚</span>                <span class="token class-name">Socket</span> client <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// æœ‰å®¢æˆ·ç«¯è¿æ¥äº†ï¼Œæ‰ä¼šå¾€ä¸‹æ‰§è¡Œã€‚</span>                <span class="token comment">// å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™å®¢æˆ·ç«¯ ï¼Œè¿™é‡Œé€šè¿‡è¾“å…¥è¾“å‡ºæµæ¥è¿›è¡Œäº¤äº’</span>                <span class="token class-name">OutputStream</span> output <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                output<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"å®¢æˆ·ç«¯["</span> <span class="token operator">+</span> client<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]ä½ å¥½ï¼Œä½ å·²æˆåŠŸè¿æ¥åˆ°8082æœåŠ¡ç«¯"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// åˆ·æ–°ç¼“å†²åŒº</span>                output<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å®¢æˆ·ç«¯å·²è¿æ¥:"</span> <span class="token operator">+</span> client<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">InputStream</span> input <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token comment">// åŒæ­¥é˜»å¡ è¯»å–å®¢æˆ·ç«¯æ•°æ® ç›´åˆ°è¾“å…¥æ•°æ®ï¼Œè¿æ¥ä¹‹åï¼Œåˆè¿›è¡Œå µå¡ï¼Œè¯»å–å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ã€‚</span>                    <span class="token keyword">while</span> <span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        output<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"æ”¶åˆ°äº†ä½ çš„æ¶ˆæ¯:"</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        output<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯:"</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// å®¢æˆ·ç«¯é“¾æ¥æ–­å¼€åˆ™å¼•å‘å¼‚å¸¸</span>                    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¼•å‘å¼‚å¸¸ï¼š"</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">Socket</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SocketClient</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ¥æ”¶æ§åˆ¶å°ç”¨æˆ·è¾“å…¥çš„æ•°æ®</span>            <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// è¦ç»‘å®šçš„ä¸»æœºå’Œç«¯å£å·</span>            <span class="token class-name">Socket</span> socketClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8082</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// å¯åŠ¨çº¿ç¨‹ç›‘å¬æœåŠ¡ç«¯å‘é€çš„æ¶ˆæ¯</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                  <span class="token comment">// è·å–è¾“å…¥æµï¼Œè¯»å–æœåŠ¡å™¨å‘é€è¿‡æ¥çš„æ¶ˆæ¯</span>                    <span class="token class-name">InputStream</span> input <span class="token operator">=</span> socketClient<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ”¶åˆ°æœåŠ¡ç«¯æ¶ˆæ¯:"</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// è·å–è¾“å‡ºæµï¼Œç”¨æ¥å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯</span>            <span class="token class-name">OutputStream</span> output <span class="token operator">=</span> socketClient<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> str <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// ä¸€ä¸ªå°tip</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    output<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    socketClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯</span>                    output<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    output<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¾ˆç®€å•çš„ä¸€ä¸ªå°æ —å­ï¼Œçœ‹ä¸€çœ‹ç„¶åè‡ªå·±ç§ä¸€ç§ï¼Œä¹Ÿä¼šæ›´å®¹æ˜“ç†è§£ã€‚ä»£ç å¯ä»¥ç›´æ¥è¿è¡Œçš„ã€‚</p><div class="note note-info">            <p>çœ‹å±±æ˜¯å±±ï¼Œçœ‹å±±ä¸æ˜¯å±±ï¼Œçœ‹å±±è¿˜æ˜¯å±±ã€‚</p>          </div><div class="note note-primary">            <p>IDEAå°TIPSï¼š<br>  å¤åˆ¶å®Œæ•´çš„ä»£ç æ–‡æœ¬ï¼Œåœ¨IDEAé‡Œå¯ä»¥ç›´æ¥ç²˜è´´ä¼šæ ¹æ®æ–‡æœ¬ç›´æ¥ç”Ÿæˆä¸€ä¸ªç±»ã€‚</p>          </div><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva2.sinaimg.cn/large/005NNTS5ly1h4tmr1scs4j32yo1o0hdu.jpg" alt="é˜³å…‰ è‰åœ° éƒŠæ¸¸ ååœ¨è‰åœ°ä¸Šçš„ç¾å¥³ æ——è¢ é²œèŠ±"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œç¼–ç¨‹</tag>
      
      <tag>BIO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¿«é€Ÿåˆ é™¤æ–‡ä»¶å¤¹</title>
    <link href="/2022/08/03/other-06/"/>
    <url>/2022/08/03/other-06/</url>
    
    <content type="html"><![CDATA[<p>å¤§ä¼™åº”è¯¥éƒ½ç»å†è¿‡åˆ é™¤ä¸€ä¸ªwebpacké¡¹ç›®åˆ äº†åå‡ åˆ†é’Ÿçš„ç»å†å§ğŸ˜†ğŸ˜†</p><p>å¿«é€Ÿåˆ é™¤å‘½ä»¤</p><h2 id="win"><a href="#win" class="headerlink" title="win"></a>win</h2><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rmdir</span> /s/q <span class="token punctuation">[</span>æ–‡ä»¶å¤¹åç§°<span class="token punctuation">]</span><span class="token comment"># ä¸¾ä¸ªæ —å­</span><span class="token function">rmdir</span> /s/q app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¼ºåˆ¶åˆ é™¤æ–‡ä»¶ï¼Œæ— éœ€ç¡®è®¤ï¼Œå¦‚æœæ˜¯æ–‡ä»¶å¤¹é‚£å°±æ˜¯åˆ é™¤æ–‡ä»¶å¤¹ã€‚</span><span class="token function">rm</span> -rf <span class="token punctuation">[</span>æ–‡ä»¶å¤¹åç§°<span class="token punctuation">]</span><span class="token comment"># ä¸¾ä¸ªæ —å­</span><span class="token function">rm</span> -rf app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1h4te74p99xj32yo1o0kjl.jpg" alt="é˜¿ç‹¸ cosplay"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rm</tag>
      
      <tag>åˆ é™¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç»œç¼–ç¨‹ä¸‰ä¸¤è¨€</title>
    <link href="/2022/08/02/net-01/"/>
    <url>/2022/08/02/net-01/</url>
    
    <content type="html"><![CDATA[<p>æµ…å­¦äº†ä¸€æ®µæ—¶é—´çš„ç½‘ç»œç¼–ç¨‹çŸ¥è¯†ï¼Œä»åŸºç¡€çš„bio,åˆ°nio,å†åˆ°aio(nio2.0)ï¼Œå›½äº§æ¡†æ¶é‡Œçœ‹äº†tioï¼Œå›½å¤–çœ‹äº†netty,<br>å¤§è‡´æ€»ç»“ç½‘ç»œæ¡†æ¶ï¼Œå®é™…å°±æ˜¯å®ç°ç½‘ç»œçš„IOæ“ä½œï¼Œè¦æƒ³è·‘çš„å¿«ï¼Œå¼‚æ­¥ï¼Œå¤šçº¿ç¨‹ï¼Œé›¶æ‹·è´ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ã€‚è¿˜å¥½æœ‰ç°åœ¨çš„æ¡†æ¶ã€‚</p><p>è¯´ä¸‹å­¦ä¹ æ€è·¯ï¼Œå­¦çš„æ—¶å€™ä¸è¦è§‰å¾—æ¡†æ¶å¤æ‚ï¼Œä¿¡æˆ‘ï¼Œå¦‚æœéœ€è¦æ‰‹æ’¸ä¸€ä¸ªç½‘ç»œé€šä¿¡åŠŸèƒ½æ—¶ï¼Œä½¿ç”¨ç¨å¾®å¤æ‚ç‚¹çš„NIOï¼Œæƒ³å†™å‡ºä¸€ä¸ªå…ˆä¸æé€Ÿåº¦ï¼Œå°±å•è¯´å¯é ï¼Œå®ç”¨çš„ç½‘ç»œé€šä¿¡ä»£ç æ—¶ï¼Œä¸€æ—¶åŠä¼šæ˜¯æ’¸ä¸å‡ºæ¥ï¼Œå¼‚æ­¥ï¼Œå¤šçº¿ç¨‹ï¼Œè¿™æŠ€æœ¯ï¼Œå¯¹äºç¼–ç èƒ½åŠ›æœ‰ä¸€å®šçš„è¦æ±‚ã€‚</p><p>ç½‘ç»œé€šä¿¡è¿™å—ï¼Œåœ¨ç°åœ¨å­¦ä¹ ç¼–ç¨‹çš„æ°›å›´ä¸­ï¼Œå¥½åƒæ²¡æœ‰è¢«é‚£ä¹ˆé‡è§†ï¼Œä¸€éƒ¨åˆ†æ˜¯ç°åœ¨å„ç§æ¡†æ¶å°è£…çš„å¤ªå¥½äº†ï¼Œä¸€éƒ¨åˆ†æ˜¯ç°åœ¨çš„å·¥ä½œæ°›å›´å§ï¼Œéƒ½è¿½æ±‚ä½ä»£ç äº†ï¼Œä½ è¯´ä½ å»å­¦ç½‘ç»œç¼–ç¨‹ï¼Œé—¹å‘¢ã€‚</p><h2 id="å‡ ç§IOæ¨¡å‹"><a href="#å‡ ç§IOæ¨¡å‹" class="headerlink" title="å‡ ç§IOæ¨¡å‹"></a>å‡ ç§IOæ¨¡å‹</h2><ul><li>BIO-åŒæ­¥é˜»å¡IO<ul><li>ä¼ ç»ŸIOï¼Œæ˜¯JDK1.4ä¹‹å‰çš„ä¼ ç»ŸIOæ¨¡å‹ï¼Œæ—¢ç„¶è¯´èµ·è¿™ä¸ªæ¨¡å‹ï¼Œç½‘ä¸Šå¤§æŠŠçš„å›¾ï¼Œå…‰çœ‹å›¾ä¼šæœ‰ç‚¹éš¾æ‡‚ï¼Œæ‰¾ç‚¹åŸºç¡€ä»£ç å†™å†™ï¼Œå†å›çœ‹è¿™ä¸ªæ¨¡å‹ï¼Œå°±èƒ½æ‡‚äº†ï¼Œæ ¸å¿ƒå¯ä»¥ç†è§£ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½å¤„ç†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œè‚¯å®šæ”¯æŒä¸äº†å¦‚ä»Šçš„ç½‘ç»œç››å†µã€‚ä¸è¿‡ï¼Œè¯¥è¯´ä¸è¯´ï¼Œæˆ‘æ‰€å¤„çš„å·¥ä½œå•ä½ä¾æ—§æœ‰ä½¿ç”¨è¿™ç§IOæ¥è¿›è¡Œç½‘ç»œä¼ è¾“çš„ã€‚</li></ul></li><li>NIO-åŒæ­¥éé˜»å¡IO<ul><li>æ–°ä¸€ä»£çš„ç½‘ç»œä¼ è¾“IOæ¨¡å‹ï¼ŒåŠ äº†ä¸‰ä¸ªä¸œè¥¿Selectï¼ŒBufferï¼Œè¿˜æœ‰channelï¼ˆé€šé“ï¼‰ï¼Œè¿™ä¸‰ä¸ªç»„åˆäº†ä¸€ä¸‹ï¼Œé¸Ÿæªæ¢ç‚®äº†ã€‚ç½‘ç»œä¸Šæ¨¡å‹å›¾å¾ˆå¤šï¼Œçœ‹äº†ä¹‹åæ‰¾ç‚¹ä»£ç æ•²ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç†è§£è¿™ä¸ªæ¨¡å‹å»æ•²ä»£ç ï¼Œè‡³äºå®æˆ˜ï¼Œè¿˜å¾—ç”¨æ¡†æ¶ã€‚å¤§è‡´è¯´ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªselectç®¡ç†äº†å¤šä¸ªchannelï¼Œä¸€ä¸ªchannelå¯¹åº”ä¸€ä¸ªbufferï¼Œä¸€ä¸ªå®¢æˆ·ç«¯ä¹Ÿå¯¹åº”ä¸€ä¸ªchannelï¼Œå®¢æˆ·ç«¯çš„channelå’ŒæœåŠ¡çš„channelä¹‹é—´ä½¿ç”¨bufferè¿›è¡Œæ•°æ®äº¤äº’ï¼Œbufferè¿™é‡Œæ˜¯æ•°æ®è½½ä½“ï¼Œäº¤æ¢ä»»åŠ¡æ˜¯channelåšçš„ã€‚ä¸€ä¸ªselectéœ€è¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªselectå¯ä»¥ç®¡ç†å¤šä¸ªchannelï¼Œä¸”æ˜¯éé˜»å¡æ¨¡å¼ï¼Œæ˜¯ç”±äº‹ä»¶é©±åŠ¨çš„ï¼Œè¿™æ ·å°±å¤§å¤§çš„èŠ‚çœçš„ç³»ç»Ÿèµ„æºï¼Œè®©é«˜å¹¶å‘æœ‰äº†å¯èƒ½ï¼Œ</li></ul></li><li>AIO-å¼‚æ­¥éé˜»å¡IO<ul><li>å°±æ˜¯NIO2.0ï¼Œè¿˜åœ¨nioåŒ…ä¸‹ã€‚åŠ äº†å¼‚æ­¥ï¼Œå¤šå¤šå…³æ³¨nioå³å¯ã€‚</li></ul></li></ul><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax3.sinaimg.cn/large/005NNTS5ly1h4tdo39n18j32yo1o0qv5.jpg" alt="å·´å›¾BaTu"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œç¼–ç¨‹</tag>
      
      <tag>IO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java18çš„ä¸€ä¸ªç‰¹æ€§å¼•å‘çš„IDEAæ§åˆ¶å°ä¸­æ–‡ä¹±ç çš„é—®é¢˜</title>
    <link href="/2022/06/26/java-16/"/>
    <url>/2022/06/26/java-16/</url>
    
    <content type="html"><![CDATA[<h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><blockquote><p>ä»Šå¤©ç”¨åˆ°JDK 18ï¼Œé‡åˆ°ä¸­æ–‡åœ¨IDEAæ§åˆ¶å°è¾“å‡ºæ˜¯ä¹±ç ï¼Œä½†æ˜¯æ–‡ä»¶è¾“å‡ºæ˜¯æ­£å¸¸çš„é—®é¢˜ï¼Œç»è¿‡æ’æŸ¥ï¼Œç¡®å®šæ˜¯åœ¨IDEA 2021.3.3ä¸‹ä½¿ç”¨JDK 18æ‰“å°åˆ°IDEAæ§åˆ¶å°æ‰ä¼šå‡ºç°çš„bugã€‚å°†é¡¹ç›®ç¼–è¯‘æ‰“åŒ…ï¼Œåœ¨cmdç­‰å‘½ä»¤è¡Œçª—å£ä¸­æ§åˆ¶å°ä½¿å‡ºçš„ä¸­æ–‡æ˜¯æ­£å¸¸çš„ã€‚</p></blockquote><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><ol><li>åˆ‡æ¢é¡¹ç›®é»˜è®¤æ–‡ä»¶å­—ç¬¦é›†ä¸ºGBK</li><li>å¯åŠ¨è¡Œæ·»åŠ VMå‚æ•°ï¼š</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>COMPAT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="å¤ç°æƒ…å†µ"><a href="#å¤ç°æƒ…å†µ" class="headerlink" title="å¤ç°æƒ…å†µ"></a>å¤ç°æƒ…å†µ</h3><p>ä»Šå¤©å†™å­¦demoæ—¶ç”¨åˆ°äº†JDK 18ï¼Œç»“æœå‘ç°æ§åˆ¶å°è¾“å‡ºçš„ä¸­æ–‡æœ‰ä¹±ç ï¼Œå¦‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ä½ å¥½ <span class="token class-name">JeremyTsai</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æ‰“å°å‡ºæ¥çš„æ•ˆæœå¦‚ä¸‹ï¼š</p><p><code>ï¿½ï¿½ï¿½ JeremyTsai</code></p><blockquote><p>é‡Œé¢çš„ä½ å¥½ä¹±ç äº†ã€‚ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯JDKçš„bugï¼Œä½†æ˜¯å°è¯•æ‰“åŒ…å‡ºæ¥ï¼Œåœ¨cmdè¿è¡Œï¼Œåˆæ˜¯æ­£å¸¸çš„ã€‚äºæ˜¯ä¹æ€€ç–‘æ˜¯IDEAæ§åˆ¶å°çš„bugã€‚æ•…å†™äº†ä»¥ä¸‹ä»£ç æµ‹è¯•ï¼š</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileNotFoundException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span><span class="token comment">/** * @author JeremyTsai * @version 0 * @since 2022/6/2 00:10 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">FileOutputStream</span> out<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"log.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Javaç‰ˆæœ¬ä¸º: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.version"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ç¼–ç ä¸º: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"file.encoding"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"æœ¬åœ°ç¼–ç ä¸º: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"native.encoding"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½ JeremyTsai"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"\\r\\n"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä¸Šè¿°ä»£ç åˆ†åˆ«æµ‹è¯•IDEAæ§åˆ¶å°æ‰“å°å’Œæ–‡ä»¶è¾“å‡ºæ‰“å°ã€‚<br>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š<br>JDK17 IDEAæ§åˆ¶å°è¾“å‡ºæ­£å¸¸ï¼Œæ–‡ä»¶è¾“å‡ºæ­£å¸¸ã€‚</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Java</span>ç‰ˆæœ¬ä¸º<span class="token operator">:</span> <span class="token number">17</span>æ–‡ä»¶ç¼–ç ä¸º<span class="token operator">:</span> UTF<span class="token operator">-</span><span class="token number">8</span>æœ¬åœ°ç¼–ç ä¸º<span class="token operator">:</span> GBKä½ å¥½ <span class="token class-name">JeremyTsai</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>JDK18 IDEAæ§åˆ¶å°ä¹±ç ï¼Œæ–‡ä»¶è¾“å‡ºæ­£å¸¸ã€‚</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Java</span>ï¿½æ±¾Îª<span class="token operator">:</span> <span class="token number">1</span>ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ï¿½Îª<span class="token operator">:</span> UTF<span class="token operator">-</span><span class="token number">8</span>ï¿½ï¿½ï¿½Ø±ï¿½ï¿½ï¿½Îª<span class="token operator">:</span> GBKï¿½ï¿½ï¿½ <span class="token class-name">JeremyTsai</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é—®é¢˜ç ”ç©¶"><a href="#é—®é¢˜ç ”ç©¶" class="headerlink" title="é—®é¢˜ç ”ç©¶"></a>é—®é¢˜ç ”ç©¶</h3><blockquote><p>å€¼å¾—å…³æ³¨çš„ä¸€ç‚¹å°±æ˜¯ï¼Œnative encodingéƒ½æ˜¯GBKï¼Œè¿™æ˜¯å› ä¸ºæˆ‘æœ¬åœ°æ˜¯ä¸­æ–‡çš„windowsç³»ç»Ÿã€‚è¿™é‡Œä¼šä¹±ç ï¼Œä¹Ÿæ˜¯å› ä¸ºJDK18çš„æ–°ç‰¹æ€§ï¼šJEP400: é»˜è®¤å­—ç¬¦é›†UTF-8å¯¼è‡´çš„ï¼ŒçŒœæƒ³å¯èƒ½æ˜¯å› ä¸ºIDEAçš„æ§åˆ¶å°çš„ç¼–è§£ç æœ‰é—®é¢˜ã€‚æ‰€ä»¥è§£å†³çš„æ–¹æ¡ˆå°±æœ‰å¾ˆå¤šï¼Œå› ä¸ºæœ¬åœ°æ˜¯ä¸­æ–‡ç³»ç»Ÿï¼Œæœ€ç®€å•çš„å°±æ˜¯å°†é¡¹ç›®å­—ç¬¦é›†è½¬æˆGBKï¼Œè¿™æ ·file.encodingå’Œnative encodingéƒ½æ˜¯GBKï¼Œä¸å¯èƒ½å­˜åœ¨ç¼–è§£ç é—®é¢˜ã€‚è¿˜æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨UTF-8å­—ç¬¦é›†çš„é¡¹ç›®å¯åŠ¨æ—¶åŠ VMå‚æ•°</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>COMPAT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ä¹Ÿå¯ä»¥è§£å†³ã€‚åœ¨JDK 17å¼•å…¥äº†native.encodingç³»ç»Ÿå±æ€§ï¼Œä½œä¸ºç¨‹åºè·å¾—JDKç®—æ³•æ‰€é€‰å­—ç¬¦é›†çš„æ ‡å‡†æ–¹å¼ï¼Œè€Œä¸ç®¡é»˜è®¤å­—ç¬¦é›†æ˜¯å¦å®é™…é…ç½®ä¸ºè¯¥å­—ç¬¦é›†ã€‚åœ¨ JDK 18ä¸­ï¼Œå¦‚æœåœ¨å‘½ä»¤è¡Œä¸Šå°†file.encodingè®¾ç½®ä¸ºCOMPATï¼Œé‚£ä¹ˆfile.encodingçš„è¿è¡Œæ—¶å€¼å°†ä¸native.encodingçš„è¿è¡Œæ—¶å€¼ç›¸åŒ; å¦‚æœåœ¨å‘½ä»¤è¡Œä¸Šå°†file.encodingè®¾ç½®ä¸º UTF-8ï¼Œé‚£ä¹ˆ file.encoding çš„è¿è¡Œæ—¶å€¼å¯èƒ½ä¸native.encodingçš„è¿è¡Œæ—¶å€¼ä¸åŒã€‚</p><h3 id="JEP400-é»˜è®¤å­—ç¬¦é›†UTF-8"><a href="#JEP400-é»˜è®¤å­—ç¬¦é›†UTF-8" class="headerlink" title="JEP400 é»˜è®¤å­—ç¬¦é›†UTF-8"></a>JEP400 é»˜è®¤å­—ç¬¦é›†UTF-8</h3><h3 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h3><blockquote><p>æŒ‡å®š utf-8ä½œä¸ºæ ‡å‡† Java APIs çš„é»˜è®¤å­—ç¬¦é›†ã€‚é€šè¿‡è¿™ä¸€æ›´æ”¹ï¼Œä¾èµ–äºé»˜è®¤å­—ç¬¦é›†çš„ api å°†åœ¨æ‰€æœ‰å®ç°ã€æ“ä½œç³»ç»Ÿã€åŒºåŸŸè®¾ç½®å’Œé…ç½®ä¸­è¡¨ç°ä¸€è‡´ã€‚</p></blockquote><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><ol><li>å½“Javaç¨‹åºçš„ä»£ç ä¾èµ–äºé»˜è®¤å­—ç¬¦é›†æ—¶ï¼Œä½¿å®ƒä»¬æ›´å¯é¢„æµ‹å’Œå¯ç§»æ¤</li><li>æ˜ç¡®æ ‡å‡†Java APIåœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨é»˜è®¤å­—ç¬¦é›†</li><li>é™¤æ§åˆ¶å° I&#x2F;O ä¹‹å¤–ï¼Œæ ‡å‡†åŒ–æ‰€æœ‰æ ‡å‡†Java APIä¸­çš„ UTF-8</li></ol><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><ul><li><a href="https://openjdk.org/jeps/400">JEP 400: UTF-8 by Default</a></li></ul><hr><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1h3lujiyy3pj32yo1o0x5i.jpg" alt="æ¢¦åå½•æ’ç”»é£"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java18</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cronè¡¨è¾¾å¼</title>
    <link href="/2022/06/11/linux-02/"/>
    <url>/2022/06/11/linux-02/</url>
    
    <content type="html"><![CDATA[<p><a href="https://help.aliyun.com/document_detail/64769.html">åŸæ–‡é“¾æ¥</a></p><h3 id="Cronè¡¨è¾¾å¼ä»‹ç»"><a href="#Cronè¡¨è¾¾å¼ä»‹ç»" class="headerlink" title="Cronè¡¨è¾¾å¼ä»‹ç»"></a>Cronè¡¨è¾¾å¼ä»‹ç»</h3><blockquote><p>Cronè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå…·æœ‰æ—¶é—´å«ä¹‰çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥<code>5~6</code>ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º<code>6~7</code>ä¸ªåŸŸï¼Œæ ¼å¼ä¸º<code>X X X X X X X</code>ã€‚å…¶ä¸­<code>X</code>æ˜¯ä¸€ä¸ªåŸŸçš„å ä½ç¬¦ã€‚æœ€åä¸€ä¸ªä»£è¡¨å¹´ä»½çš„åŸŸéå¿…é¡»ï¼Œå¯çœç•¥ã€‚å•ä¸ªåŸŸæœ‰å¤šä¸ªå–å€¼æ—¶ï¼Œä½¿ç”¨åŠè§’é€—å·<code>,</code>éš”å¼€å–å€¼ã€‚æ¯ä¸ªåŸŸå¯ä»¥æ˜¯ç¡®å®šçš„å–å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·æœ‰é€»è¾‘æ„ä¹‰çš„ç‰¹æ®Šå­—ç¬¦ã€‚æ¯ä¸ªåŸŸæœ€å¤šæ”¯æŒä¸€ä¸ªå‰å¯¼é›¶ã€‚</p></blockquote><div class="note note-info">            <p><code>è¯´æ˜</code> å¦‚æŒ‡å®š2022å¹´æ¯å¤©ä¸Šåˆ8:15æ‰§è¡Œä»»åŠ¡ï¼ŒCronè¡¨è¾¾å¼å¯æŒ‡å®šä¸º<code>0 15 8 ? * * 2022</code>æˆ–<code>0 15 08 ? * * 2022</code>ï¼Œè€Œä¸èƒ½æŒ‡å®šä¸º<code>0 15 008 ? * * 2022</code>ã€‚</p>          </div><h3 id="åŸŸå–å€¼"><a href="#åŸŸå–å€¼" class="headerlink" title="åŸŸå–å€¼"></a>åŸŸå–å€¼</h3><blockquote><p>ä¸‹è¡¨ä¸ºCronè¡¨è¾¾å¼ä¸­å…­ä¸ªåŸŸèƒ½å¤Ÿå–çš„å€¼ä»¥åŠæ”¯æŒçš„ç‰¹æ®Šå­—ç¬¦ã€‚</p></blockquote><table><thead><tr><th>åŸŸ</th><th>æ˜¯å¦å¿…éœ€</th><th>å–å€¼èŒƒå›´</th><th>ç‰¹æ®Šå­—ç¬¦</th></tr></thead><tbody><tr><td>ç§’</td><td>æ˜¯</td><td>[0, 59]</td><td>* , - &#x2F;</td></tr><tr><td>åˆ†é’Ÿ</td><td>æ˜¯</td><td>[0, 59]</td><td>* , - &#x2F;</td></tr><tr><td>å°æ—¶</td><td>æ˜¯</td><td>[0, 23]</td><td>* , - &#x2F;</td></tr><tr><td>æ—¥æœŸ</td><td>æ˜¯</td><td>[1, 31]</td><td>* , - &#x2F; ? L W</td></tr><tr><td>æœˆä»½</td><td>æ˜¯</td><td>[1, 12]æˆ–[JAN, DEC]</td><td>* , - &#x2F;</td></tr><tr><td>æ˜ŸæœŸ</td><td>æ˜¯</td><td>[1, 7]æˆ–[MON, SUN]ã€‚è‹¥æ‚¨ä½¿ç”¨[1, 7]è¡¨è¾¾æ–¹å¼ï¼Œ<code>1</code>ä»£è¡¨æ˜ŸæœŸä¸€ï¼Œ<code>7</code>ä»£è¡¨æ˜ŸæœŸæ—¥ã€‚</td><td>* , - &#x2F; ? L #</td></tr><tr><td>å¹´</td><td>å¦</td><td>[å½“å‰å¹´ä»½ï¼Œ2099]</td><td>* , - &#x2F;</td></tr></tbody></table><h3 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h3><blockquote><p>Cronè¡¨è¾¾å¼ä¸­çš„æ¯ä¸ªåŸŸéƒ½æ”¯æŒä¸€å®šæ•°é‡çš„ç‰¹æ®Šå­—ç¬¦ï¼Œæ¯ä¸ªç‰¹æ®Šå­—ç¬¦æœ‰å…¶ç‰¹æ®Šå«ä¹‰ã€‚</p></blockquote><table><thead><tr><th>ç‰¹æ®Šå­—ç¬¦</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>*</code></td><td>æ‰€æœ‰å¯èƒ½çš„å€¼ã€‚</td><td>åœ¨æœˆåŸŸä¸­ï¼Œ<code>*</code>è¡¨ç¤ºæ¯ä¸ªæœˆï¼›åœ¨æ˜ŸæœŸåŸŸä¸­ï¼Œ<code>*</code>è¡¨ç¤ºæ˜ŸæœŸçš„æ¯ä¸€å¤©ã€‚</td></tr><tr><td><code>,</code></td><td>åˆ—å‡ºæšä¸¾å€¼ã€‚</td><td>åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ<code>5,20</code>è¡¨ç¤ºåˆ†åˆ«åœ¨5åˆ†é’Ÿå’Œ20åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚</td></tr><tr><td><code>-</code></td><td>èŒƒå›´ã€‚</td><td>åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ<code>5-20</code>è¡¨ç¤ºä»5åˆ†é’Ÿåˆ°20åˆ†é’Ÿä¹‹é—´æ¯éš”ä¸€åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚</td></tr><tr><td><code>/</code></td><td>æŒ‡å®šæ•°å€¼çš„å¢é‡ã€‚</td><td>åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ<code>0/15</code>è¡¨ç¤ºä»ç¬¬0åˆ†é’Ÿå¼€å§‹ï¼Œæ¯15åˆ†é’Ÿã€‚åœ¨åˆ†é’ŸåŸŸä¸­<code>3/20</code>è¡¨ç¤ºä»ç¬¬3åˆ†é’Ÿå¼€å§‹ï¼Œæ¯20åˆ†é’Ÿã€‚</td></tr><tr><td><code>?</code></td><td>ä¸æŒ‡å®šå€¼ï¼Œä»…æ—¥æœŸå’Œæ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚</td><td>å½“æ—¥æœŸæˆ–æ˜ŸæœŸåŸŸå…¶ä¸­ä¹‹ä¸€è¢«æŒ‡å®šäº†å€¼ä»¥åï¼Œä¸ºäº†é¿å…å†²çªï¼Œéœ€è¦å°†å¦ä¸€ä¸ªåŸŸçš„å€¼è®¾ä¸º<code>?</code>ã€‚</td></tr><tr><td><code>L</code></td><td>å•è¯Lastçš„é¦–å­—æ¯ï¼Œè¡¨ç¤ºæœ€åä¸€å¤©ï¼Œä»…æ—¥æœŸå’Œæ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚<span class="label label-info">`è¯´æ˜` æŒ‡å®š`L`å­—ç¬¦æ—¶ï¼Œé¿å…æŒ‡å®šåˆ—è¡¨æˆ–è€…èŒƒå›´ï¼Œå¦åˆ™ï¼Œä¼šå¯¼è‡´é€»è¾‘é—®é¢˜ã€‚</span></td><td><span class="label label-info">åœ¨æ—¥æœŸåŸŸä¸­ï¼Œ`L`è¡¨ç¤ºæŸä¸ªæœˆçš„æœ€åä¸€å¤©ã€‚åœ¨æ˜ŸæœŸåŸŸä¸­ï¼Œ`L`è¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸçš„æœ€åä¸€å¤©ï¼Œä¹Ÿå°±æ˜¯æ˜ŸæœŸæ—¥ï¼ˆ`SUN`ï¼‰ã€‚</span> <span class="label label-info">å¦‚æœåœ¨`L`å‰æœ‰å…·ä½“çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼Œåœ¨æ˜ŸæœŸåŸŸä¸­çš„`6L`è¡¨ç¤ºè¿™ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå…­ã€‚</span></td></tr><tr><td><code>W</code></td><td>é™¤å‘¨æœ«ä»¥å¤–çš„æœ‰æ•ˆå·¥ä½œæ—¥ï¼Œåœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚<code>W</code>å­—ç¬¦å¯»æ‰¾æœ€è¿‘æœ‰æ•ˆå·¥ä½œæ—¥æ—¶ä¸ä¼šè·¨è¿‡å½“å‰æœˆä»½ï¼Œè¿ç”¨å­—ç¬¦<code>LW</code>æ—¶è¡¨ç¤ºä¸ºæŒ‡å®šæœˆä»½çš„æœ€åä¸€ä¸ªå·¥ä½œæ—¥ã€‚</td><td>åœ¨æ—¥æœŸåŸŸä¸­<code>5W</code>ï¼Œå¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥æ˜ŸæœŸäº”ï¼Œå³4æ—¥è§¦å‘ã€‚å¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥æ˜ŸæœŸä¸€ï¼Œå³6æ—¥è§¦å‘ï¼›å¦‚æœ5æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨5æ—¥è§¦å‘ã€‚</td></tr><tr><td><code>#</code></td><td>ç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œä»…æ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚</td><td>åœ¨æ˜ŸæœŸåŸŸä¸­ï¼Œ<code>4#2</code>è¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸå››ã€‚</td></tr></tbody></table><h3 id="å–å€¼ç¤ºä¾‹"><a href="#å–å€¼ç¤ºä¾‹" class="headerlink" title="å–å€¼ç¤ºä¾‹"></a>å–å€¼ç¤ºä¾‹</h3><blockquote><p>ä»¥ä¸‹ä¸ºCronè¡¨è¾¾å¼çš„å–å€¼ç¤ºä¾‹ã€‚</p></blockquote><table><thead><tr><th>ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>0 15 10 ? * *</code></td><td>æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 * * ?</code></td><td>æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0 12 * * ?</code></td><td>æ¯å¤©ä¸­åˆ12:00æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0 10,14,16 * * ?</code></td><td>æ¯å¤©ä¸Šåˆ10:00ç‚¹ã€ä¸‹åˆ14:00ä»¥åŠä¸‹åˆ16:00æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0/30 9-17 * * ?</code></td><td>æ¯å¤©ä¸Šåˆ09:00åˆ°ä¸‹åˆ17:00æ—¶é—´æ®µå†…æ¯éš”åŠå°æ—¶æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 * 14 * * ?</code></td><td>æ¯å¤©ä¸‹åˆ14:00åˆ°ä¸‹åˆ14:59æ—¶é—´æ®µå†…æ¯éš”1åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0-5 14 * * ?</code></td><td>æ¯å¤©ä¸‹åˆ14:00åˆ°ä¸‹åˆ14:05æ—¶é—´æ®µå†…æ¯éš”1åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0/5 14 * * ?</code></td><td>æ¯å¤©ä¸‹åˆ14:00åˆ°ä¸‹åˆ14:55æ—¶é—´æ®µå†…æ¯éš”5åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0/5 14,18 * * ?</code></td><td>æ¯å¤©ä¸‹åˆ14:00åˆ°ä¸‹åˆ14:55ã€ä¸‹åˆ18:00åˆ°ä¸‹åˆ18:55æ—¶é—´æ®µå†…æ¯éš”5åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0 12 ? * WED</code></td><td>æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ12:00æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 15 * ?</code></td><td>æ¯æœˆ15æ—¥ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 L * ?</code></td><td>æ¯æœˆæœ€åä¸€æ—¥ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 ? * 6L</code></td><td>æ¯æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸå…­ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 ? * 6#3</code></td><td>æ¯æœˆç¬¬ä¸‰ä¸ªæ˜ŸæœŸå…­ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 10,44 14 ? 3 WED</code></td><td>æ¯å¹´3æœˆçš„æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸‹åˆ14:10å’Œ14:44æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 ? * * 2022</code></td><td>2022å¹´æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 ? * * *</code></td><td>æ¯å¹´æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0/5 14,18 * * ? 2022</code></td><td>2022å¹´æ¯å¤©ä¸‹åˆ14:00åˆ°ä¸‹åˆ14:55ã€ä¸‹åˆ18:00åˆ°ä¸‹åˆ18:55æ—¶é—´æ®µå†…æ¯éš”5åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 ? * 6#3 2022,2023</code></td><td>2022å¹´è‡³2023å¹´æ¯æœˆç¬¬ä¸‰ä¸ªæ˜ŸæœŸå…­ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0/30 9-17 * * ? 2022-2025</code></td><td>2022å¹´è‡³2025å¹´æ¯å¤©ä¸Šåˆ09:00åˆ°ä¸‹åˆ17:30æ—¶é—´æ®µå†…æ¯éš”åŠå°æ—¶æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 10,44 14 ? 3 WED 2022/2</code></td><td>ä»2022å¹´å¼€å§‹ï¼Œæ¯éš”ä¸¤å¹´3æœˆçš„æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸‹åˆ14:10å’Œ14:44æ‰§è¡Œä»»åŠ¡</td></tr></tbody></table><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h3474oy5t3j323w1kwb29.jpg" alt="ç ‚ç‹¼  å¥³å­©å­ "></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cron</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯AESåŠ å¯†è§£å¯†ï¼Œä»¥åŠé…å¥—çš„åç«¯åŠ å¯†è§£å¯†</title>
    <link href="/2022/05/23/java-15/"/>
    <url>/2022/05/23/java-15/</url>
    
    <content type="html"><![CDATA[<p>AESå…¨ç§°é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆè‹±è¯­ï¼šAdvanced Encryption Standardï¼Œç¼©å†™ï¼šAESï¼‰ï¼Œåœ¨å¯†ç å­¦ä¸­åˆç§°RijndaelåŠ å¯†æ³•ã€‚</p><h2 id="å‰ç«¯åŠ å¯†è§£å¯†"><a href="#å‰ç«¯åŠ å¯†è§£å¯†" class="headerlink" title="å‰ç«¯åŠ å¯†è§£å¯†"></a>å‰ç«¯åŠ å¯†è§£å¯†</h2><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// å¼•å…¥JS</span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"</span> integrity<span class="token operator">=</span><span class="token string">"sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA=="</span> crossorigin<span class="token operator">=</span><span class="token string">"anonymous"</span> referrerpolicy<span class="token operator">=</span><span class="token string">"no-referrer"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token comment">/*åŠ å¯†*/</span><span class="token keyword">function</span> <span class="token function">aesEncode</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    key <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> encryptedData <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">ECB</span><span class="token punctuation">,</span>        <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> encryptedData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œè¿”å›æ˜¯Base64å­—ç¬¦ä¸²</span><span class="token punctuation">&#125;</span><span class="token comment">/*è§£å¯†*/</span><span class="token keyword">function</span> <span class="token function">aesDecode</span><span class="token punctuation">(</span><span class="token parameter">encryptedStr<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    key <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> encryptedHexStr  <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>encryptedStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> encryptedBase64Str  <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>encryptedHexStr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> decryptedData  <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encryptedBase64Str<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">ECB</span><span class="token punctuation">,</span>        <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> decryptedData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="åç«¯åŠ å¯†è§£å¯†"><a href="#åç«¯åŠ å¯†è§£å¯†" class="headerlink" title="åç«¯åŠ å¯†è§£å¯†"></a>åç«¯åŠ å¯†è§£å¯†</h2><p>æ·»åŠ å°è£…çš„ä¾èµ–hu-tool</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.7.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æ„å»ºAESåŠ å¯†å·¥å…·</span><span class="token class-name">SymmetricCrypto</span> aes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SymmetricCrypto</span><span class="token punctuation">(</span><span class="token class-name">SymmetricAlgorithm</span><span class="token punctuation">.</span>AES<span class="token punctuation">,</span> <span class="token string">"qeNm3eXK/BCAwTVoEjfaGQ=="</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ å¯†</span><span class="token comment">// å¦‚æœéœ€è¦è½¬ä¸ºå’Œå‰ç«¯æ˜¾ç¤ºä¸€æ ·çš„æ•°æ®ï¼Œè¿™é‡Œéœ€è¦æŠŠè¿™ä¸ªè¿”å›å†…å®¹è½¬ä¸ºBase64å­—ç¬¦ä¸²</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypt <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£å¯†</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypt <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£å¯†ä¸ºå­—ç¬¦ä¸²</span><span class="token class-name">String</span> decryptStr <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">decryptStr</span><span class="token punctuation">(</span>encrypt<span class="token punctuation">,</span> <span class="token class-name">CharsetUtil</span><span class="token punctuation">.</span>CHARSET_UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva2.sinaimg.cn/large/005NNTS5ly1h2i2h93hwrj32yo1o07wi.jpg" alt="è“è‰²çŸ­å‘å¥³ç”Ÿ"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AES</tag>
      
      <tag>åŠ å¯†è§£å¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring Bootä¸ç¼“å­˜ï¼šä½¿ç”¨JCacheï¼ˆJSR-107ï¼‰æ³¨è§£ç®€åŒ–å¼€å‘</title>
    <link href="/2022/05/10/java-14/"/>
    <url>/2022/05/10/java-14/</url>
    
    <content type="html"><![CDATA[<p>ç¼“å­˜æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå¦‚æœä½ æƒ³è®©å‰å°ç”¨æˆ·æ“ä½œæµç•…çš„è¯ã€‚ç»å…¸çš„å€’è£…å¥ã€‚ç°åœ¨éƒ½åœ¨è¿½æ±‚æœåŠ¡çš„æ— çŠ¶æ€åŒ–ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨redisä½œä¸ºç¼“å­˜å·¥å…·ã€‚æˆ‘ä¹Ÿæ„Ÿè§‰æ²¡æœ‰å¿…è¦å†™ï¼Œå¯æ˜¯ç®€å•çš„ä½ ä¸å†™ï¼Œå¤æ‚çš„ä½ åˆå†™ä¸å¥½ï¼Œæœ€åï¼Œå°±æ˜¯å•¥ä¹Ÿæ²¡æœ‰ã€‚</p><p>springbootç‰ˆæœ¬ï¼š2.6.7</p><h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-cache<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é»˜è®¤ç”Ÿæ•ˆçš„æ˜¯é…ç½®ç±»ï¼šSimpleCacheConfigurationï¼Œå…¶ä»–çš„é…ç½®ç±»æ¯”å¦‚RedisCacheConfigurationå¦‚æœè¦ç”Ÿæ•ˆå¿…é¡»æ·»åŠ ç›¸å…³çš„Redisé…ç½®ä¿¡æ¯ï¼Œå¦åˆ™é»˜è®¤ä¸ç”Ÿæ•ˆã€‚</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">cache</span><span class="token punctuation">:</span>  <span class="token comment"># å¯ä»¥ä¸ºç†è§£æŒ‡å®šå­˜å‚¨ç¼“å­˜çš„ä¸œè¥¿</span>    <span class="token key atrule">type</span><span class="token punctuation">:</span> redis  <span class="token key atrule">redis</span><span class="token punctuation">:</span>    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost    <span class="token comment"># å¦‚æœä½ æœ‰å¯†ç çš„è¯</span>    <span class="token key atrule">password</span><span class="token punctuation">:</span> redis213<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å¯åŠ¨ç±»åŠ ä¸ªå¯ç”¨ç¼“å­˜çš„æ³¨è§£ï¼Œå¼€å¯ç¼“å­˜"><a href="#å¯åŠ¨ç±»åŠ ä¸ªå¯ç”¨ç¼“å­˜çš„æ³¨è§£ï¼Œå¼€å¯ç¼“å­˜" class="headerlink" title="å¯åŠ¨ç±»åŠ ä¸ªå¯ç”¨ç¼“å­˜çš„æ³¨è§£ï¼Œå¼€å¯ç¼“å­˜"></a>å¯åŠ¨ç±»åŠ ä¸ªå¯ç”¨ç¼“å­˜çš„æ³¨è§£ï¼Œå¼€å¯ç¼“å­˜</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableCaching</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ServerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h2><p>æ¨èæ³¨è§£ä½¿ç”¨å•Šï¼Œæ‰‹å†™çš„è¯åº”è¯¥ä¸éœ€è¦ä»‹ç»ï¼Œè‡ªå·±æ‰‹æ“ç€å°±è¡Œï¼Œæ‰‹æ“æ²¡å•¥å¯è¯´çš„ï¼Œæ³¨è§£ï¼Œä¹Ÿåªæ˜¯è¯´ä¸€è¯´æ³¨è§£é‡Œçš„å„ç§å±æ€§ã€‚è‹±æ–‡å¥½ç‚¹ï¼Œå¯ä»¥éšä¾¿ä½¿ç”¨å•Šã€‚è‹±æ–‡ä¸å¥½ï¼Œé‚£å’±ä¹Ÿä¸æ˜¯ä¸€ç‚¹ä¹Ÿä¸èƒ½çœ‹ï¼Œæ ¹æ®å˜é‡åçŒœï¼ŒåŠ ä¸Šæœºå™¨ç¿»è¯‘ï¼Œæ—¥å­åˆ°ä¹Ÿè¿‡çš„ä¸‹å»ã€‚</p><div class="note note-info">            <p>æˆ‘åªæ˜¯ä¸€ä¸ªå–œæ¬¢å†™éšç¬”çš„äººå•Šï¼Œæ¯æ¬¡å†™è¿™ç§ä»‹ç»åšå®¢æ—¶ï¼Œæ€»æ—¶æ§åˆ¶ä¸ä½å»å†™ä¹¦ï¼Œå¯èƒ½å’Œæˆ‘çš„åˆä¸­è€å¸ˆæœ‰å…³ç³»ï¼Œä¸€è‚¡è„‘çš„å…¨éƒ¨åˆ°ç»™ä½ ï¼Œä¹Ÿä¸ç®¡ä½ å¬ä¸å¬å¾—æ‡‚ã€‚è¿˜æ˜¯ç®€ç•¥ç‚¹ï¼Œå†™çš„å¤ªè¯¦ç»†å†™çš„ä¹Ÿç´¯ï¼Œçœ‹çš„ä¹Ÿç´¯ã€‚æœ€ä¸»è¦æ„Ÿè§‰è¿˜æ˜¯è¦èµ·åˆ°çš„ä¸€ä¸ªç±»ä¼¼é¢†å¤´çš„æ•ˆæœå§ã€‚å¾ˆå¤šç»†èŠ‚ï¼Œè‡ªå·±å»çœ‹æºç ä¹Ÿæ˜¯å¯ä»¥è§£å†³çš„ã€‚</p>          </div><h2 id="å‡ ä¸ªé‡è¦çš„æ¦‚å¿µå’Œæ³¨è§£"><a href="#å‡ ä¸ªé‡è¦çš„æ¦‚å¿µå’Œæ³¨è§£" class="headerlink" title="å‡ ä¸ªé‡è¦çš„æ¦‚å¿µå’Œæ³¨è§£"></a>å‡ ä¸ªé‡è¦çš„æ¦‚å¿µå’Œæ³¨è§£</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h24891grucj30w60ea786.jpg" alt="æ¦‚å¿µ"></p><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h2489u3nmyj30wq0gf4bh.jpg" alt="æ³¨è§£å‚æ•°"></p><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h248a7wofej30yu0f5n44.jpg" alt="æ³¨è§£ä¸­SPELè¡¨è¾¾å¼"></p><h3 id="Cacheable"><a href="#Cacheable" class="headerlink" title="@Cacheable"></a>@Cacheable</h3><p><code>@Cacheable</code>æ ‡æ³¨çš„æ–¹æ³•åœ¨æ‰§è¡Œä¹‹å‰ä¼šå…ˆæ£€æŸ¥ç¼“å­˜ä¸­æœ‰æ²¡æœ‰è¿™ä¸ªæ•°æ®ï¼Œé»˜è®¤æŒ‰ç…§å‚æ•°çš„å€¼ä½œä¸ºç¼“å­˜çš„keyå»æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±è¿è¡Œè¯¥æ–¹æ³•å¹¶å°†ç»“æœæ”¾å…¥ç¼“å­˜ï¼›ä»¥åå†æ¥è°ƒç”¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ï¼›</p><ol><li>æ–¹æ³•è¿è¡Œä¹‹å‰ï¼Œå…ˆå»æŸ¥è¯¢Cacheï¼ˆç¼“å­˜ç»„ä»¶ï¼‰ï¼ŒæŒ‰ç…§cacheNamesæŒ‡å®šçš„åå­—è·å–ï¼›ï¼ˆCacheManagerå…ˆè·å–ç›¸åº”çš„ç¼“å­˜ï¼‰ï¼Œç¬¬ä¸€æ¬¡è·å–ç¼“å­˜å¦‚æœæ²¡æœ‰Cacheç»„ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</li><li>å»Cacheä¸­æŸ¥æ‰¾ç¼“å­˜çš„å†…å®¹ï¼Œä½¿ç”¨ä¸€ä¸ªkeyï¼Œé»˜è®¤å°±æ˜¯æ–¹æ³•çš„å‚æ•°ï¼›keyæ˜¯æŒ‰ç…§æŸç§ç­–ç•¥ç”Ÿæˆçš„ï¼›é»˜è®¤æ˜¯ä½¿ç”¨<code>keyGenerator</code>ç”Ÿæˆçš„ï¼Œé»˜è®¤ä½¿ç”¨<code>SimpleKeyGenerator</code>ç”Ÿæˆkeyï¼›</li><li>çœ‹æºç å¾—çŸ¥<code>SimpleKeyGenerator</code>ç”Ÿæˆkeyçš„é»˜è®¤ç­–ç•¥ï¼›<ul><li>å¦‚æœæ²¡æœ‰å‚æ•°ï¼›<code>key=new SimpleKey()</code>ï¼›</li><li>å¦‚æœæœ‰ä¸€ä¸ªå‚æ•°ï¼š<code>key=å‚æ•°çš„å€¼</code></li><li>å¦‚æœæœ‰å¤šä¸ªå‚æ•°ï¼š<code>key=new SimpleKey(params)</code>ï¼›</li></ul></li><li>æ²¡æœ‰æŸ¥åˆ°ç¼“å­˜å°±è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼›</li><li>å°†ç›®æ ‡æ–¹æ³•è¿”å›çš„ç»“æœï¼Œæ”¾è¿›ç¼“å­˜ä¸­</li></ol><div class="note note-info">            <p>å°†æ–¹æ³•çš„è¿è¡Œç»“æœè¿›è¡Œç¼“å­˜ï¼›ä»¥åå†è¦ç›¸åŒçš„æ•°æ®ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ï¼Œä¸ç”¨è°ƒç”¨æ–¹æ³•ï¼›<br>CacheManagerç®¡ç†å¤šä¸ªCacheç»„ä»¶çš„ï¼Œå¯¹ç¼“å­˜çš„çœŸæ­£CRUDæ“ä½œåœ¨Cacheç»„ä»¶ä¸­ï¼Œæ¯ä¸€ä¸ªç¼“å­˜ç»„ä»¶æœ‰è‡ªå·±å”¯ä¸€ä¸€ä¸ªåå­—ï¼›</p>          </div><h4 id="Cacheableæ³¨è§£çš„å¯é…ç½®é¡¹"><a href="#Cacheableæ³¨è§£çš„å¯é…ç½®é¡¹" class="headerlink" title="Cacheableæ³¨è§£çš„å¯é…ç½®é¡¹"></a>Cacheableæ³¨è§£çš„å¯é…ç½®é¡¹</h4><ol><li><code>cacheNames/value</code>ï¼šæŒ‡å®šç¼“å­˜ç»„ä»¶çš„åå­—;å°†æ–¹æ³•çš„è¿”å›ç»“æœæ”¾åœ¨å“ªä¸ªç¼“å­˜ä¸­ï¼Œæ˜¯æ•°ç»„çš„æ–¹å¼ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªç¼“å­˜ï¼›</li><li><code>key</code>ï¼šç¼“å­˜æ•°æ®ä½¿ç”¨çš„keyï¼›å¯ä»¥ç”¨å®ƒæ¥æŒ‡å®šã€‚é»˜è®¤æ˜¯ä½¿ç”¨æ–¹æ³•å‚æ•°çš„å€¼ 1-æ–¹æ³•çš„è¿”å›å€¼ç¼–å†™SpELï¼› #id;å‚æ•°idçš„å€¼ #a0 #p0 #root.args[0]getEmp[2]</li><li><code>keyGenerator</code>ï¼škeyçš„ç”Ÿæˆå™¨ï¼›å¯ä»¥è‡ªå·±æŒ‡å®škeyçš„ç”Ÿæˆå™¨çš„ç»„ä»¶id,<code>key/keyGenerator</code>ï¼šäºŒé€‰ä¸€ä½¿ç”¨</li><li><code>cacheManager</code>ï¼šæŒ‡å®šç¼“å­˜ç®¡ç†å™¨ï¼›æˆ–è€…cacheResolveræŒ‡å®šè·å–è§£æå™¨</li><li><code>condition</code>ï¼šæŒ‡å®šç¬¦åˆæ¡ä»¶çš„æƒ…å†µä¸‹æ‰ç¼“å­˜ï¼›condition &#x3D; â€œ#id&gt;0â€ï¼›condition &#x3D; â€œ#a0&gt;1â€ï¼šç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼å¤§äº1çš„æ—¶å€™æ‰è¿›è¡Œç¼“å­˜</li><li><code>unless</code>: å¦å®šç¼“å­˜ï¼›å½“unlessæŒ‡å®šçš„æ¡ä»¶ä¸ºtrueï¼Œæ–¹æ³•çš„è¿”å›å€¼å°±ä¸ä¼šè¢«ç¼“å­˜ï¼›å¯ä»¥è·å–åˆ°ç»“æœè¿›è¡Œåˆ¤unless &#x3D; â€œ#result &#x3D;&#x3D; nullâ€unless &#x3D; â€œ#a0&#x3D;&#x3D;2â€:å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼æ˜¯2ï¼Œç»“æœä¸ç¼“å­˜ï¼›</li><li><code>sync</code>ï¼šæ˜¯å¦ä½¿ç”¨å¼‚æ­¥æ¨¡å¼</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"emp"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>keyGenerator <span class="token operator">=</span> <span class="token string">"myKeyGenerator"</span><span class="token punctuation">,</span>condition <span class="token operator">=</span> <span class="token string">"#a0>1"</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">"#a0==2"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŸ¥è¯¢"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"å·å‘˜å·¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> emp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="CachePut"><a href="#CachePut" class="headerlink" title="@CachePut"></a>@CachePut</h3><ul><li><p>æ—¢è°ƒç”¨æ–¹æ³•ï¼Œåˆæ›´æ–°ç¼“å­˜æ•°æ®ï¼›åŒæ­¥æ›´æ–°ç¼“å­˜</p></li><li><p>åº”ç”¨åœºæ™¯ï¼šä¿®æ”¹äº†æ•°æ®åº“çš„æŸä¸ªæ•°æ®ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜ï¼›</p></li><li><p>æµç¨‹ï¼š</p><ol><li>å…ˆè°ƒç”¨ç›®æ ‡æ–¹æ³•</li><li>å°†ç›®æ ‡æ–¹æ³•çš„ç»“æœç¼“å­˜èµ·æ¥</li></ol></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"emp"</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">"#result.id"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">updateEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"updateEmp:"</span><span class="token operator">+</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>    employeeMapper<span class="token punctuation">.</span><span class="token function">updateEmp</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> employee<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="CacheEvict"><a href="#CacheEvict" class="headerlink" title="@CacheEvict"></a>@CacheEvict</h3><ul><li><code>@CacheEvict</code>ï¼šç¼“å­˜æ¸…é™¤</li><li><code>key</code>ï¼šæŒ‡å®šè¦æ¸…é™¤çš„æ•°æ®</li><li><code>allEntries = true</code>ï¼šæŒ‡å®šæ¸…é™¤è¿™ä¸ªç¼“å­˜ä¸­æ‰€æœ‰çš„æ•°æ®</li><li><code>beforeInvocation = false</code>ï¼šç¼“å­˜çš„æ¸…é™¤æ˜¯å¦åœ¨æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚é»˜è®¤ä»£è¡¨ç¼“å­˜æ¸…é™¤æ“ä½œæ˜¯åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ;å¦‚æœå‡ºç°å¼‚å¸¸ç¼“å­˜å°±ä¸ä¼šæ¸…é™¤ã€‚</li><li><code>beforeInvocation = true</code>ï¼šä»£è¡¨æ¸…é™¤ç¼“å­˜æ“ä½œæ˜¯åœ¨æ–¹æ³•è¿è¡Œä¹‹å‰æ‰§è¡Œï¼Œæ— è®ºæ–¹æ³•æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œç¼“å­˜éƒ½æ¸…é™¤</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"emp"</span><span class="token punctuation">,</span>beforeInvocation <span class="token operator">=</span> <span class="token boolean">true</span>ï¼Œkey <span class="token operator">=</span> <span class="token string">"#id"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"deleteEmp:"</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    employeeMapper<span class="token punctuation">.</span><span class="token function">deleteEmpById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Caching"><a href="#Caching" class="headerlink" title="@Caching"></a>@Caching</h3><ul><li><code>@Caching</code> ç»¼åˆä¸Šé¢ä»‹ç»çš„å‡ ä¸ªæ³¨è§£ï¼Œç”¨æ¥å®šä¹‰è¾ƒä¸ºå¤æ‚çš„ç¼“å­˜è§„åˆ™</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Caching</span><span class="token punctuation">(</span>     cacheable <span class="token operator">=</span> <span class="token punctuation">&#123;</span>         <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span><span class="token comment">/*value="emp",*/</span>key <span class="token operator">=</span> <span class="token string">"#lastName"</span><span class="token punctuation">)</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>     put <span class="token operator">=</span> <span class="token punctuation">&#123;</span>         <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span><span class="token comment">/*value="emp",*/</span>key <span class="token operator">=</span> <span class="token string">"#result.id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span><span class="token comment">/*value="emp",*/</span>key <span class="token operator">=</span> <span class="token string">"#result.email"</span><span class="token punctuation">)</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmpByLastName</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpByLastName</span><span class="token punctuation">(</span>lastName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="CacheConfig"><a href="#CacheConfig" class="headerlink" title="@CacheConfig"></a>@CacheConfig</h3><ul><li>åœ¨ç±»ä¸Šä½¿ç”¨ï¼Œæä¾›å…¬å…±å±æ€§ã€‚</li><li><code>cacheNames</code>: ç¼“å­˜åç§°ï¼ŒåŒä¸€ä¸ªç±»ä¸­ï¼Œä¸æŒ‡å®šç¼“å­˜åç§°åˆ™ä½¿ç”¨è¿™ä¸ªåç§°ï¼Œç±»ä¼¼äºä¸€ä¸ªä»¥ç±»ä¸ºå•ä½çš„å…¨å±€é…ç½®ã€‚</li><li>ä¸‹é¢å’Œä¸Šé¢ç±»ä¼¼ï¼Œè€Œä¸”å±æ€§å‰é¢ä¹Ÿæœ‰ä»‹ç»ï¼Œå°±ä¸å¤šè¯´äº†ã€‚</li></ul><p>æºç ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span> <span class="token comment">// è¿™ä¸ªè¡¨ç¤ºåªèƒ½åœ¨ç±»ä¸Šä½¿ç”¨</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token annotation punctuation">@Documented</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">CacheConfig</span> <span class="token punctuation">&#123;</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">cacheNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token class-name">String</span> <span class="token function">keyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token class-name">String</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token class-name">String</span> <span class="token function">cacheResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva3.sinaimg.cn/large/005NNTS5ly1h249s4uychj32yo1o0kjp.jpg" alt="æµ·ç»µå®å®"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot</tag>
      
      <tag>cache</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java DecimalFormatçš„ä¸»è¦åŠŸèƒ½åŠä½¿ç”¨æ–¹æ³•</title>
    <link href="/2022/04/02/java-13/"/>
    <url>/2022/04/02/java-13/</url>
    
    <content type="html"><![CDATA[<p>DecimalFormat æ˜¯ NumberFormat çš„ä¸€ä¸ªå…·ä½“å­ç±»ï¼Œç”¨äºæ ¼å¼åŒ–åè¿›åˆ¶æ•°å­—ã€‚è¯¥ç±»è®¾è®¡æœ‰å„ç§åŠŸèƒ½ï¼Œä½¿å…¶èƒ½å¤Ÿåˆ†æå’Œæ ¼å¼åŒ–ä»»æ„è¯­è¨€ç¯å¢ƒä¸­çš„æ•°ï¼ŒåŒ…æ‹¬å¯¹è¥¿æ–¹è¯­è¨€ã€é˜¿æ‹‰ä¼¯è¯­å’Œå°åº¦è¯­æ•°å­—çš„æ”¯æŒã€‚å®ƒè¿˜æ”¯æŒä¸åŒç±»å‹çš„æ•°ï¼ŒåŒ…æ‹¬æ•´æ•° (123)ã€å®šç‚¹æ•° (123.4)ã€ç§‘å­¦è®°æ•°æ³•è¡¨ç¤ºçš„æ•° (1.23E4)ã€ç™¾åˆ†æ•° (12%) å’Œé‡‘é¢ ($123)ã€‚æ‰€æœ‰è¿™äº›å†…å®¹éƒ½å¯ä»¥æœ¬åœ°åŒ–ã€‚<br>DecimalFormat åŒ…å«ä¸€ä¸ªæ¨¡å¼ å’Œä¸€ç»„ç¬¦å·</p><h2 id="ç¬¦å·å«ä¹‰"><a href="#ç¬¦å·å«ä¹‰" class="headerlink" title="ç¬¦å·å«ä¹‰"></a>ç¬¦å·å«ä¹‰</h2><table><thead><tr><th>ç¬¦å·</th><th>ä½ç½®</th><th>æœ¬åœ°åŒ–ï¼Ÿ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>0</td><td>æ•°å­—</td><td>æ˜¯</td><td>é˜¿æ‹‰ä¼¯æ•°å­—</td></tr><tr><td>#</td><td>æ•°å­—å­—</td><td>æ˜¯</td><td>é˜¿æ‹‰ä¼¯æ•°å­—ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ˜¾ç¤ºä¸ºç©º</td></tr><tr><td>.</td><td>æ•°å­—</td><td>æ˜¯</td><td>å°æ•°åˆ†éš”ç¬¦æˆ–è´§å¸å°æ•°åˆ†éš”ç¬¦</td></tr><tr><td>-</td><td>æ•°å­—</td><td>æ˜¯</td><td>å‡å·</td></tr><tr><td>,</td><td>æ•°å­—</td><td>æ˜¯</td><td>åˆ†ç»„åˆ†éš”ç¬¦</td></tr><tr><td>E</td><td>æ•°å­—</td><td>æ˜¯</td><td>åˆ†éš”ç§‘å­¦è®¡æ•°æ³•ä¸­çš„å°¾æ•°å’ŒæŒ‡æ•°ã€‚åœ¨å‰ç¼€æˆ–åç¼€ä¸­æ— éœ€åŠ å¼•å·ã€‚</td></tr><tr><td>;</td><td>å­æ¨¡å¼è¾¹ç•Œ</td><td>æ˜¯</td><td>åˆ†éš”æ­£æ•°å’Œè´Ÿæ•°å­æ¨¡å¼</td></tr><tr><td>%</td><td>å‰ç¼€æˆ–åç¼€</td><td>æ˜¯</td><td>ä¹˜ä»¥ 100 å¹¶æ˜¾ç¤ºä¸ºç™¾åˆ†æ•°</td></tr></tbody></table><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">DecimalFormat</span> df1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"0.0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">DecimalFormat</span> df2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#.#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">DecimalFormat</span> df3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"000.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">DecimalFormat</span> df4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"###.###"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df1<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12.34</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df2<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12.34</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12.34</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>df4<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12.34</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿è¡Œç»“æœï¼š </span><span class="token number">12.3</span> <span class="token number">12.3</span> <span class="token number">012.340</span> <span class="token number">12.34</span><span class="token class-name">DecimalFormat</span> format <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"###,####.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>format<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">111111123456.1227222</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token function">setDefault</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>US<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">DecimalFormat</span> usFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"###,###.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>usFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">111111123456.1227222</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">DecimalFormat</span> addPattenFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> addPattenFormat<span class="token punctuation">.</span><span class="token function">applyPattern</span><span class="token punctuation">(</span><span class="token string">"##,###.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>addPattenFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">111111123456.1227</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">DecimalFormat</span> zhiFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> zhiFormat<span class="token punctuation">.</span><span class="token function">applyPattern</span><span class="token punctuation">(</span><span class="token string">"0.000E0000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zhiFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zhiFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12345678.345</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">DecimalFormat</span> percentFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> percentFormat<span class="token punctuation">.</span><span class="token function">applyPattern</span><span class="token punctuation">(</span><span class="token string">"#0.000%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>percentFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0.3052222</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> è¿è¡Œç»“æœ ï¼š<span class="token number">1111</span><span class="token punctuation">,</span><span class="token number">1112</span><span class="token punctuation">,</span><span class="token number">3456.123</span> <span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456.123</span> <span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456.123</span> <span class="token number">1.000E0004</span> <span class="token number">1.235E0007</span> <span class="token number">30.522</span><span class="token operator">%</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¦‚æœä½¿ç”¨å…·æœ‰å¤šä¸ªåˆ†ç»„å­—ç¬¦çš„æ¨¡å¼ï¼Œåˆ™æœ€åä¸€ä¸ªåˆ†éš”ç¬¦å’Œæ•´æ•°ç»“å°¾ä¹‹é—´çš„é—´éš”æ‰æ˜¯ä½¿ç”¨çš„åˆ†ç»„å¤§å°ã€‚</p><p>æ‰€ä»¥ â€œ#,##,###,####â€ &#x3D;&#x3D; â€œ######,####â€ &#x3D;&#x3D; â€œ##,####,####â€ã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva3.sinaimg.cn/large/005NNTS5ly1h0zyye8c98j32yo1o0e82.jpg" alt="é›†åŸç¾"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DecimalFormat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oracleç‰ˆæœ¬å¯¹åº”åŒ¹é…çš„ojdbcç‰ˆæœ¬åŠJDKç‰ˆæœ¬</title>
    <link href="/2022/04/02/java-12/"/>
    <url>/2022/04/02/java-12/</url>
    
    <content type="html"><![CDATA[<p>Oracle JDBC ç‰ˆæœ¬ä¸ JDK ç‰ˆæœ¬çš„å…³ç³»å¦‚ä½•ï¼Ÿ<br>Oracle JDBC é©±åŠ¨ç¨‹åºå§‹ç»ˆä¸æ¯ä¸€ä¸ªæ–°ç‰ˆæœ¬ä¸­çš„æœ€æ–° JDK ç‰ˆæœ¬ç›¸å…¼å®¹ã€‚åœ¨æŸäº›ç‰ˆæœ¬ä¸­ï¼ŒJDBC é©±åŠ¨ç¨‹åºæ”¯æŒå¤šä¸ª JDK ç‰ˆæœ¬ã€‚è¯·ä½¿ç”¨ä¸‹è¡¨æ ¹æ®æ‚¨çš„é¦–é€‰ JDK ç‰ˆæœ¬é€‰æ‹©æ­£ç¡®çš„ JDBC é©±åŠ¨ç¨‹åºã€‚</p><table><thead><tr><th>Oracle æ•°æ®åº“ç‰ˆæœ¬</th><th>ç‰¹å®šäºå‘è¡Œç‰ˆçš„ JDBC Jar æ–‡ä»¶</th></tr></thead><tbody><tr><td>21.1</td><td>ojdbc11.jarï¼Œéšå¸¦ JDK11ã€JDK12ã€JDK13ã€JDK14 å’Œ JDK15ï¼›ojdbc8.jar ï¼Œéšå¸¦ JDK8ã€JDK11ã€JDK12ã€JDK13ã€JDK14 å’Œ JDK15</td></tr><tr><td>19.x</td><td>ojdbc10.jarï¼Œéšå¸¦ JDK10 å’Œ JDK11ï¼›ojdbc8.jarï¼Œéšå¸¦ JDK8ã€JDK9 å’Œ JDK11</td></tr><tr><td>18.3</td><td>ojdbc8.jarï¼Œéšå¸¦ JDK8ã€JDK9ã€JDK10 å’Œ JDK11</td></tr><tr><td>12.2 æˆ– 12cR2</td><td>ojdbc8.jarï¼Œéšå¸¦ JDK8</td></tr><tr><td>12.1 æˆ– 12cR1</td><td>ojdbc7.jar with JDK 7 and JDK 8ï¼›ojdbc6.jarï¼Œéšå¸¦ JDK 6</td></tr><tr><td>11.2 æˆ– 11gR2</td><td>ojdbc6.jarï¼Œéšå¸¦ JDK 6ã€JDK 7 å’Œ JDK 8ï¼›ï¼ˆæ³¨æ„ï¼šä»… 11.2.0.3 å’Œ 11.2.0.4 æ”¯æŒ JDK7 å’Œ JDK8ï¼‰ï¼›ojdbc5.jarï¼Œéšå¸¦ JDK 5</td></tr></tbody></table><p><a href="https://www.oracle.com/cn/database/technologies/faq-jdbc.html">oracleå¸¸è§é—®é¢˜</a></p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1h0ve62trn6j32yo1o0b2a.jpg" alt="å¥³å­©"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oracle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu20.x.xä½¿ç”¨rootç™»å½•</title>
    <link href="/2022/04/02/linux-01/"/>
    <url>/2022/04/02/linux-01/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h2><p>ä»¥æ™®é€šç”¨æˆ·ç™»å½•ç³»ç»Ÿï¼Œåˆ›å»ºrootç”¨æˆ·çš„å¯†ç <br>åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š</p><p><code>sudo passwd root</code></p><p>ç„¶åè¾“å…¥è®¾ç½®çš„å¯†ç ï¼Œè¾“å…¥ä¸¤æ¬¡ï¼Œè¿™æ ·å°±å®Œæˆäº†è®¾ç½®rootç”¨æˆ·å¯†ç äº†ï¼Œå¦‚æœåªéœ€è¦ä¸´æ—¶è·å–rootæƒé™ï¼Œåœ¨æ­¤æ­¥æ“ä½œåå°±å¯ä»¥åœ¨æ™®é€šç”¨æˆ·ç™»å½•çš„ç»ˆç«¯ä¸­è¾“å…¥<code>su root</code> ç„¶åè¾“å…¥ä¸¤éå¯†ç å³å¯åœ¨ç»ˆç«¯ä¸­è·å–rootæƒé™ã€‚å¯ä»¥ç¨å¾®é˜²æ­¢ä¸€ç‚¹æ¿€æƒ…åˆ åº“è¿™ä¸€æ­¥éª¤ã€‚</p><h2 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h2><p>ä¿®æ”¹æ–‡ä»¶<code>sudo gedit /usr/share/lightdm/lightdm.conf.d/50-ubuntu.conf</code><br>åœ¨æ–‡ä»¶æœ«å°¾å¢åŠ å¦‚ä¸‹ä¸¤è¡Œï¼š<br><code>greeter-show-manual-login=true</code><br><code>all-guest=false</code>  </p><h2 id="ç¬¬ä¸‰æ­¥"><a href="#ç¬¬ä¸‰æ­¥" class="headerlink" title="ç¬¬ä¸‰æ­¥"></a>ç¬¬ä¸‰æ­¥</h2><p>ä¿®æ”¹ <code>/etc/pam.d/gdm-autologin</code><br>  <code>/etc/pam.d/gdm-password</code><br>ä¸¤ä¸ªæ–‡ä»¶</p><p><code>sudo gedit /etc/pam.d/gdm-autologin</code><br>æ³¨é‡Šæ‰<code>auth required pam_succeed_if.so user != root quiet_success</code>è¿™ä¸€è¡Œ(ç¬¬ä¸‰è¡Œå·¦å³)</p><p><code>sudo gedit /etc/pam.d/gdm-password</code><br>æ³¨é‡Šæ‰ <code>auth required pam_succeed_if.so user != root quiet_success</code>è¿™ä¸€è¡Œ(ç¬¬ä¸‰è¡Œå·¦å³)</p><h2 id="ç¬¬å››æ­¥"><a href="#ç¬¬å››æ­¥" class="headerlink" title="ç¬¬å››æ­¥"></a>ç¬¬å››æ­¥</h2><p>ä¿®æ”¹<code>/root/.profile</code>æ–‡ä»¶<br><code>sudo gedit /root/.profile</code><br>å°†æ–‡ä»¶æœ«å°¾çš„<code>mesg n 2&gt; /dev/null || true</code>è¿™ä¸€è¡Œä¿®æ”¹æˆ<br><code>tty -s &amp;&amp; mesg n || true</code></p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1h0v56otfr4j32yo1o04qr.jpg" alt="åŸç¥-é£åèŠ‚"></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>ubuntu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxè¯¦ç»†é…ç½®</title>
    <link href="/2022/03/17/vue-05/"/>
    <url>/2022/03/17/vue-05/</url>
    
    <content type="html"><![CDATA[<p>Nginxçš„é…ç½®è®°äº†å¿˜ï¼Œå¿˜äº†è®°ï¼Œè¿™ä¸œè¥¿ï¼Œä¸€èˆ¬å°±æ˜¯ä¸€å¥—é…ç½®ï¼Œåˆ°å¤„å¤åˆ¶ï¼Œç„¶åæ”¹æ”¹ï¼Œç»å¤§å¤šæ•°æ—¶å€™å¯¹äºæˆ‘ä»¬çš„è¦æ±‚å°±æ˜¯éœ€è¦çŸ¥é“æ”¹ä»€ä¹ˆåœ°æ–¹ï¼Œnginxç›¸å…³çš„åšå®¢ï¼Œæˆ‘å¥½åƒä¸æ­¢å†™äº†ä¸€æ¬¡ï¼Œç„¶è€Œå±å®ä¸æ€ä¹ˆå¸¸ç”¨ï¼Œå­¦å¾—å¿«ï¼Œå¿˜å¾—æ›´å¿«ï¼Œç„¶åå€Ÿè¿™æ¬¡å§ï¼Œé‡æ–°å†å†™ä¸€ä¸‹ã€‚nginxçš„é…ç½®éš¾ä»¥ç†è§£çš„åœ°æ–¹ã€‚å°±æ˜¯é…ç½®httpsï¼Œå…¶å®ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„ã€‚</p><h2 id="æ•™ç¨‹å‡†å¤‡"><a href="#æ•™ç¨‹å‡†å¤‡" class="headerlink" title="æ•™ç¨‹å‡†å¤‡"></a>æ•™ç¨‹å‡†å¤‡</h2><h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>å¦‚æ—¥ä¸­å¤©çš„CenterOså€’äº†ï¼ˆåœæ­¢ç»´æŠ¤ï¼‰ã€‚äºæ˜¯æˆ‘å°±æ¢ä¸Šäº†Ubuntuã€‚</p><p>Linuxç³»ç»Ÿï¼šUbuntu20.x.x</p><h3 id="å®‰è£…æ–¹å¼"><a href="#å®‰è£…æ–¹å¼" class="headerlink" title="å®‰è£…æ–¹å¼"></a>å®‰è£…æ–¹å¼</h3><p>ä¸¤ç§å®‰è£…æ–¹å¼ï¼Œä½¿ç”¨å‘½ä»¤å¼çš„å®‰è£…æ˜¯æœ€ä¸ºç®€å•çš„ï¼Œä½†å—é™äºç½‘ç»œã€‚ä¸‹è½½æºç ç¼–è¯‘å®‰è£…æœ€ä¸ºé€šç”¨ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹ç¹çã€‚</p><h4 id="APTï¼ˆè½¯ä»¶æºï¼‰å®‰è£…"><a href="#APTï¼ˆè½¯ä»¶æºï¼‰å®‰è£…" class="headerlink" title="APTï¼ˆè½¯ä»¶æºï¼‰å®‰è£…"></a>APTï¼ˆè½¯ä»¶æºï¼‰å®‰è£…</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®‰è£…ä¹‹å‰çš„å‡†å¤‡</span><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">curl</span> gnupg2 ca-certificates lsb-release ubuntu-keyring<span class="token comment"># å¯¼å…¥å®˜æ–¹çš„nginxç­¾åå¯†é’¥ï¼Œä»¥ä¾¿aptèƒ½å¤ŸéªŒè¯è½¯ä»¶åŒ…çš„çœŸå®æ€§</span><span class="token function">curl</span> https://nginx.org/keys/nginx_signing.key <span class="token operator">|</span> gpg --dearmor <span class="token punctuation">\</span>    <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /usr/share/keyrings/nginx-archive-keyring.gpg <span class="token operator">></span>/dev/null<span class="token comment"># éªŒè¯ä¸‹è½½çš„æ–‡ä»¶æ˜¯å¦åŒ…å«æ­£ç¡®çš„å¯†é’¥</span>gpg --dry-run --quiet --import --import-options import-show /usr/share/keyrings/nginx-archive-keyring.gpg<span class="token comment"># è¾“å‡ºå³å¯</span>pub   rsa2048 <span class="token number">2011</span>-08-19 <span class="token punctuation">[</span>SC<span class="token punctuation">]</span> <span class="token punctuation">[</span>expires: <span class="token number">2024</span>-06-14<span class="token punctuation">]</span>      573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62uid                      nginx signing key <span class="token operator">&lt;</span>signing-key@nginx.com<span class="token operator">></span><span class="token comment"># æ›´æ–°</span><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token comment"># å®‰è£… æœ‰æç¤ºï¼Œy å›è½¦å³å¯</span><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nginx<span class="token comment"># æµ‹è¯•æ˜¯å¦æˆåŠŸå®‰è£…, è¾“å‡ºç‰ˆæœ¬å·ï¼Œå³å®‰è£…å®Œæˆ</span>nginx -v<span class="token comment"># æµ‹è¯•è®¿é—®</span><span class="token function">curl</span> https://localhost<span class="token comment"># è¾“å‡º</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span><span class="token operator">&lt;</span>title<span class="token operator">></span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">></span><span class="token operator">&lt;</span>style<span class="token operator">></span>    body <span class="token punctuation">&#123;</span>        width: 35em<span class="token punctuation">;</span>        margin: <span class="token number">0</span> auto<span class="token punctuation">;</span>        font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span>/style<span class="token operator">></span><span class="token operator">&lt;</span>/head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>></span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>></span><span class="token operator">&lt;</span>p<span class="token operator">></span>If you see this page, the nginx web server is successfully installed andworking. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>p<span class="token operator">></span>For online documentation and support please refer to<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"http://nginx.org/"</span><span class="token operator">></span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">></span>.<span class="token operator">&lt;</span>br/<span class="token operator">></span>Commercial support is available at<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"http://nginx.com/"</span><span class="token operator">></span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">></span>.<span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token operator">&lt;</span>em<span class="token operator">></span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">></span><span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>/body<span class="token operator">></span><span class="token operator">&lt;</span>/html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æŒ‰ç…§ä¸Šé¢çš„æ“ä½œå¦‚æœå‡ºç°æœ€åçš„Htmlæ–‡æ¡£è¯´æ˜å·²ç»æ­£ç¡®å®‰è£…äº†ã€‚</p><h4 id="æºç å®‰è£…"><a href="#æºç å®‰è£…" class="headerlink" title="æºç å®‰è£…"></a>æºç å®‰è£…</h4><p>æ¯”è¾ƒé€šç”¨çš„ä¸€ç§å®‰è£…æ–¹æ³•ã€‚é¦–å…ˆä¸‹è½½å®‰è£…åŒ…ã€‚<a href="http://nginx.org/en/download.html">nginxä¸‹è½½</a>ï¼Œä¸‹è½½ç¨³å®šç‰ˆçš„å³å¯ã€‚æˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯<a href="http://nginx.org/download/nginx-1.20.2.tar.gz">nginx-1.20.2</a>ï¼Œç‚¹å‡»ä¸‹è½½åˆ°æœ¬åœ°ï¼Œä¸Šä¼ åˆ°ä½ çš„LinuxæœåŠ¡å™¨ä¸Šã€‚ä¸Šä¼ æ–¹æ³•ä¸é™ï¼Œå¼„åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶å¤¹é‡Œå³å¯ã€‚</p><p>è¿›å…¥å­˜æ”¾tar.gzæ–‡ä»¶çš„ç›®å½•ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># è§£å‹æºç æ–‡ä»¶</span><span class="token function">tar</span> -zxcf nginx-1.20.2.tar.gz<span class="token comment"># è¿›å…¥è§£å‹åçš„æ–‡ä»¶ä¸­</span><span class="token builtin class-name">cd</span> nginx-1.20.2<span class="token comment"># åˆ›å»ºä¸€ä¸ªç¼“å­˜æ–‡ä»¶å¤¹</span><span class="token function">mkdir</span> /var/temp/nginx -p<span class="token comment"># å®‰è£…ç”Ÿæˆå®‰è£…æ–‡ä»¶å‰çš„å¿…è¦ä¾èµ–ã€‚</span><span class="token comment"># ä¸å»ºè®®æ‰‹åŠ¨ç¼–è¯‘å®‰è£…å±å®æ˜¯å¤ªéº»çƒ¦äº†</span><span class="token function">apt</span> <span class="token function">install</span> build-essential libssl-dev libghc-zlib-dev libpcre3-dev<span class="token comment"># åœ¨nginxç›®å½•ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œé…ç½®ï¼Œç›®çš„æ˜¯ä¸ºäº†åˆ›å»ºmakefileæ–‡ä»¶</span><span class="token comment"># æ³¨æ„ä¸€ä¸‹é…ç½®ä¸­çš„ç›®å½•å³å¯</span>./configure <span class="token punctuation">\</span>--prefix<span class="token operator">=</span>/usr/local/nginx <span class="token punctuation">\</span>--pid-path<span class="token operator">=</span>/var/run/nginx/nginx.pid <span class="token punctuation">\</span>--lock-path<span class="token operator">=</span>/var/lock/nginx.lock <span class="token punctuation">\</span>--error-log-path<span class="token operator">=</span>/var/log/nginx/error.log <span class="token punctuation">\</span>--http-log-path<span class="token operator">=</span>/var/log/nginx/access.log <span class="token punctuation">\</span>--with-http_gzip_static_module <span class="token punctuation">\</span>--http-client-body-temp-path<span class="token operator">=</span>/var/temp/nginx/client <span class="token punctuation">\</span>--http-proxy-temp-path<span class="token operator">=</span>/var/temp/nginx/proxy <span class="token punctuation">\</span>--http-fastcgi-temp-path<span class="token operator">=</span>/var/temp/nginx/fastcgi <span class="token punctuation">\</span>--http-uwsgi-temp-path<span class="token operator">=</span>/var/temp/nginx/uwsgi <span class="token punctuation">\</span>--http-scgi-temp-path<span class="token operator">=</span>/var/temp/nginx/scgi  <span class="token punctuation">\</span>--with-http_ssl_module<span class="token comment"># å¦‚æœæŠ¥é”™å¦‚ä¸‹ï¼Œ</span>checking <span class="token keyword">for</span> OS + Linux <span class="token number">5.13</span>.0-37-generic x86_64checking <span class="token keyword">for</span> C compiler <span class="token punctuation">..</span>. not found./configure: error: C compiler cc is not found<span class="token comment"># è¯´æ˜ç¼ºå°‘ç¼–è¯‘ä¾èµ–ã€‚å†æ¬¡æ‰§è¡Œæ­¤å‘½ä»¤ã€‚</span><span class="token function">apt</span> <span class="token function">install</span> build-essential libssl-dev libghc-zlib-dev libpcre3-dev<span class="token comment"># ç”Ÿæˆå®‰è£…æ–‡ä»¶æˆåŠŸååº”è¯¥ä¼šè¾“å‡ºç±»ä¼¼ä¸‹é¢çš„å†…å®¹</span>  nginx path prefix: <span class="token string">"/usr/local/nginx"</span>  nginx binary file: <span class="token string">"/usr/local/nginx/sbin/nginx"</span>  nginx modules path: <span class="token string">"/usr/local/nginx/modules"</span>  nginx configuration prefix: <span class="token string">"/usr/local/nginx/conf"</span>  nginx configuration file: <span class="token string">"/usr/local/nginx/conf/nginx.conf"</span>  nginx pid file: <span class="token string">"/var/run/nginx/nginx.pid"</span>  nginx error log file: <span class="token string">"/var/log/nginx/error.log"</span>  nginx http access log file: <span class="token string">"/var/log/nginx/access.log"</span>  nginx http client request body temporary files: <span class="token string">"/var/temp/nginx/client"</span>  nginx http proxy temporary files: <span class="token string">"/var/temp/nginx/proxy"</span>  nginx http fastcgi temporary files: <span class="token string">"/var/temp/nginx/fastcgi"</span>  nginx http uwsgi temporary files: <span class="token string">"/var/temp/nginx/uwsgi"</span>  nginx http scgi temporary files: <span class="token string">"/var/temp/nginx/scgi"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>é…ç½®ç›¸å…³ä¿¡æ¯æ±‡æ€»ï¼Œçœ‹è¡¨æ ¼</p>          </div><table><thead><tr><th>å‘½ä»¤</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>â€“prefix</td><td>æŒ‡å®šnginxå®‰è£…ç›®å½•</td></tr><tr><td>â€“pid-path</td><td>æŒ‡å®šnginxçš„pid</td></tr><tr><td>â€“lock-path</td><td>é”å®šå®‰è£…æ–‡ä»¶ï¼Œé˜²æ­¢ç¯¡æ”¹</td></tr><tr><td>â€“error-log-path</td><td>é”™è¯¯æ—¥å¿—</td></tr><tr><td>â€“http-log-path</td><td>æ—¥å¿—</td></tr><tr><td>â€“http-log-path</td><td>æ—¥å¿—</td></tr><tr><td>â€“with-http_gzip_static_module</td><td>å¯ç”¨gzipæ¨¡å—ï¼Œåœ¨çº¿å®æ—¶å‹ç¼©è¾“å‡ºæ•°æ®æµ</td></tr><tr><td>â€“http-client-body-temp-path</td><td>è®¾å®šå®¢æˆ·ç«¯è¯·æ±‚ä¸´æ—¶ç›®å½•</td></tr><tr><td>â€“http-proxy-temp-path</td><td>è®¾å®šhttpä»£ç†ä¸´æ—¶ç›®å½•</td></tr><tr><td>â€“http-fastcgi-temp-path</td><td>è®¾å®šfastcgiä¸´æ—¶ç›®å½•</td></tr><tr><td>â€“http-uwsgi-temp-path</td><td>è®¾å®šuwsgiä¸´æ—¶ç›®å½•</td></tr><tr><td>â€“http-scgi-temp-path</td><td>è®¾å®šscgiä¸´æ—¶ç›®å½•</td></tr><tr><td>â€“with-http_ssl_module</td><td>å¯ç”¨Httpsæ¨¡å—</td></tr></tbody></table><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># makeç¼–è¯‘</span><span class="token function">make</span><span class="token comment"># å®‰è£…</span><span class="token function">make</span> <span class="token function">install</span><span class="token comment"># è¿›å…¥sbinç›®å½•å¯åŠ¨nginx</span><span class="token comment"># å¯åŠ¨ï¼š</span>./nginx<span class="token comment"># åœæ­¢ï¼š</span>./nginx -s stop<span class="token comment"># é‡æ–°åŠ è½½ï¼š</span>./nginx -s reload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åœ¨Ubuntuä¸Šnginxå®‰è£…çš„ä¸¤ç§æ–¹å¼éƒ½å·²ä»‹ç»å®Œæ¯•ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯CentOs,é‚£å¾ˆå¯æƒœï¼Œæ•™ç¨‹å¹¶ä¸é€‚ç”¨ã€‚æˆ‘è¿™è¾¹å‘¢æ˜¯å»ºè®®ä½¿ç”¨apt,yumè¿™ç§å·¥å…·å»å®‰è£…nginxçš„ï¼Œä¼˜ç‚¹æœ‰å¾ˆå¤šã€‚</p><p>ç¬¬ä¸€ï¼šèŠ‚çœæœåŠ¡å™¨ç©ºé—´å› ä¸ºä¸éœ€è¦ç¼–è¯‘ç¯å¢ƒï¼Œç¬¬äºŒï¼ŒèŠ‚çœå¼€å‘è€…ç”Ÿå‘½ã€‚</p><h2 id="æµ…è¯´ä¸€ä¸‹APTå’ŒYumâ€¦ç­‰ç­‰ç±»ä¼¼å·¥å…·ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿"><a href="#æµ…è¯´ä¸€ä¸‹APTå’ŒYumâ€¦ç­‰ç­‰ç±»ä¼¼å·¥å…·ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿" class="headerlink" title="æµ…è¯´ä¸€ä¸‹APTå’ŒYumâ€¦ç­‰ç­‰ç±»ä¼¼å·¥å…·ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿"></a>æµ…è¯´ä¸€ä¸‹APTå’ŒYumâ€¦ç­‰ç­‰ç±»ä¼¼å·¥å…·ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿</h2><p>æˆ‘ä»¬åœ¨æœç´¢çš„æ—¶å€™ï¼Œæœ‰æ—¶ä¼šæœåˆ°ä¸€äº›apt-getå‘½ä»¤çš„æ“ä½œã€‚</p><div class="note note-info">            <p>ä½¿ç”¨aptï¼getçš„ä¸»æµLinuxç³»ç»ŸåŒ…æ‹¬Debianå’ŒUbuntuå˜å¼‚ç‰ˆæœ¬ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»å‘½ä»¤è¡Œè¿è¡Œè¯¥å·¥å…·ã€‚æ¡Œé¢ä¸Šæœ‰å‡ ä¸ªå›¾å½¢å‰ç«¯å¯ä»¥ä½¿ç”¨ï¼ŒåŒ…æ‹¬Synaptic Package Managerã€Ubuntu Software Centerã€Aptitudeå’ŒKpackageã€‚<br>Raspberry Piå’ŒBeaglebone Black nanoLinuxç‰ˆç”¨æˆ·å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨aptï¼getåŠ è½½ç¨‹åºï¼Œå› ä¸ºè¿™äº›ç³»ç»Ÿé€šå¸¸æ¥è‡ªUbuntuæˆ–Debianä»£ç ã€‚æ˜¯debianï¼Œubuntuå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å·¥å…·ï¼Œä¸çº¢å¸½ä¸­çš„ã€Œyumã€å·¥å…·éå¸¸ç±»ä¼¼ã€‚<br>aptï¼getå‘½ä»¤ä¸€èˆ¬éœ€è¦ã€Œrootæƒé™ã€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸€èˆ¬è·Ÿç€sudoå‘½ä»¤ã€‚<br>apt å‘½ä»¤è¡Œå®ç”¨ç¨‹åºäº2014å¹´æ¨å‡ºç¬¬ä¸€ä¸ªç¨³å®šç‰ˆæœ¬ï¼Œç”¨äº Debian å‘è¡Œç‰ˆ ï¼deb è½¯ä»¶åŒ…å®‰è£…ã€‚å®ƒæœ€åˆåœ¨ä¸ç¨³å®šçš„Debianç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œç„¶ååœ¨Debian 8ä¸­æˆä¸ºæ ‡å‡†ã€‚<br>åœ¨ Ubuntu 16ï¼04 å‘è¡Œåï¼Œapt å¼€å§‹æµè¡Œï¼Œå¹¶ä»¥æŸç§æ–¹å¼å–ä»£äº† aptï¼get ã€‚<br>éšç€ apt install package å‘½ä»¤çš„ä½¿ç”¨é¢‘ç‡å’Œæ™®éæ€§é€æ­¥è¶…è¿‡ aptï¼get install packageï¼Œè¶Šæ¥è¶Šå¤šçš„å…¶å®ƒ Linux å‘è¡Œç‰ˆä¹Ÿå¼€å§‹éµå¾ª Ubuntu çš„è„šæ­¥ï¼Œå¼€å§‹é¼“åŠ±ç”¨æˆ·ä½¿ç”¨ apt è€Œä¸æ˜¯ aptï¼getã€‚<br>å¤§å¤šæ•°äººä¸äº†è§£ apt å’Œ aptï¼get ä¹‹é—´çš„åŒºåˆ«ï¼Œå¹¶ä¸”ç»å¸¸åœ¨ä½¿ç”¨ä¸€ä¸ªæˆ–å¦ä¸€ä¸ªæ—¶æ„Ÿåˆ°å›°æƒ‘ã€‚<br>ä¸¤è€…éƒ½æ˜¯å¼€æºå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç®¡ç†è½¯ä»¶åŒ…ï¼Œä¾‹å¦‚å®‰è£…ï¼Œæ›´æ–°ï¼Œå‡çº§å’Œåˆ é™¤ã€‚<br>ä½†æ˜¯ï¼Œå®ƒä»¬ä¹‹é—´ä»ç„¶å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚</p>          </div><h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3><div class="note note-info">            <p>aptï¼ˆAdvanced Packaging Toolï¼‰æ˜¯ä¸€ä¸ªåœ¨ Debian å’Œ Ubuntu ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚<br>apt å‘½ä»¤æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€å‡çº§ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚<br>apt å‘½ä»¤æ‰§è¡Œéœ€è¦è¶…çº§ç®¡ç†å‘˜æƒé™(root)ã€‚</p>          </div><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@ubuntu:/usr/local/nginx/sbin<span class="token comment"># apt -h</span><span class="token function">apt</span> <span class="token number">2.0</span>.6 <span class="token punctuation">(</span>amd64<span class="token punctuation">)</span>ç”¨æ³•ï¼š <span class="token function">apt</span> <span class="token punctuation">[</span>é€‰é¡¹<span class="token punctuation">]</span> å‘½ä»¤å‘½ä»¤è¡Œè½¯ä»¶åŒ…ç®¡ç†å™¨ <span class="token function">apt</span> æä¾›è½¯ä»¶åŒ…æœç´¢ï¼Œç®¡ç†å’Œä¿¡æ¯æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚å®ƒæä¾›çš„åŠŸèƒ½ä¸å…¶ä»– APT å·¥å…·ç›¸åŒï¼ˆåƒ <span class="token function">apt-get</span> å’Œ apt-cacheï¼‰ï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹è¢«è®¾ç½®å¾—æ›´é€‚åˆäº¤äº’ã€‚å¸¸ç”¨å‘½ä»¤ï¼š  list - æ ¹æ®åç§°åˆ—å‡ºè½¯ä»¶åŒ…  search - æœç´¢è½¯ä»¶åŒ…æè¿°  show - æ˜¾ç¤ºè½¯ä»¶åŒ…ç»†èŠ‚  <span class="token function">install</span> - å®‰è£…è½¯ä»¶åŒ…  reinstall - é‡æ–°å®‰è£…è½¯ä»¶åŒ…  remove - ç§»é™¤è½¯ä»¶åŒ…  autoremove - å¸è½½æ‰€æœ‰è‡ªåŠ¨å®‰è£…ä¸”ä¸å†ä½¿ç”¨çš„è½¯ä»¶åŒ…  update - æ›´æ–°å¯ç”¨è½¯ä»¶åŒ…åˆ—è¡¨  upgrade - é€šè¿‡ å®‰è£…/å‡çº§ è½¯ä»¶æ¥æ›´æ–°ç³»ç»Ÿ  full-upgrade - é€šè¿‡ å¸è½½/å®‰è£…/å‡çº§ æ¥æ›´æ–°ç³»ç»Ÿ  edit-sources - ç¼–è¾‘è½¯ä»¶æºä¿¡æ¯æ–‡ä»¶  satisfy - ä½¿ç³»ç»Ÿæ»¡è¶³ä¾èµ–å…³ç³»å­—ç¬¦ä¸²å‚è§ apt<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> ä»¥è·å–æ›´å¤šå…³äºå¯ç”¨å‘½ä»¤çš„ä¿¡æ¯ã€‚ç¨‹åºé…ç½®é€‰é¡¹åŠè¯­æ³•éƒ½å·²ç»åœ¨ apt.conf<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> ä¸­é˜æ˜ã€‚æ¬²çŸ¥å¦‚ä½•é…ç½®è½¯ä»¶æºï¼Œè¯·å‚é˜… sources.list<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>ã€‚è½¯ä»¶åŒ…åŠå…¶ç‰ˆæœ¬åå¥½å¯ä»¥é€šè¿‡ apt_preferences<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> æ¥è®¾ç½®ã€‚å…³äºå®‰å…¨æ–¹é¢çš„ç»†èŠ‚å¯ä»¥å‚è€ƒ apt-secure<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>.                                         æœ¬ APT å…·æœ‰è¶…çº§ç‰›åŠ›ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Yum"><a href="#Yum" class="headerlink" title="Yum"></a>Yum</h3><div class="note note-info">            <p>yumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨ Fedora å’Œ RedHat ä»¥åŠ SUSE ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚ï¼ˆä¸€èˆ¬CentOSå°±ç”¨è¿™ä¸ªï¼‰<br>åŸºäº RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚<br>yum æä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚</p>          </div><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update<span class="token number">2</span>. æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update<span class="token number">3</span>. ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum <span class="token function">install</span> <span class="token operator">&lt;</span>package_name<span class="token operator">></span><span class="token number">4</span>. ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update <span class="token operator">&lt;</span>package_name<span class="token operator">></span><span class="token number">5</span>. åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list<span class="token number">6</span>. åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove <span class="token operator">&lt;</span>package_name<span class="token operator">></span><span class="token number">7</span>. æŸ¥æ‰¾è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum search <span class="token operator">&lt;</span>keyword<span class="token operator">></span><span class="token number">8</span>. æ¸…é™¤ç¼“å­˜å‘½ä»¤:yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headersyum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headersyum clean, yum clean all <span class="token punctuation">(</span><span class="token operator">=</span> yum clean packages<span class="token punctuation">;</span> yum clean oldheaders<span class="token punctuation">)</span> :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„ headers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="é»˜è®¤é…ç½®è§£è¯»"><a href="#é»˜è®¤é…ç½®è§£è¯»" class="headerlink" title="é»˜è®¤é…ç½®è§£è¯»"></a>é»˜è®¤é…ç½®è§£è¯»</h2><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># è¿è¡Œç”¨æˆ·ï¼Œä¸€èˆ¬è®¾ç½®æˆrootç”¨æˆ·å³å¯ï¼Œç™¾åº¦äº†ä¸€ä¸‹æ˜¯ç”¨æ¥æ§åˆ¶æƒé™çš„ã€‚æ ¹æ®Liunxç³»ç»Ÿçš„ç”¨æˆ·æ¥é…ç½®å³å¯ï¼Œè¯è¯´é€šè¿‡shellçª—å£æ¥æ“ä½œLinuxçš„ç”¨æˆ·çš„ç›¸å…³å‘½ä»¤ï¼Œåº”è¯¥ä¸å¸¸ç”¨ã€‚</span>user www-data<span class="token punctuation">;</span><span class="token comment"># å¯åŠ¨è¿›ç¨‹,é€šå¸¸è®¾ç½®æˆå’Œcpuçš„æ•°é‡ç›¸ç­‰ï¼Œauto è¡¨ç¤ºè‡ªåŠ¨</span>worker_processes auto<span class="token punctuation">;</span><span class="token comment"># å…¨å±€è¿è¡ŒPIDæ–‡ä»¶</span>pid /run/nginx.pid<span class="token punctuation">;</span><span class="token comment"># å¯¼å…¥æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ä»¥.confç»“å°¾çš„é…ç½®æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯ä¸€äº›æ¨¡å—çš„è®¾ç½®</span>include /etc/nginx/modules-enabled/*.conf<span class="token punctuation">;</span>events <span class="token punctuation">&#123;</span> <span class="token comment"># å•ä¸ªåå°worker processè¿›ç¨‹çš„æœ€å¤§å¹¶å‘é“¾æ¥æ•°</span> worker_connections <span class="token number">768</span><span class="token punctuation">;</span> <span class="token comment"># multi_accept on;</span><span class="token punctuation">&#125;</span><span class="token comment"># #è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ</span>http <span class="token punctuation">&#123;</span> <span class="token comment">##</span> <span class="token comment"># åŸºæœ¬è®¾ç½®</span> <span class="token comment">##</span> <span class="token comment"># sendfile æŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨ sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œ</span> <span class="token comment"># å¿…é¡»è®¾ä¸º on,å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸º offï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„uptime.</span> sendfile on<span class="token punctuation">;</span> <span class="token comment"># sendfileä¸ºonæ—¶è¿™é‡Œä¹Ÿåº”è¯¥è®¾ä¸ºonï¼Œæ•°æ®åŒ…ä¼šç´¯ç§¯ä¸€ä¸‹å†ä¸€èµ·ä¼ è¾“ï¼Œå¯ä»¥æé«˜ä¸€äº›ä¼ è¾“æ•ˆç‡ã€‚</span> tcp_nopush on<span class="token punctuation">;</span> <span class="token comment"># å°çš„æ•°æ®åŒ…ä¸ç­‰å¾…ç›´æ¥ä¼ è¾“ã€‚é»˜è®¤ä¸ºonã€‚</span> <span class="token comment"># çœ‹ä¸Šå»æ˜¯å’Œtcp_nopushç›¸åçš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸¤è¾¹éƒ½ä¸ºonæ—¶nginxä¹Ÿå¯ä»¥å¹³è¡¡è¿™ä¸¤ä¸ªåŠŸèƒ½çš„ä½¿ç”¨ã€‚</span> tcp_nodelay on<span class="token punctuation">;</span> <span class="token comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span> keepalive_timeout <span class="token number">65</span><span class="token punctuation">;</span> <span class="token comment"># types_hash_max_sizeå½±å“æ•£åˆ—è¡¨çš„å†²çªç‡ã€‚types_hash_max_sizeè¶Šå¤§ï¼Œå°±ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ï¼Œä½†æ•£åˆ—keyçš„å†²çªç‡ä¼šé™ä½ï¼Œæ£€ç´¢é€Ÿåº¦å°±æ›´å¿«ã€‚types_hash_max_sizeè¶Šå°ï¼Œæ¶ˆè€—çš„å†…å­˜å°±è¶Šå°ï¼Œä½†æ•£åˆ—keyçš„å†²çªç‡å¯èƒ½ä¸Šå‡ã€‚é»˜è®¤ä¸º1024</span> types_hash_max_size <span class="token number">2048</span><span class="token punctuation">;</span> <span class="token comment"># server_tokens off;</span> <span class="token comment"># server_names_hash_bucket_size 64;</span> <span class="token comment"># server_name_in_redirect off;</span> <span class="token comment"># å®šä¹‰MIMEç±»å‹å’Œåç¼€åå…³è”çš„æ–‡ä»¶çš„ä½ç½®ã€‚</span> include /etc/nginx/mime.types<span class="token punctuation">;</span> <span class="token comment"># æŒ‡å®šmime.typesæ–‡ä»¶ä¸­æ²¡æœ‰è®°è¿°åˆ°çš„åç¼€åçš„å¤„ç†æ–¹æ³•ã€‚é»˜è®¤å€¼æ˜¯text/plainã€‚</span> default_type application/octet-stream<span class="token punctuation">;</span> <span class="token comment">##</span> <span class="token comment"># SSLè®¾ç½®</span> <span class="token comment">##</span> ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class="token punctuation">;</span> <span class="token comment"># Dropping SSLv3, ref: POODLE</span> ssl_prefer_server_ciphers on<span class="token punctuation">;</span> <span class="token comment">##</span> <span class="token comment"># æ—¥å¿—è®°å½•è®¾ç½®</span> <span class="token comment">##</span> access_log /var/log/nginx/access.log<span class="token punctuation">;</span> error_log /var/log/nginx/error.log<span class="token punctuation">;</span> <span class="token comment">##</span> <span class="token comment"># Gzipè®¾ç½®</span> <span class="token comment">##</span> <span class="token comment">#å¼€å¯gzipå‹ç¼©</span> <span class="token function">gzip</span> on<span class="token punctuation">;</span> <span class="token comment"># gzip_vary on;</span> <span class="token comment"># gzip_proxied any;</span> <span class="token comment"># gzip_comp_level 6;</span> <span class="token comment"># gzip_buffers 16 8k;</span> <span class="token comment"># gzip_http_version 1.1;</span> <span class="token comment"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span> <span class="token comment">##</span> <span class="token comment"># è™šæ‹Ÿä¸»æœºé…ç½®</span> <span class="token comment">## </span> <span class="token comment"># é‡ç‚¹å°±åœ¨è¿™é‡Œï¼Œå› ä¸ºæˆ‘ä»¬æ­£å¸¸çœ‹è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æ„Ÿè§‰æ˜¯æ²¡æœ‰ä¸œè¥¿çš„ã€‚ä½†æ˜¯æˆ‘ä»¬è®¿é—®http://localhostæ˜¯å¯ä»¥è®¿é—®çš„åˆ°çš„ã€‚</span>  <span class="token comment"># ä¸»è¦å°±æ˜¯ä¸‹é¢è¿™ä¸¤è¡Œ  sites-enabled è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸ª default æ–‡ä»¶ã€‚å°±æ˜¯è¿™ä¸ªæ–‡ä»¶é‡Œé¢é…ç½®çš„ä¸œè¥¿ï¼Œconf.d è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ç©ºæ–‡ä»¶å¤¹ï¼Œä¸çœ‹ã€‚</span> include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span> <span class="token comment"># å¯¼å…¥é»˜è®¤è®¾ç½®</span> include /etc/nginx/sites-enabled/*<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># mailæ¨¡å—ï¼Œç”¨çš„ä¸å¤š</span><span class="token comment">#mail &#123;</span><span class="token comment"># # See sample authentication script at:</span><span class="token comment"># # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span><span class="token comment"># </span><span class="token comment"># # auth_http localhost/auth.php;</span><span class="token comment"># # pop3_capabilities "TOP" "USER";</span><span class="token comment"># # imap_capabilities "IMAP4rev1" "UIDPLUS";</span><span class="token comment"># </span><span class="token comment"># server &#123;</span><span class="token comment">#  listen     localhost:110;</span><span class="token comment">#  protocol   pop3;</span><span class="token comment">#  proxy      on;</span><span class="token comment"># &#125;</span><span class="token comment"># </span><span class="token comment"># server &#123;</span><span class="token comment">#  listen     localhost:143;</span><span class="token comment">#  protocol   imap;</span><span class="token comment">#  proxy      on;</span><span class="token comment"># &#125;</span><span class="token comment">#&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Defaultæ–‡ä»¶"><a href="#Defaultæ–‡ä»¶" class="headerlink" title="Defaultæ–‡ä»¶"></a>Defaultæ–‡ä»¶</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">##</span><span class="token comment"># ä½ åº”è¯¥çœ‹çœ‹ä¸‹é¢çš„ç½‘å€ï¼Œä»¥ä¾¿æŒæ¡ä¸€ä¸ªåšå®çš„ç†è§£</span><span class="token comment"># ä¸ºäº†å……åˆ†å‘æŒ¥Nginxçš„å¨åŠ›ï¼Œéœ€è¦ä½¿ç”¨Nginxé…ç½®æ–‡ä»¶ã€‚</span><span class="token comment"># https://www.nginx.com/resources/wiki/start/</span><span class="token comment"># https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/</span><span class="token comment"># https://wiki.debian.org/Nginx/DirectoryStructure</span><span class="token comment">#</span><span class="token comment"># åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç®¡ç†å‘˜ä¼šä»å¯ç”¨/å’Œ</span><span class="token comment"># å°†å…¶ä¿ç•™ä¸ºç½‘ç«™å†…çš„å‚è€ƒï¼Œä»¥ä¾¿ç»§ç»­ä½¿ç”¨</span><span class="token comment"># ç”±nginxåŒ…è£…å›¢é˜Ÿæ›´æ–°ã€‚</span><span class="token comment">#</span><span class="token comment"># æ­¤æ–‡ä»¶å°†è‡ªåŠ¨åŠ è½½å…¶ä»–ç”¨æˆ·æä¾›çš„é…ç½®æ–‡ä»¶</span><span class="token comment"># åº”ç”¨ç¨‹åºï¼Œå¦‚Drupalæˆ–Wordpressã€‚è¿™äº›ç”³è¯·å°†è¢«æå‡º</span><span class="token comment"># åœ¨å…·æœ‰è¯¥åŒ…åç§°çš„è·¯å¾„ä¸‹å¯ç”¨ï¼Œä¾‹å¦‚/drupal8ã€‚</span><span class="token comment">#</span><span class="token comment"># è¯·å‚é˜…/usr/share/doc/nginx doc/examples/äº†è§£æ›´å¤šè¯¦ç»†ç¤ºä¾‹ã€‚</span><span class="token comment">##</span><span class="token comment"># é»˜è®¤æœåŠ¡é…ç½®</span><span class="token comment">#</span>server <span class="token punctuation">&#123;</span> <span class="token comment"># listenæŒ‡å®šç«¯å£å·ã€‚</span> listen <span class="token number">80</span> default_server<span class="token punctuation">;</span> listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80 default_server<span class="token punctuation">;</span> <span class="token comment"># SSLé…ç½®</span> <span class="token comment">#</span> <span class="token comment"># listen 443 ssl default_server;</span> <span class="token comment"># listen [::]:443 ssl default_server;</span> <span class="token comment">#</span> <span class="token comment"># æ³¨æ„ï¼šæ‚¨åº”è¯¥ä¸ºSSLé€šä¿¡ç¦ç”¨gzipã€‚</span> <span class="token comment"># See: https://bugs.debian.org/773332</span> <span class="token comment">#</span> <span class="token comment"># é˜…è¯»ssl_å¯†ç ä»¥ç¡®ä¿å®‰å…¨é…ç½®ã€‚</span> <span class="token comment"># See: https://bugs.debian.org/765782</span> <span class="token comment">#</span> <span class="token comment"># sslè¯ä¹¦åŒ…ç”Ÿæˆçš„è‡ªç­¾åè¯ä¹¦</span> <span class="token comment"># ä¸è¦åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸­ä½¿ç”¨å®ƒä»¬ï¼</span> <span class="token comment">#</span> <span class="token comment"># include snippets/snakeoil.conf;</span> <span class="token comment"># å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½®ã€‚</span> root /var/www/html<span class="token punctuation">;</span> <span class="token comment"># æ·»åŠ é¦–é¡µã€‚å¦‚æœä½¿ç”¨phpï¼Œè¯·å°†phpæ·»åŠ åˆ°åˆ—è¡¨ä¸­</span> index index.html index.htm index.nginx-debian.html<span class="token punctuation">;</span> <span class="token comment"># æŒ‡å®šæœåŠ¡å™¨çš„åŸŸåã€‚è¿™ä¸ª_å’Œlocalhostçš„åŒºåˆ«æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥š</span> server_name _<span class="token punctuation">;</span> location / <span class="token punctuation">&#123;</span>  <span class="token comment"># é¦–å…ˆå°è¯•å°†è¯·æ±‚ä½œä¸ºæ–‡ä»¶ï¼Œç„¶å</span>  <span class="token comment"># ä½œä¸ºç›®å½•ï¼Œç„¶åè¿”å›æ˜¾ç¤º404ã€‚</span>  try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment"># å°†PHPè„šæœ¬ä¼ é€’ç»™FastCGIæœåŠ¡å™¨</span> <span class="token comment">#</span> <span class="token comment">#location ~ \.php$ &#123;</span> <span class="token comment"># include snippets/fastcgi-php.conf;</span> <span class="token comment">#</span> <span class="token comment"># # ä½¿ç”¨php fpmï¼ˆæˆ–å…¶ä»–unixå¥—æ¥å­—ï¼‰:</span> <span class="token comment"># fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;</span> <span class="token comment"># # ä½¿ç”¨php cgiï¼ˆæˆ–å…¶ä»–tcpå¥—æ¥å­—ï¼‰:</span> <span class="token comment"># fastcgi_pass 127.0.0.1:9000;</span> <span class="token comment">#&#125;</span> <span class="token comment"># deny access to .htaccess files, if Apache's document root</span> <span class="token comment"># concurs with nginx's one</span> <span class="token comment"># æ‹’ç»è®¿é—®ã€‚htaccessæ–‡ä»¶ï¼Œå¦‚æœApacheçš„æ–‡æ¡£æ ¹</span> <span class="token comment"># åŒæ„nginxçš„è§‚ç‚¹</span> <span class="token comment">#</span> <span class="token comment">#location ~ /\.ht &#123;</span> <span class="token comment"># deny all;</span> <span class="token comment">#&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># Virtual Host configuration for example.com</span><span class="token comment"># ä¾‹å¦‚ï¼Œè™šæ‹Ÿä¸»æœºé…ç½®ã€‚example.com</span><span class="token comment">#</span><span class="token comment"># æ‚¨å¯ä»¥å°†å…¶ç§»åŠ¨åˆ°â€œå¯ç”¨ç«™ç‚¹â€ä¸‹çš„å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶å°†å…¶ç¬¦å·é“¾æ¥</span><span class="token comment"># åˆ°å·²å¯ç”¨çš„ç«™ç‚¹/ä»¥å¯ç”¨å®ƒã€‚</span><span class="token comment">#</span><span class="token comment">#server &#123;</span><span class="token comment"># listen 80;</span><span class="token comment"># listen [::]:80;</span><span class="token comment">#</span><span class="token comment"># server_name example.com;</span><span class="token comment">#</span><span class="token comment"># root /var/www/example.com;</span><span class="token comment"># index index.html;</span><span class="token comment">#</span><span class="token comment"># location / &#123;</span><span class="token comment">#  try_files $uri $uri/ =404;</span><span class="token comment"># &#125;</span><span class="token comment">#&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å­¦ä¹ ä¸€é€”ï¼Œæ¬²é€Ÿåˆ™ä¸è¾¾ï¼ŒçœŸçš„å½“ä½ å®Œå…¨å¼„æ‡‚è¿™äº›é…ç½®ä¸­çš„ç¬¦å·çš„æ„æ€ä¹‹åï¼Œä½ å†çœ‹è¿™äº›é…ç½®ä½ çš„æ„Ÿè§‰æ˜¯ä¸ä¸€æ ·çš„ã€‚å½“ç„¶æˆ‘ä¹Ÿæ˜¯åœ¨ä¸€ç‚¹ä¸€ç‚¹çš„å­¦ä¹ ï¼Œæˆ‘ç”šè‡³è£…äº†ä¸ªæœ‰å›¾å½¢åŒ–çš„Ubuntuè™šæ‹Ÿæœºï¼Œä¸ºäº†ç ”ç©¶nginx,è¿™ä¸ªé»˜è®¤ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯çœ‹ä¸æ‡‚çš„ï¼Œæˆ‘ä¹Ÿçœ‹äº†å¾ˆé•¿æ—¶é—´ã€‚ğŸ˜‚ğŸ˜‚ğŸ˜‚</p><h2 id="å®‰è£…nginxæ²¡æœ‰ç”Ÿæˆå„ç±»ç›®å½•æ–‡ä»¶é—®é¢˜è§£å†³"><a href="#å®‰è£…nginxæ²¡æœ‰ç”Ÿæˆå„ç±»ç›®å½•æ–‡ä»¶é—®é¢˜è§£å†³" class="headerlink" title="å®‰è£…nginxæ²¡æœ‰ç”Ÿæˆå„ç±»ç›®å½•æ–‡ä»¶é—®é¢˜è§£å†³"></a>å®‰è£…nginxæ²¡æœ‰ç”Ÿæˆå„ç±»ç›®å½•æ–‡ä»¶é—®é¢˜è§£å†³</h2><p>ç”±äºé€”ä¸­æˆ‘éœ€è¦æ‰‹åŠ¨å®‰è£…ä¸€æ¬¡ï¼Œæˆ‘å°±æŠŠä½¿ç”¨aptå®‰è£…çš„nginxç»™å¸è½½äº†ï¼Œå¹¶ä¸”æŠŠé…ç½®æ–‡ä»¶ç»™åˆ äº†ï¼Œæˆ‘å†æ¬¡ä½¿ç”¨aptå®‰è£…æ—¶ï¼Œå‘ç°ä¸é‡æ–°ç”Ÿæˆé»˜è®¤é…ç½®äº†ã€‚è§£å†³åŠæ³•ã€‚ä¾æ¬¡æ‰§è¡Œã€‚</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> --purge remove nginx-common<span class="token function">sudo</span> <span class="token function">apt-get</span> --purge remove nginx*<span class="token function">sudo</span> <span class="token function">apt-get</span> autoremove<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å¸¸ç”¨é…ç½®çš„ä»‹ç»ä»¥åŠæ ·ä¾‹"><a href="#å¸¸ç”¨é…ç½®çš„ä»‹ç»ä»¥åŠæ ·ä¾‹" class="headerlink" title="å¸¸ç”¨é…ç½®çš„ä»‹ç»ä»¥åŠæ ·ä¾‹"></a>å¸¸ç”¨é…ç½®çš„ä»‹ç»ä»¥åŠæ ·ä¾‹</h2><h3 id="ä¾¦å¬ç«¯å£"><a href="#ä¾¦å¬ç«¯å£" class="headerlink" title="ä¾¦å¬ç«¯å£"></a>ä¾¦å¬ç«¯å£</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  <span class="token comment"># Standard HTTP Protocol  </span>listen <span class="token number">80</span><span class="token punctuation">;</span>  <span class="token comment"># Standard HTTPS Protocol  </span>listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>  <span class="token comment"># For http2  </span>listen <span class="token number">443</span> ssl http2<span class="token punctuation">;</span>  <span class="token comment"># Listen on 80 using IPv6  </span>listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span>  <span class="token comment"># Listen only on using IPv6  </span>listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80 <span class="token assign-left variable">ipv6only</span><span class="token operator">=</span>on<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è®¿é—®æ—¥å¿—"><a href="#è®¿é—®æ—¥å¿—" class="headerlink" title="è®¿é—®æ—¥å¿—"></a>è®¿é—®æ—¥å¿—</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  <span class="token comment"># Relative or full path to log file  </span>access_log /path/to/file.log<span class="token punctuation">;</span>  <span class="token comment"># Turn 'on' or 'off'    </span>access_log on<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  <span class="token comment"># Listen to yourdomain.com  </span>server_name yourdomain.com<span class="token punctuation">;</span>  <span class="token comment"># Listen to multiple domains server_name yourdomain.com www.yourdomain.com;  </span><span class="token comment"># Listen to all domains  </span>server_name *.yourdomain.com<span class="token punctuation">;</span>  <span class="token comment"># Listen to all top-level domains  </span>server_name yourdomain.*<span class="token punctuation">;</span>  <span class="token comment"># Listen to unspecified Hostnames (Listens to IP address itself)  </span>server_name <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é™æ€èµ„äº§"><a href="#é™æ€èµ„äº§" class="headerlink" title="é™æ€èµ„äº§"></a>é™æ€èµ„äº§</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span><span class="token punctuation">;</span>  server_name yourdomain.com<span class="token punctuation">;</span>  location / <span class="token punctuation">&#123;</span>  root /path/to/website<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span><span class="token punctuation">;</span>  server_name www.yourdomain.com<span class="token punctuation">;</span>  <span class="token builtin class-name">return</span> <span class="token number">301</span> http://yourdomain.com<span class="token variable">$request_uri</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  server <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span><span class="token punctuation">;</span>  server_name www.yourdomain.com<span class="token punctuation">;</span>  location /redirect-url <span class="token punctuation">&#123;</span>  <span class="token builtin class-name">return</span> <span class="token number">301</span> http://otherdomain.com<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># []è¡¨ç¤ºéœ€è¦å¡«å†™ï¼Œ</span><span class="token comment"># nginxé»˜è®¤é‡‡ç”¨è½®è®­çš„æ–¹å¼è¿›è¡Œè´Ÿè½½å‡è¡¡</span>upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    server <span class="token number">192.168</span>.1.173:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># åŠ æƒè½®è¯¢å€¼è¶Šé«˜è®¿é—®é¢‘ç‡è¶Šé«˜</span>upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    server <span class="token number">192.168</span>.1.173:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">#  hashè´Ÿè½½å‡è¡¡</span>upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    ip_hash    server <span class="token number">192.168</span>.1.173:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># hashç®—æ³•å®é™…ä¸Šåªä¼šè®¡ç®— 192.168.1è¿™æ®µåšå“ˆå¸Œ</span><span class="token comment"># ä½¿ç”¨ip_hashçš„æ³¨æ„ç‚¹ï¼šä¸èƒ½æŠŠåå°æœåŠ¡å™¨ç›´æ¥ç§»é™¤ï¼Œåªèƒ½æ ‡è®°down.</span><span class="token comment"># url hashè´Ÿè½½å‡è¡¡</span>upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    <span class="token builtin class-name">hash</span> <span class="token variable">$request_url</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.173:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># æœ€å°è¿æ¥è´Ÿè½½å‡è¡¡</span>upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    least_conn<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.173:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080<span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="keepalived"><a href="#keepalived" class="headerlink" title="keepalived"></a>keepalived</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    server <span class="token number">192.168</span>.1.173:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>    keepalive <span class="token number">32</span><span class="token punctuation">;</span> <span class="token comment">#ä¿æŒçš„è¿æ¥æ•°</span><span class="token punctuation">&#125;</span>server <span class="token punctuation">&#123;</span>    listem  <span class="token number">80</span><span class="token punctuation">;</span>    server_name www.tomcats.com<span class="token punctuation">;</span>    location / <span class="token punctuation">&#123;</span>        proxy_pass http://tomcats<span class="token punctuation">;</span>        proxy_http_version <span class="token number">1.1</span><span class="token punctuation">;</span> <span class="token comment">#è¿æ¥çš„åè®®ç‰ˆæœ¬</span>        proxy_set_header Connection <span class="token string">""</span><span class="token punctuation">;</span> æ¸…ç©ºè¿æ¥è¯·æ±‚å¤´    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="æ§åˆ¶æµè§ˆå™¨ç¼“å­˜"><a href="#æ§åˆ¶æµè§ˆå™¨ç¼“å­˜" class="headerlink" title="æ§åˆ¶æµè§ˆå™¨ç¼“å­˜"></a>æ§åˆ¶æµè§ˆå™¨ç¼“å­˜</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>    listem  <span class="token number">80</span><span class="token punctuation">;</span>    server_name www.tomcats.com<span class="token punctuation">;</span>    location / <span class="token punctuation">&#123;</span>        proxy_pass http://tomcats<span class="token punctuation">;</span>               expires 10s<span class="token punctuation">;</span>  <span class="token comment">#æµè§ˆå™¨ç¼“å­˜10ç§’é’Ÿ</span>               <span class="token comment">#expires @22h30m  #åœ¨æ™šä¸Š10ç‚¹30çš„æ—¶å€™è¿‡æœŸ</span>               <span class="token comment">#expires -1h  #ç¼“å­˜åœ¨ä¸€å°æ—¶å‰æ—¶æ•ˆ</span>               <span class="token comment">#expires epoch  #ä¸è®¾ç½®ç¼“å­˜</span>               <span class="token comment">#expires off  #ç¼“å­˜å…³é—­ï¼Œæµè§ˆå™¨è‡ªå·±æ§åˆ¶ç¼“å­˜</span>               <span class="token comment">#expires max  #æœ€å¤§è¿‡æœŸæ—¶é—´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="åå‘ä»£ç†ç¼“å­˜"><a href="#åå‘ä»£ç†ç¼“å­˜" class="headerlink" title="åå‘ä»£ç†ç¼“å­˜"></a>åå‘ä»£ç†ç¼“å­˜</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">upstream <span class="token punctuation">[</span>proxyName<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>    server <span class="token number">192.168</span>.1.173:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.174:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>    server <span class="token number">192.168</span>.1.175:8080 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">#proxy_cache_path è®¾ç½®ç¼“å­˜ä¿å­˜çš„ç›®å½•çš„ä½ç½®</span><span class="token comment">#keys_zoneè®¾ç½®å…±äº«å†…ä»¥åŠå ç”¨çš„ç©ºé—´å¤§å°</span><span class="token comment">#mas_size è®¾ç½®ç¼“å­˜æœ€å¤§ç©ºé—´</span><span class="token comment">#inactive ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œé”™è¿‡æ­¤æ—¶é—´è‡ªåŠ¨æ¸…ç†</span><span class="token comment">#use_temp_path å…³é—­é›¶æ—¶ç›®å½•</span>proxy_cache_path /usr/local/nginx/upsteam_cache <span class="token assign-left variable">keys_zone</span><span class="token operator">=</span>mycache:5m <span class="token assign-left variable">max_size</span><span class="token operator">=</span>1g <span class="token assign-left variable">inactive</span><span class="token operator">=</span>8h <span class="token assign-left variable">use_temp_path</span><span class="token operator">=</span>off<span class="token punctuation">;</span>server <span class="token punctuation">&#123;</span>    listem  <span class="token number">80</span><span class="token punctuation">;</span>    server_name www.tomcats.com<span class="token punctuation">;</span>    <span class="token comment">#å¼€å¯å¹¶ä½¿ç”¨ç¼“å­˜</span>    proxy_cache mycache<span class="token punctuation">;</span>    <span class="token comment">#é’ˆå¯¹200å’Œ304å“åº”ç çš„ç¼“å­˜è¿‡æœŸæ—¶é—´</span>    proxy_cache_valid <span class="token number">200</span> <span class="token number">304</span> 8h<span class="token punctuation">;</span>       location / <span class="token punctuation">&#123;</span>        proxy_pass http://tomcats<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span><span class="token punctuation">;</span>  server_name yourdomain.com<span class="token punctuation">;</span>  location / <span class="token punctuation">&#123;</span>  proxy_pass http://0.0.0.0:3000<span class="token punctuation">;</span>  <span class="token comment"># where 0.0.0.0:3000 is your application server (Ex: node.js) bound on 0.0.0.0 listening on port 3000  </span><span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="SSL-åè®®"><a href="#SSL-åè®®" class="headerlink" title="SSL åè®®"></a>SSL åè®®</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">&#123;</span>  listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>  server_name yourdomain.com<span class="token punctuation">;</span>  ssl on<span class="token punctuation">;</span>  ssl_certificate /path/to/cert.pem<span class="token punctuation">;</span>  ssl_certificate_key /path/to/privatekey.pem<span class="token punctuation">;</span>  ssl_stapling on<span class="token punctuation">;</span>  ssl_stapling_verify on<span class="token punctuation">;</span>  ssl_trusted_certificate /path/to/fullchain.pem<span class="token punctuation">;</span>  ssl_protocols TLSv1 TLSv1.1 TLSv1.2<span class="token punctuation">;</span>  ssl_session_timeout 1h<span class="token punctuation">;</span>  ssl_session_cache shared:SSL:50m<span class="token punctuation">;</span>  add_header Strict-Transport-Security max-age<span class="token operator">=</span><span class="token number">15768000</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment"># Permanent Redirect for HTTP to HTTPS  </span>server   <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span><span class="token punctuation">;</span>  server_name yourdomain.com<span class="token punctuation">;</span>  <span class="token builtin class-name">return</span> <span class="token number">301</span> https://<span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>å…¶å®å¯ä»¥é‡‡ç”¨å¯è§†åŒ–çš„æ–¹å¼å¯¹ Nginx è¿›è¡Œé…ç½®ï¼Œæˆ‘åœ¨ GitHub ä¸Šå‘ç°äº†ä¸€æ¬¾å¯ä»¥ä¸€é”®ç”Ÿæˆ Nginx é…ç½®çš„ç¥å™¨ï¼Œç›¸å½“ç»™åŠ›ã€‚</p><p>å…ˆæ¥çœ‹çœ‹å®ƒéƒ½æ”¯æŒä»€ä¹ˆåŠŸèƒ½çš„é…ç½®ï¼šåå‘ä»£ç†ã€HTTPSã€HTTP&#x2F;2ã€IPv6, ç¼“å­˜ã€WordPressã€CDNã€Node.js æ”¯æŒã€ Python (Django) æœåŠ¡å™¨ç­‰ç­‰ã€‚</p><p>å¦‚æœä½ æƒ³åœ¨çº¿è¿›è¡Œé…ç½®ï¼Œåªéœ€è¦æ‰“å¼€ç½‘ç«™ï¼š<a href="https://nginxconfig.io/">https://nginxconfig.io/</a>ï¼ŒæŒ‰ç…§è‡ªå·±çš„éœ€æ±‚è¿›è¡Œæ“ä½œå°±è¡Œäº†ã€‚</p><p>æ“ä½œè¿™ä¸ªçš„å‰æï¼Œä¹Ÿæ˜¯éœ€è¦ä½ æ‡‚ï¼ï¼åˆ«äººçš„ç†æ‰€å½“ç„¶æ˜¯äº†å¦‚æŒ‡æŒåšåˆ°çš„ã€‚</p>          </div><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="ç®€å•çš„éƒ¨ç½²å‰åå°åˆ†ç¦»çš„é¡¹ç›®é…ç½®"><a href="#ç®€å•çš„éƒ¨ç½²å‰åå°åˆ†ç¦»çš„é¡¹ç›®é…ç½®" class="headerlink" title="ç®€å•çš„éƒ¨ç½²å‰åå°åˆ†ç¦»çš„é¡¹ç›®é…ç½®"></a>ç®€å•çš„éƒ¨ç½²å‰åå°åˆ†ç¦»çš„é¡¹ç›®é…ç½®</h3><p>éƒ¨ç½²å‰åå°åˆ†ç¦»çš„é¡¹ç›®ï¼Œéšä¾¿æ–°å»ºä¸ªhtmlé¡¹ç›®ï¼Œé‡Œé¢å†™ä¸€ä¸ªæŒ‰é’®ç”¨æ¥å‘é€Ajaxè¯·æ±‚ã€‚å¤šè¯´ä¸¤å¥ï¼Œwebpacké¡¹ç›®åªæ˜¯â€æ–¹ä¾¿â€œäº†å¼€å‘ï¼Œæœ€ç»ˆçš„äº§ç‰©ä¾ç„¶æ˜¯Htmlï¼ŒCssï¼ŒJavaScriptã€‚æˆ‘ä»¬å…ˆæ‰‹æ’¸ä¸€ä¸ªç®€å•çš„é¡¹ç›®å‰å°é¡¹ç›®ã€‚é¡¹ç›®è¦æ±‚å°±æ˜¯æœ‰ä¸ªé¡µé¢ï¼Œæœ‰ä¸ªæŒ‰é’®ã€‚ç‚¹å‡»èƒ½å‘é€Ajaxè¯·æ±‚ï¼Œä¸”èƒ½æŠŠè¯·æ±‚çš„è¿”å›å†…å®¹å›é¦ˆç»™ç”¨æˆ·ã€‚éœ€æ±‚æœ‰äº†ï¼Œideaæ‰“å¼€ï¼Œå¼€ç ï¼ï¼ï¼</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- è¿™é‡Œå¼•å…¥çš„JSæ”¾åœ¨nginxä¸­ä¹Ÿéœ€è¦å¯¹åº”æ ¹ç›®å½•å­˜æ”¾ä¸€ä¸ª --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/jq/jquery-3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">  <span class="token selector">.app</span> <span class="token punctuation">&#123;</span>   <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>   <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token selector">.red</span><span class="token punctuation">&#123;</span>   <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token selector">.green</span><span class="token punctuation">&#123;</span>   <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>è¯·ç‚¹å‡»æŒ‰é’®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>ç‚¹å‡»å‘é€è¯·æ±‚<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">   <span class="token keyword">let</span> <span class="token function-variable function">send</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>     <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'api/get'</span><span class="token punctuation">,</span>     <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>     <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>     <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;div id="msg" class="green">è¿”å›å†…å®¹ï¼š'</span><span class="token operator">+</span>res<span class="token punctuation">.</span>msg<span class="token operator">+</span><span class="token string">'&lt;div>'</span><span class="token punctuation">)</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>     <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xhr<span class="token punctuation">,</span>status<span class="token punctuation">,</span>e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;div id="msg" class="red">è¯·æ±‚é”™è¯¯&lt;div>'</span><span class="token punctuation">)</span>     <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>   <span class="token punctuation">&#125;</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä»£ç å†™å¥½äº†ï¼Œéƒ¨ç½²ã€‚è¿™ä¸ªå¾ˆç®€å•å•Šï¼Œä½ è¦æ˜¯å›¾çœäº‹ï¼Œç›´æ¥è¦†ç›–é»˜è®¤é…ç½®æ–‡ä»¶å¤¹ä¸­çš„index.htmlå³å¯ï¼Œ</p><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1h0s2ijjcdbj31z418gtm3.jpg" alt="å‰å°éƒ¨ç½²æˆåŠŸ"></p><p>å¾ˆå¿«å•Šï¼Œå‰å°é¡¹ç›®éƒ¨ç½²å¥½äº†ã€‚</p><p>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦éƒ¨ç½²åç«¯é¡¹ç›®äº†ã€‚ideaæ‰“å¼€æ–°å»ºspringbooté¡¹ç›®ã€‚å¼€ç ï¼ï¼ï¼</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/* ç”¨æ¥è·å–ç«¯å£å·é¡¹ç›®è¿è¡Œçš„ç«¯å£å·ï¼Œåé¢æµ‹è¯•è´Ÿè½½å‡è¡¡æ—¶ç”¨åˆ° */</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigWeb</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebServerInitializedEvent</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> serverPort<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">InetAddress</span> address <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            address <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getLocalHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownHostException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string">"http://"</span><span class="token operator">+</span> address<span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>serverPort<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">WebServerInitializedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>serverPort <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getWebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ ¸å¿ƒä»£ç ï¼Œgetè¯·æ±‚è¿”å›é¡¹ç›®è¿è¡Œç«¯å£å·ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">ConfigWeb</span> configWeb<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span><span class="token string">"æœåŠ¡ç«¯å£"</span><span class="token operator">+</span>configWeb<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ ¸å¿ƒä»£ç å¦‚ä¸Šå›¾ã€‚</p><p>å¾ˆå¿«å•Šåç«¯ä¹Ÿä¸ï¼Œåç«¯å¿«ä¸èµ·æ¥ï¼Œéœ€è¦è£…Javaç¯å¢ƒã€‚ç¨ç­‰ï¼Œå¾ˆå¿«å•Šåç«¯ä¹Ÿéƒ¨ç½²å¥½äº†ã€‚åå°æœåŠ¡çš„ç«¯å£æ˜¯8081ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ï¼ŒæŠŠä¹‹å‰çš„Ajaxä¸­çš„è¯·æ±‚url<code>api/get</code>æ¢æˆ<code>http://localhost:8081/api/get</code>,è¿™æ ·å‰åå°åº”è¯¥å°±èƒ½è¿é€šäº†ã€‚äºæ˜¯æ”¹äº†ä¸€ä¸‹åˆ·æ–°é¡µé¢ï¼Œå†æ¬¡ç‚¹å‡»ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å·²æ‹¦æˆªè·¨æºè¯·æ±‚ï¼šåŒæºç­–ç•¥ç¦æ­¢è¯»å–ä½äº http://localhost:8081/api/get çš„è¿œç¨‹èµ„æºã€‚ï¼ˆåŸå› ï¼šCORS å¤´ç¼ºå°‘ <span class="token string">'Access-Control-Allow-Origin'</span>ï¼‰ã€‚çŠ¶æ€ç ï¼š200ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ç«ç‹æµè§ˆå™¨æ˜¯è¿™æ ·æç¤ºçš„ï¼Œåˆ«çš„æµè§ˆå™¨å¯èƒ½ä¼šæœ‰äº›è®¸çš„å·®åˆ«ï¼Œä½†ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬çš„å‰åå°å¹¶æ²¡æœ‰è¿é€šï¼ï¼<br>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦é…ç½®åå‘ä»£ç†äº†ï¼Œæ¥è§„é¿è·¨åŸŸçš„é”™è¯¯ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åœ¨é…ç½®æ–‡ä»¶çš„æ ¹ç›®å½•ä¸­å—ï¼Œupstream åé¢çš„å­—ç¬¦å¹¶ä¸æ˜¯æ ‡è¯†ç¬¦ï¼Œ</span><span class="token comment"># ä½ å¯ä»¥å†™åˆ«çš„å¦‚tomcat,æˆ‘è¿™é‡Œæ˜¯å†™æˆäº†nginxã€‚</span><span class="token comment"># è¿™ä¸ªå—é‡Œçš„serveræ˜¯å¯ä»¥æœ‰å¤šä¸ªçš„ã€‚è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„è´Ÿè½½å‡è¡¡ã€‚</span><span class="token comment"># ä½ é…ä¸€ä¸ªå°±ç”¨æ¥åšç®€å•çš„åå‘ä»£ç†å³å¯ã€‚é…å¤šä¸ªå°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚ é»˜è®¤ä½¿ç”¨è½®è¯¢ï¼Œ</span>upstream nginx <span class="token punctuation">&#123;</span>    server localhost:8081<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># åœ¨serverå—ä¸­åŠ ä¸€ä¸ªlocationå—ã€‚`/api/`,è¡¨ç¤ºurlä¸­æœ‰`/api/`ï¼Œ</span><span class="token comment"># æ‰§è¡Œè¿™ä¸ªé€»è¾‘ï¼Œä¸”åˆ«çš„locationä¸åœ¨å¤„ç†è¿™ä¸ªurlè¯·æ±‚</span>location /api/ <span class="token punctuation">&#123;</span>  <span class="token comment"># è¿™é‡Œå°±æ˜¯åå‘ä»£ç†ï¼Œhttp://åé¢çš„å­—ç¬¦å¯¹åº”ä¸Šé¢upstreamå—åçš„å­—ç¬¦ã€‚</span> roxy_pass http://nginx<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åˆ°è¿™é‡Œé…ç½®ç»“æŸï¼Œé¡¹ç›®å°±æ˜¯å°±å¯ä»¥æ­£å¸¸å¯åŠ¨äº†ã€‚éœ€è¦å¼„è´Ÿè½½å‡è¡¡ï¼Œä½ å°±å¤šè·‘å‡ ä¸ªæœåŠ¡ï¼Œèƒ½è¿›è¡Œè´Ÿè½½å‡è¡¡çš„é¡¹ç›®ï¼Œå¯¹é¡¹ç›®æœ‰ä¸€ç‚¹ç‚¹è¦æ±‚ï¼Œè¦æ±‚é¡¹ç›®æœ¬èº«å¿…é¡»æ˜¯æ— çŠ¶æ€çš„ï¼Œä¸ç„¶çš„è¯å¯èƒ½ä¼šå½±å“åˆ°æ­£å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚å¦‚æœä½ è¿™ä¸ªé¡¹ç›®ä¸­æ˜¯åœ¨é¡¹ç›®é‡Œä¹Ÿå°±æ˜¯å†…å­˜é‡Œä¿å­˜çš„ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œé‚£ä¹ˆä½ è´Ÿè½½å‡è¡¡æ—¶ï¼Œå°±ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºè´Ÿè½½å‡è¡¡é»˜è®¤æ˜¯è½®è¯¢ï¼Œä½ å¯ä»¥ç†è§£æˆè¿™ä¸ªèŠ‚ç‚¹ï¼Œä½ ç™»é™†è¿‡ï¼Œä½ åˆ·æ–°ä¸€ä¸ªé¡µé¢ï¼Œç„¶åå°±è®¿é—®äº†æ–°çš„èŠ‚ç‚¹ï¼Œä½†æ˜¯ä½ çš„ç™»å½•ä¿¡æ¯æ˜¯ä¿å­˜åœ¨ä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„ï¼Œè¿™ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶æ²¡æœ‰ä¿å­˜ä½ çš„ç™»å½•ä¿¡æ¯ï¼Œä½ å°±éœ€è¦é‡æ–°ç™»å½•ã€‚è¿™å°±å½±å“åŠŸèƒ½äº†ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸€èˆ¬ä½¿ç”¨Redisæ¥ä¿å­˜ä¸€äº›çŠ¶æ€ä¿¡æ¯ã€‚å°±å¯ä»¥æƒ³è·‘å‡ ä¸ªé¡¹ç›®å°±è·‘å‡ ä¸ªé¡¹ç›®äº†ã€‚çŠ¶æ€ï¼Œè¿™ä¸ªæ¦‚å¿µå¯èƒ½éš¾ä»¥ç†è§£ï¼Œä½†æ˜¯ï¼Œå®˜æ–¹æ–‡æ¡£è‹±æ–‡å°±æ˜¯è¿™ä¸ªæ„æ€ï¼Œç†è§£äº†è‡ªç„¶ä¹Ÿå°±ç†è§£äº†ã€‚åŠ æ²¹ã€‚</p><p>å…¨éƒ¨é…ç½®æ–‡ä»¶<code>nginx.conf</code></p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">user www-data<span class="token punctuation">;</span>worker_processes auto<span class="token punctuation">;</span>pid /run/nginx.pid<span class="token punctuation">;</span>include /etc/nginx/modules-enabled/*.conf<span class="token punctuation">;</span>events <span class="token punctuation">&#123;</span> worker_connections <span class="token number">768</span><span class="token punctuation">;</span> <span class="token comment"># multi_accept on;</span><span class="token punctuation">&#125;</span>http <span class="token punctuation">&#123;</span> sendfile on<span class="token punctuation">;</span> tcp_nopush on<span class="token punctuation">;</span> tcp_nodelay on<span class="token punctuation">;</span> keepalive_timeout <span class="token number">65</span><span class="token punctuation">;</span> types_hash_max_size <span class="token number">2048</span><span class="token punctuation">;</span> include /etc/nginx/mime.types<span class="token punctuation">;</span> default_type application/octet-stream<span class="token punctuation">;</span> ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class="token punctuation">;</span> <span class="token comment"># Dropping SSLv3, ref: POODLE</span> ssl_prefer_server_ciphers on<span class="token punctuation">;</span> access_log /var/log/nginx/access.log<span class="token punctuation">;</span> error_log /var/log/nginx/error.log<span class="token punctuation">;</span> <span class="token function">gzip</span> on<span class="token punctuation">;</span> include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span>   upstream nginx <span class="token punctuation">&#123;</span>    server localhost:8081<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  server <span class="token punctuation">&#123;</span>  listen <span class="token number">80</span> default_server<span class="token punctuation">;</span>  listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80 default_server<span class="token punctuation">;</span>  root /var/www/html<span class="token punctuation">;</span>  index index.html index.htm index.nginx-debian.html<span class="token punctuation">;</span>  server_name _<span class="token punctuation">;</span>  location /api/ <span class="token punctuation">&#123;</span>    proxy_pass http://nginx<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  location / <span class="token punctuation">&#123;</span>    try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é…ç½®SSL"><a href="#é…ç½®SSL" class="headerlink" title="é…ç½®SSL"></a>é…ç½®SSL</h3><h4 id="ä½¿ç”¨opensslç”Ÿæˆè¯ä¹¦"><a href="#ä½¿ç”¨opensslç”Ÿæˆè¯ä¹¦" class="headerlink" title="ä½¿ç”¨opensslç”Ÿæˆè¯ä¹¦"></a>ä½¿ç”¨opensslç”Ÿæˆè¯ä¹¦</h4><p>opensslæ˜¯ç›®å‰æœ€æµè¡Œçš„SSLå¯†ç åº“å·¥å…·ï¼Œå…¶æä¾›äº†ä¸€ä¸ªé€šç”¨ã€å¥å£®ã€åŠŸèƒ½å®Œå¤‡çš„å·¥å…·å¥—ä»¶ï¼Œç”¨ä»¥æ”¯æŒSSL&#x2F;TLSåè®®çš„å®ç°ã€‚</p><p>æ¯”å¦‚ç”Ÿæˆåˆ°ï¼š<code>/usr/local/ssl</code></p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl req -x509 -nodes -days <span class="token number">36500</span> -newkey rsa:2048 -keyout /usr/local/ssl/nginx.key -out /usr/local/ssl/nginx.crt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ç”Ÿæˆå¥½äº†ï¼Œä¸€èˆ¬æˆ‘ä»¬ç›´æ¥å¼ºåˆ¶httpsï¼Œåªéœ€è¦é…ç½®ä¸€ä¸ªé‡å®šå‘å³å¯ã€‚</p><p>å®Œæ•´çš„é…ç½®nginx.conf</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">user www-data<span class="token punctuation">;</span>worker_processes auto<span class="token punctuation">;</span>pid /run/nginx.pid<span class="token punctuation">;</span>include /etc/nginx/modules-enabled/*.conf<span class="token punctuation">;</span>events <span class="token punctuation">&#123;</span> worker_connections <span class="token number">768</span><span class="token punctuation">;</span> <span class="token comment"># multi_accept on;</span><span class="token punctuation">&#125;</span>http <span class="token punctuation">&#123;</span> sendfile on<span class="token punctuation">;</span> tcp_nopush on<span class="token punctuation">;</span> tcp_nodelay on<span class="token punctuation">;</span> keepalive_timeout <span class="token number">65</span><span class="token punctuation">;</span> types_hash_max_size <span class="token number">2048</span><span class="token punctuation">;</span> include /etc/nginx/mime.types<span class="token punctuation">;</span> default_type application/octet-stream<span class="token punctuation">;</span> ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class="token punctuation">;</span> <span class="token comment"># Dropping SSLv3, ref: POODLE</span> ssl_prefer_server_ciphers on<span class="token punctuation">;</span> access_log /var/log/nginx/access.log<span class="token punctuation">;</span> error_log /var/log/nginx/error.log<span class="token punctuation">;</span> <span class="token function">gzip</span> on<span class="token punctuation">;</span> include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span> <span class="token comment"># è¿™é‡Œæ˜¯è´Ÿè½½å‡è¡¡ã€‚è¯·æ±‚åç«¯æ—¶å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚é»˜è®¤è´Ÿè½½å‡è¡¡æ˜¯è½®è¯¢ï¼Œå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªæŒ‰é¡ºåºæ¥</span>upstream nginx <span class="token punctuation">&#123;</span>    <span class="token comment"># ç”Ÿäº§ä¸Šè¿™é‡Œä¸€èˆ¬é…ç½®åŸŸåæˆ–è€…ipåœ°å€</span>    server localhost:8081<span class="token punctuation">;</span>    server localhost:8082<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># HTTP redirect</span>server <span class="token punctuation">&#123;</span>    listen      <span class="token number">80</span><span class="token punctuation">;</span>    listen      <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span>    <span class="token comment"># ç”Ÿäº§ä¸Šè¿™é‡Œä¸€èˆ¬é…ç½®åŸŸå</span>    server_name localhost<span class="token punctuation">;</span>    <span class="token comment"># httpå¼ºåˆ¶è·³è½¬httpsï¼Œå¯ä»¥ç†è§£ä¸ºå¼ºåˆ¶https</span>    <span class="token builtin class-name">return</span>  <span class="token number">301</span> https://localhost<span class="token variable">$request_uri</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>server <span class="token punctuation">&#123;</span> listen              <span class="token number">443</span> ssl http2<span class="token punctuation">;</span> listen              <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:443 ssl http2<span class="token punctuation">;</span> server_name         localhost<span class="token punctuation">;</span> <span class="token comment"># SSL è¿™é‡Œç”Ÿäº§ä¸Šéœ€è¦æ¢æˆç”Ÿäº§ä¸Šçš„è¯ä¹¦ä½ç½®å³å¯ã€‚è‡ªå·±ç”Ÿæˆçš„è¯ä¹¦æµè§ˆå™¨å¹¶ä¸è®¤å¯ã€‚</span> ssl_certificate     /usr/local/ssl/nginx.crt<span class="token punctuation">;</span> ssl_certificate_key /usr/local/ssl/nginx.key<span class="token punctuation">;</span> root /var/www/html<span class="token punctuation">;</span> <span class="token comment"># é¦–é¡µè®¾ç½®</span> index index.html index.htm index.nginx-debian.html<span class="token punctuation">;</span> location /api/ <span class="token punctuation">&#123;</span>  <span class="token comment">#  è¯·æ±‚åç«¯æœåŠ¡ï¼Œè¿™é‡Œè®¿é—®çš„æ˜¯é…ç½®çš„è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚</span>  proxy_pass http://nginx<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> location / <span class="token punctuation">&#123;</span>  <span class="token comment"># å¦‚æœéƒ¨ç½²çš„æ˜¯Vueç­‰é¡¹ç›®ï¼Œè¿™é‡Œå¯èƒ½éœ€è¦æ”¹åŠ¨ï¼Œ</span>  <span class="token comment"># å¦‚æœé¡¹ç›®urlä¸­æœ‰#è¿™ä¸ªçš„ï¼Œé‚£å°±ä¸è¦åŠ¨ï¼Œå¦‚æœæ²¡æœ‰#çš„ï¼Œé‚£å°±éœ€è¦æ”¹åŠ¨ã€‚</span>  try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¸¸ç”¨çš„ä¸€èˆ¬æ˜¯åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ã€‚å…³äºè´Ÿè½½å‡è¡¡çš„åœ°æ–¹å¯ä»¥å¤šçœ‹çœ‹ï¼Œå¦‚æœè´Ÿè½½å‡è¡¡ä¸­ä¸€ä¸ªæœåŠ¡æŒ‚äº†çš„æƒ…å†µï¼Œä¼šæ˜¯æ€ä¹ˆä¸ªå¤„ç†æƒ…å†µï¼Œä¸åŒçš„è´Ÿè½½å‡è¡¡æ¨¡å¼ä¸‹ï¼Œåˆæœ‰ä»€ä¹ˆä¸åŒã€‚ç­‰ç­‰ï¼Œéƒ½æ˜¯éœ€è¦æ€è€ƒçš„ã€‚</p><p>æœ€ååº”è¯¥æ˜¯å…³äºNgixnçš„é«˜å¯ç”¨ï¼Œä½œä¸ºé™æ€æœåŠ¡å™¨æ—¶ï¼ŒNginxçš„æ€§èƒ½åº”è¯¥å¤Ÿç”¨ï¼Œåå‘ä»£ç†æ—¶ï¼Œæˆ‘ä»¬ä¸»è¦è€ƒè™‘çš„åº”è¯¥æ˜¯åå‘ä»£ç†ç›®æ ‡æœåŠ¡å™¨çš„ç¨³å®šã€‚æ‰€ä»¥å°±æš‚ä¸”ä¸ç ”ç©¶Ngixnçš„é«˜å¯ç”¨ï¼Œä¸€èˆ¬ä¸»å¤‡åŒæœºä¹‹ç±»çš„ï¼ŒçœŸåˆ°Nginxæ‰›ä¸ä½çš„é‚£æ—¶å€™ï¼Œé¦–å…ˆåº”è¯¥è€ƒè™‘çš„æ˜¯æ¶æ„çš„é—®é¢˜äº†ã€‚å¾—ä¸Šå¾®æœåŠ¡äº†ã€‚</p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1h0v3nbhzz0j32yo1o0u0y.jpg" alt="åŸç¥å’Œç…¦å¸Œæœ›ä¹‹é£"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŠ¨æ€æ•°æ®æºï¼Œå¤šæ•°æ®æºï¼Œè¯»å†™åˆ†ç¦»</title>
    <link href="/2022/03/11/java-11/"/>
    <url>/2022/03/11/java-11/</url>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨springbootç»™ä½ å¸¦æ¥å¤šå¤§ä¾¿åˆ©ï¼Œä½ å°±è¦æ¥å—æ–¹ä¾¿ä½¿ç”¨å¸¦æ¥çš„ç›¸åº”çš„å¤æ‚åº¦ã€‚ç›´çº¿æ­£å¸¸è·‘è°ä¸ä¼šç»™æ²¹å•Šï¼Œå¼¯é“å¿«ï¼Œæ‰æ˜¯çœŸçš„å¿«ã€‚è¯´ä¸€è¯´ï¼Œæ•°æ®æºï¼Œå°±æ˜¯ä¸ªDataSourceï¼Œå¤šæ•°æ®æºå°±æ˜¯å¤šä¸ªDataSourceï¼Œè¯»å†™åˆ†ç¦»ï¼Œå°±æ˜¯è¯»ç”¨ä¸€ä¸ªæ•°æ®æºï¼Œå†™å…¥ä¸€ä¸ªæ•°æ®æºã€‚ä¸€èˆ¬å¢åˆ æ”¹ä½¿ç”¨ä¸»åº“ï¼ŒæŸ¥ä½¿ç”¨ä»åº“ã€‚é…ç½®æ•°æ®åº“ä¸»ä»å¤åˆ¶ã€‚</p><p>åœ¨springbootä¸­å¯¹æ•°æ®æºæ€ä¹ˆæ“ä½œå˜ã€‚è¯´æ€è·¯ï¼Œspringbootä¸­çš„è‡ªåŠ¨é…ç½®ç”¨çš„å¾ˆèˆ’æœï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠspringbootè¿™ä¸ªæˆ‘ä»¬ç”¨çš„å¾ˆèˆ’æœçš„è‡ªåŠ¨é…ç½®ç»™å»æ‰ã€‚è¿™ä¸ªè‡ªåŠ¨é…ç½®ä¼šå¾€è¿è¡Œç¯å¢ƒé‡Œæ·»åŠ ä¸€ä¸ªé»˜è®¤çš„æ•°æ®æºã€‚è¿™ä¸ªè‡ªåŠ¨é…ç½®è¿™å—ä¸œè¥¿ä¸å°‘ï¼Œå„ç§èŠ±é‡Œèƒ¡å“¨çš„æ³¨è§£ï¼Œæˆ‘è§éƒ½æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œä½ è®©æˆ‘çŸ¥é“å®ƒçš„ä½œç”¨ï¼Œæ˜¯æœ‰ä¸€ç‚¹æ‰¯çš„ã€‚å®³ï¼Œæ²¡æœ‰å¼€å‘springbooot-staterçš„ç»éªŒï¼Œä¸å®œå¤šè¯´ã€‚</p><h2 id="æ‰‹åŠ¨æ³¨å…¥æ•°æ®æº"><a href="#æ‰‹åŠ¨æ³¨å…¥æ•°æ®æº" class="headerlink" title="æ‰‹åŠ¨æ³¨å…¥æ•°æ®æº"></a>æ‰‹åŠ¨æ³¨å…¥æ•°æ®æº</h2><h3 id="ä»¥å‰çš„XMLå†™æ³•"><a href="#ä»¥å‰çš„XMLå†™æ³•" class="headerlink" title="ä»¥å‰çš„XMLå†™æ³•"></a>ä»¥å‰çš„XMLå†™æ³•</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--2. é…ç½®æ•°æ®æº--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.alibaba.druid.pool.DruidDataSource<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClassName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.driver&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.url&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.username&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.password&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="JavaConfigå†™æ³•"><a href="#JavaConfigå†™æ³•" class="headerlink" title="JavaConfigå†™æ³•"></a>JavaConfigå†™æ³•</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataContext</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">HikariDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HikariDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setJdbcUrl</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>springbootç›¸å½“äºæ˜¯é›†JavaConfigäºå¤§æˆè€…ï¼Œspringbootçš„staterï¼Œå¤§å¤šæ•°å°±æ˜¯é…ç½®ä¸Šé¢çš„å†…å®¹ï¼Œä½¿ç”¨springbootçš„è§„èŒƒå°±èƒ½åœ¨å¯åŠ¨çš„æ—¶å€™åŠ è½½é…ç½®ç±»ã€‚ä¸€èˆ¬æ‰‹åŠ¨æ³¨å…¥æ•°æ®æºï¼Œéœ€è¦å…ˆæŠŠspringbootè‡ªåŠ¨åŠ è½½çš„é…ç½®ç±»ç»™æ’é™¤æ‰ï¼Œæ”¹ä¸€ä¸‹å¯åŠ¨ç±»çš„æ³¨è§£<code>@SpringBootApplication(exclude = &#123;DataSourceAutoConfiguration.class&#125;)</code> æ”¹æˆè¿™æ ·å°±å¯ä»¥ï¼Œä¸ºä»€ä¹ˆæˆ‘è¦æ‹¿å‡ºæ¥è¯´å‘¢ï¼Œå› ä¸ºåœ¨ä¸‹é¢å®ç°åŠ¨æ€æ•°æ®æºçš„æ—¶å€™ä¹Ÿæ˜¯éœ€è¦æ’é™¤è¿™ä¸ªçš„ã€‚</p><h2 id="åŠ¨æ€æ•°æ®æº"><a href="#åŠ¨æ€æ•°æ®æº" class="headerlink" title="åŠ¨æ€æ•°æ®æº"></a>åŠ¨æ€æ•°æ®æº</h2><p>æµ…èŠä¸€ä¸‹ï¼ŒåŠ¨æ€æ•°æ®æºæ˜¯å¯¹æ•°æ®æºçš„é«˜çº§æ“ä½œï¼Œæ‰€ä»¥å°±ä¸è¦æœ‰è¿™æ ·çš„ç–‘é—®ï¼ŒåŠ¨æ€æ•°æ®æºèƒ½ä¸èƒ½åšåˆ°è¯»å†™åˆ†ç¦»ï¼Œèƒ½ä¸èƒ½å¤šæ•°æ®æºè¿™æ ·çš„é—®é¢˜ã€‚è¿™ç§é—®é¢˜å°±å’ŒçŸ¥ä¹ä¸Šçš„æé—®ï¼šè¯·é—®æˆ‘æ‹¿äº†è¯ºå¥–åå¯ä¸å¯ä»¥ä¿ç ”ï¼Ÿ</p><h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dynamic-datasource-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;dynamic.verion&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- mavenå®˜ç½‘ä¸Šç”¨æœ€æ–°çš„ç‰ˆæœ¬å³å¯ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ymlé…ç½®"><a href="#ymlé…ç½®" class="headerlink" title="ymlé…ç½®"></a>ymlé…ç½®</h3><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token comment"># æ•°æ®æºé…ç½®</span>  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>    <span class="token comment"># åŠ¨æ€æ•°æ®æºé…ç½®</span>    <span class="token key atrule">dynamic</span><span class="token punctuation">:</span>      <span class="token comment"># è®¾ç½®é»˜è®¤çš„åº“,é»˜è®¤master</span>      <span class="token key atrule">primary</span><span class="token punctuation">:</span> master      <span class="token comment"># æ˜¯å¦å¯ç”¨ä¸¥æ ¼æ¨¡å¼,é»˜è®¤ä¸å¯åŠ¨. ä¸¥æ ¼æ¨¡å¼ä¸‹æœªåŒ¹é…åˆ°æ•°æ®æºç›´æ¥æŠ¥é”™, éä¸¥æ ¼æ¨¡å¼ä¸‹åˆ™ä½¿ç”¨é»˜è®¤æ•°æ®æºprimaryæ‰€è®¾ç½®çš„æ•°æ®æº</span>      <span class="token key atrule">strict</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>      <span class="token comment"># æ˜¯å¦ä½¿ç”¨p6spyè¾“å‡ºï¼Œé»˜è®¤ä¸è¾“å‡º</span>      <span class="token key atrule">p6spy</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>      <span class="token comment"># æ•°æ®æºåˆ—è¡¨</span>      <span class="token key atrule">datasource</span><span class="token punctuation">:</span>        <span class="token comment"># ä¸»åº“</span>        <span class="token key atrule">master</span><span class="token punctuation">:</span>          <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/xxxx          <span class="token key atrule">username</span><span class="token punctuation">:</span> root          <span class="token key atrule">password</span><span class="token punctuation">:</span> root        <span class="token comment"># ä»åº“1</span>        <span class="token key atrule">second1</span><span class="token punctuation">:</span>          <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/xxxx          <span class="token key atrule">username</span><span class="token punctuation">:</span> root          <span class="token key atrule">password</span><span class="token punctuation">:</span> root        <span class="token comment"># ä»åº“2</span>        <span class="token key atrule">second2</span><span class="token punctuation">:</span>          <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/xxxx          <span class="token key atrule">username</span><span class="token punctuation">:</span> root          <span class="token key atrule">password</span><span class="token punctuation">:</span> root<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ä½¿ç”¨-DSåˆ‡æ¢æ•°æ®æº"><a href="#ä½¿ç”¨-DSåˆ‡æ¢æ•°æ®æº" class="headerlink" title="ä½¿ç”¨@DSåˆ‡æ¢æ•°æ®æº"></a>ä½¿ç”¨<code>@DS</code>åˆ‡æ¢æ•°æ®æº</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameServer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@DS</span><span class="token punctuation">(</span><span class="token class-name">ConstSource</span><span class="token punctuation">.</span>SECOND2<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span><span class="token punctuation">></span></span> maps <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForList</span><span class="token punctuation">(</span><span class="token string">"select name from wlf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> maps<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// è¿™é‡Œä¸€èˆ¬å¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®æºæ–°å»ºå¸¸é‡ã€‚</span><span class="token comment">/** * æ•°æ®æºå¸¸é‡ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstSource</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> MASTER <span class="token operator">=</span> <span class="token string">"master"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SECOND1 <span class="token operator">=</span> <span class="token string">"second1"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SECOND2 <span class="token operator">=</span> <span class="token string">"second2"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>@DS</code> å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šæˆ–ç±»ä¸Šï¼ŒåŒæ—¶å­˜åœ¨å°±è¿‘åŸåˆ™ æ–¹æ³•ä¸Šæ³¨è§£ ä¼˜å…ˆäº ç±»ä¸Šæ³¨è§£ã€‚</p><table><thead><tr><th>æ³¨è§£</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>æ²¡æœ‰@DS</td><td>é»˜è®¤æ•°æ®æº</td></tr><tr><td>@DS(â€œdsNameâ€)</td><td>dsNameå¯ä»¥ä¸ºç»„åä¹Ÿå¯ä»¥ä¸ºå…·ä½“æŸä¸ªåº“çš„åç§°</td></tr></tbody></table><h3 id="ç¼–ç¨‹å¼åˆ‡æ¢æ•°æ®æº"><a href="#ç¼–ç¨‹å¼åˆ‡æ¢æ•°æ®æº" class="headerlink" title="ç¼–ç¨‹å¼åˆ‡æ¢æ•°æ®æº"></a>ç¼–ç¨‹å¼åˆ‡æ¢æ•°æ®æº</h3><p>æ¡†æ¶æä¾›äº†ç¼–ç¨‹å¼åˆ‡æ¢æ•°æ®æºã€‚ç¨åŠ å°è£…æ”¹é€ ä¸€ä¸‹ã€‚ä¸å»ºè®®æ‰‹åŠ¨ä¿®æ”¹æ•°æ®æºã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataContext</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">protected</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">protected</span> <span class="token class-name">DefaultDataSourceCreator</span> dataSourceCreator<span class="token punctuation">;</span>    <span class="token comment">/**     * æ–°å¢æ•°æ®æº     *     * @param name åç§°     * @param username è´¦æˆ·     * @param password å¯†ç      * @param url è¿æ¥     * @param driver é©±åŠ¨     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> driver<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicRoutingDataSource</span> dynamicRoutingDataSource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DynamicRoutingDataSource</span><span class="token punctuation">)</span> dataSource<span class="token punctuation">;</span>        <span class="token class-name">DataSourceProperty</span> dsp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsp<span class="token punctuation">.</span><span class="token function">setPoolName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        dsp<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>        dsp<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>        dsp<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        dsp<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> dataSourceCreator<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>dsp<span class="token punctuation">)</span><span class="token punctuation">;</span>        dynamicRoutingDataSource<span class="token punctuation">.</span><span class="token function">addDataSource</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¸å»ºè®®æ‰‹åŠ¨è°ƒç”¨     * åˆ‡æ¢æ•°æ®æºï¼Œè°ƒç”¨è¿‡åä½¿ç”¨å®Œæ¯•åè¯·åŠ¡å¿…è°ƒç”¨ä¸€æ¬¡cleanDataSource()æ–¹æ³•ã€‚     *     * @param name åç§°     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">changeDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicDataSourceContextHolder</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ¸…ç©ºæ•°æ®æº     *     * @param name åç§°     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cleanDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicDataSourceContextHolder</span><span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">/**     * æ¸…ç©ºæ‰€æœ‰æ•°æ®æº     *     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cleanDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicDataSourceContextHolder</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¿®æ”¹æ•°æ®æº     *     * @param name åç§°     * @param username è´¦æˆ·     * @param password å¯†ç      * @param url è¿æ¥     * @param driver é©±åŠ¨     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> driver<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">removeDataSource</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">createDataSource</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> url<span class="token punctuation">,</span> driver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åˆ é™¤æ•°æ®æº     *     * @param name åç§°     * */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicRoutingDataSource</span> dynamicRoutingDataSource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DynamicRoutingDataSource</span><span class="token punctuation">)</span> dataSource<span class="token punctuation">;</span>        dynamicRoutingDataSource<span class="token punctuation">.</span><span class="token function">removeDataSource</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ•°æ®æºåˆ—è¡¨     * */</span>    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DataSource</span><span class="token punctuation">></span></span> <span class="token function">getDataSources</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicRoutingDataSource</span> dynamicRoutingDataSource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DynamicRoutingDataSource</span><span class="token punctuation">)</span> dataSource<span class="token punctuation">;</span>        <span class="token keyword">return</span> dynamicRoutingDataSource<span class="token punctuation">.</span><span class="token function">getDataSources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è·å–æ•°æ®æº     *     * @param name åç§°     * */</span>    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DynamicRoutingDataSource</span> dynamicRoutingDataSource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DynamicRoutingDataSource</span><span class="token punctuation">)</span> dataSource<span class="token punctuation">;</span>        <span class="token keyword">return</span> dynamicRoutingDataSource<span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// init dataSource</span>    <span class="token annotation punctuation">@PostConstruct</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¿™é‡Œæ˜¯ä¼ªç ï¼Œæ­£å¸¸æƒ…å†µæ˜¯ä»æ•°æ®åº“ä¸­è·å–æ•°æ®åº“è¿æ¥ä¿¡æ¯</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysDataSource</span><span class="token punctuation">></span></span> sysDataSources <span class="token operator">=</span> sysDataSourceService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¾ªç¯è°ƒç”¨æ·»åŠ æ–¹æ³•å³å¯</span>        sysDataSources<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>sysDataSource <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token function">createDataSource</span><span class="token punctuation">(</span>                    sysDataSource<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    sysDataSource<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    sysDataSource<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    sysDataSource<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    sysDataSource<span class="token punctuation">.</span><span class="token function">getDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>PS: è¿™ç§ç¼–ç¨‹è¿è¡Œæ—¶æ“ä½œæ•°æ®æºå·²ç»æœ‰ç‚¹ååˆ†æ–¹ä¾¿äº†ï¼Œæ ¸å¿ƒå°±æ˜¯è¿™ä¸ªç±»<code>DefaultDataSourceCreator</code>ï¼Œå¦‚æœæƒ³æ·±å…¥äº†è§£å¯ä»¥çœ‹ä¸€çœ‹æºç ï¼Œå¯ä»¥ä»¥æ­¤ç§æ¨¡å¼æ“ä½œå¤šç§Ÿæˆ·çš„æ¨¡å¼ï¼Œæ ¹æ®ä¸åŒç”¨æˆ·è¿æ¥ä¸åŒçš„æ•°æ®æºã€‚</p><h3 id="ä½¿ç”¨MyBatisæ’ä»¶è¯»å†™åˆ†ç¦»"><a href="#ä½¿ç”¨MyBatisæ’ä»¶è¯»å†™åˆ†ç¦»" class="headerlink" title="ä½¿ç”¨MyBatisæ’ä»¶è¯»å†™åˆ†ç¦»"></a>ä½¿ç”¨MyBatisæ’ä»¶è¯»å†™åˆ†ç¦»</h3><p>æ·»åŠ é…ç½®</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CoreConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">ConfigurationCustomizer</span> <span class="token function">mybatisConfigurationCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> configuration <span class="token operator">-></span> configuration<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MasterSlaveAutoRoutingPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ”¯æŒMybatisPlusã€‚åŠMyBatis.<br>PSï¼šä¸»ä»æ•°æ®æºé…ç½®åº”ä¸º</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>    <span class="token key atrule">dynamic</span><span class="token punctuation">:</span>      <span class="token key atrule">primary</span><span class="token punctuation">:</span> master      <span class="token key atrule">datasource</span><span class="token punctuation">:</span>        <span class="token comment"># ä¸»åº“</span>        <span class="token key atrule">master</span><span class="token punctuation">:</span>        <span class="token comment"># ä»åº“1</span>        <span class="token key atrule">slave_1</span><span class="token punctuation">:</span>        <span class="token comment"># ä»åº“2</span>        slave_2<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>slave_1</code>,<code>slave_2</code>è¿™æ ·è¡¨ç¤ºè¿™ä¸¤ä¸ªæ•°æ®æºä¸ºä¸€ç»„ï¼Œæ³¨è§£åˆ‡æ¢æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢æ˜¯æ•°æ®æºååº”ä¸º<code>slave</code>,è€Œä¸æ˜¯<code>slave_1</code>,</p><h2 id="åˆ‡æ¢æ•°æ®æºå¤±è´¥"><a href="#åˆ‡æ¢æ•°æ®æºå¤±è´¥" class="headerlink" title="åˆ‡æ¢æ•°æ®æºå¤±è´¥"></a>åˆ‡æ¢æ•°æ®æºå¤±è´¥</h2><h3 id="ä½¿ç”¨äº†springçš„äº‹åŠ¡ï¼Œåˆ™åˆ‡æ¢æ•°æ®æºä¼šæœ‰å‡ ç‡ä¼šå¤±æ•ˆï¼Œæˆ–è€…ç™¾åˆ†ç™¾å¤±æ•ˆ"><a href="#ä½¿ç”¨äº†springçš„äº‹åŠ¡ï¼Œåˆ™åˆ‡æ¢æ•°æ®æºä¼šæœ‰å‡ ç‡ä¼šå¤±æ•ˆï¼Œæˆ–è€…ç™¾åˆ†ç™¾å¤±æ•ˆ" class="headerlink" title="ä½¿ç”¨äº†springçš„äº‹åŠ¡ï¼Œåˆ™åˆ‡æ¢æ•°æ®æºä¼šæœ‰å‡ ç‡ä¼šå¤±æ•ˆï¼Œæˆ–è€…ç™¾åˆ†ç™¾å¤±æ•ˆ"></a>ä½¿ç”¨äº†springçš„äº‹åŠ¡ï¼Œåˆ™åˆ‡æ¢æ•°æ®æºä¼šæœ‰å‡ ç‡ä¼šå¤±æ•ˆï¼Œæˆ–è€…ç™¾åˆ†ç™¾å¤±æ•ˆ</h3><p>å¼€å‘è€…åŸæ–‡ï¼š</p><div class="note note-info">            <p>åŸå› ï¼š springå¼€å¯äº‹åŠ¡åä¼šç»´æŠ¤ä¸€ä¸ªConnectionHolderï¼Œä¿è¯åœ¨æ•´ä¸ªäº‹åŠ¡ä¸‹ï¼Œéƒ½æ˜¯ç”¨åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚è¯·æ£€æŸ¥æ•´ä¸ªè°ƒç”¨é“¾è·¯æ¶‰åŠçš„ç±»çš„æ–¹æ³•å’Œç±»æœ¬èº«è¿˜æœ‰ç»§æ‰¿çš„æŠ½è±¡ç±»ä¸Šæ˜¯å¦æœ‰@Transactionalæ³¨è§£ã€‚</p>          </div><h3 id="æ–¹æ³•å†…éƒ¨è°ƒç”¨"><a href="#æ–¹æ³•å†…éƒ¨è°ƒç”¨" class="headerlink" title="æ–¹æ³•å†…éƒ¨è°ƒç”¨"></a>æ–¹æ³•å†…éƒ¨è°ƒç”¨</h3><p>æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ å›ç­” å¤–éƒ¨è°ƒç”¨ userservice.test1() èƒ½åœ¨æ‰§è¡Œåˆ° test2() åˆ‡æ¢åˆ°secondæ•°æ®æºå—ï¼Ÿ</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">UserService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@DS</span><span class="token punctuation">(</span><span class="token string">"first"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// do something</span>         <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@DS</span><span class="token punctuation">(</span><span class="token string">"second"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// do something</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç­”æ¡ˆï¼šï¼ï¼ï¼ä¸èƒ½ä¸èƒ½ä¸èƒ½ï¼ï¼ï¼ï¼ æ•°æ®æºæ ¸å¿ƒåŸç†æ˜¯åŸºäºaopä»£ç†å®ç°åˆ‡æ¢ï¼Œå†…éƒ¨æ–¹æ³•è°ƒç”¨ä¸ä¼šä½¿ç”¨aopã€‚</p><p>è§£å†³æ–¹æ³•:</p><p>æŠŠtest2()æ–¹æ³•æåˆ°å¦å¤–ä¸€ä¸ªservice,å•ç‹¬è°ƒç”¨ã€‚</p><h3 id="ä½¿ç”¨äº†Shiro"><a href="#ä½¿ç”¨äº†Shiro" class="headerlink" title="ä½¿ç”¨äº†Shiro"></a>ä½¿ç”¨äº†Shiro</h3><p>å»ºè®®ä¸ç”¨ï¼Œå¯ä»¥ä½¿ç”¨<code>sa-token</code>æ¥ä»£æ›¿ã€‚</p><h2 id="äº‹åŠ¡æ§åˆ¶"><a href="#äº‹åŠ¡æ§åˆ¶" class="headerlink" title="äº‹åŠ¡æ§åˆ¶"></a>äº‹åŠ¡æ§åˆ¶</h2><p>ä¸Šé¢è¯´åˆ°äº†ä½¿ç”¨springçš„äº‹åŠ¡ï¼Œä¼šå¯¼è‡´åˆ‡æ¢æ•°æ®æºå¤±è´¥ã€‚æ¡†æ¶å¼€å‘è€…ä¹Ÿäº†è§£è¿™ä¸ªæƒ…å†µï¼Œå†™äº†ä¸€ä¸ªæœ¬åœ°çš„äº‹åŠ¡å·¥å…·ç±»<code>LocalTxUtil</code>æ¥è§£å†³æ­¤é—®é¢˜</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">LocalTxUtil</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * æ‰‹åŠ¨å¼€å¯äº‹åŠ¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">getXID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"dynamic-datasource exist local tx [&#123;&#125;]"</span><span class="token punctuation">,</span> <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">getXID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> xid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>xid<span class="token punctuation">)</span><span class="token punctuation">;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"dynamic-datasource start local tx [&#123;&#125;]"</span><span class="token punctuation">,</span> xid<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ‰‹åŠ¨æäº¤äº‹åŠ¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ConnectionFactory</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"dynamic-datasource commit local tx [&#123;&#125;]"</span><span class="token punctuation">,</span> <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">getXID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ‰‹åŠ¨å›æ»šäº‹åŠ¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ConnectionFactory</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"dynamic-datasource rollback local tx [&#123;&#125;]"</span><span class="token punctuation">,</span> <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">getXID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TransactionContext</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>åœ¨å¦‚ä»Šå„ç§æŒä¹…å±‚æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šæ„ŸçŸ¥ä¸åˆ°æ•°æ®æºçš„å­˜åœ¨ï¼Œå¥½å¤„æ˜¯ï¼Œé…ç½®ç®€å•äº†ï¼Œåå¤„å°±æ˜¯å¯¹æ•°æ®æºçš„å¤„ç†æ—¶å°±æœ‰äº›éº»çƒ¦ã€‚åœ¨å¤è€çš„JDBCä¸­ï¼Œå…¶å®æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¸‡ç‰©<code>queryForList()</code>ï¼Œæ¢ä¸ªæ•°æ®æºç»§ç»­<code>queryForList()</code>ã€‚è¿™ä¸ªæ¡†æ¶ç†è®ºä¸Šæ”¯æŒä»»ä½•æŒä¹…å±‚ï¼Œå› ä¸ºäººæ ¹æœ¬æ²¡æŠŠç›®å…‰æ”¾åœ¨æŒä¹…å±‚ä¸Šï¼Œä¸“æ³¨äºæ•°æ®æºï¼Œå®ƒåªæ“ä½œæ•°æ®æºçš„ã€‚</p><p>åœ¨springboot2.6.xçš„ç‰ˆæœ¬çš„ä¸å…è®¸ä¾èµ–å¾ªç¯ï¼Œæˆ‘å±å®ä¸èƒ½ç†è§£ã€‚æˆ‘ä¸ç†è§£ï¼Œ</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1h0d0j8r2dkj32yo1o07wi.jpg" alt="cosplayåŸç¥ çŠç‘šå®«å¿ƒæµ·"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot</tag>
      
      <tag>æ•°æ®æº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PostgreSQLæ•°æ®åº“å®‰è£…</title>
    <link href="/2022/03/01/java-10/"/>
    <url>/2022/03/01/java-10/</url>
    
    <content type="html"><![CDATA[<p>postgresqlå’Œmysqlå·®ä¸å¤šï¼Œéƒ½æ˜¯å…è´¹å¼€æºçš„çš„æ•°æ®åº“è½¯ä»¶ï¼Œåœ¨å…è´¹æ•°æ®åº“ï¼Œpostgresqlç®—æ˜¯ä¸€ä¸ªåèµ·ä¹‹ç§€ã€‚å¥½åƒæ˜¯æ¯”Mysqlè¦ä¼˜å¼‚ä¸€ç‚¹ï¼Œåœ¨å„æ–¹é¢ä¸Šã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå­¦ä¹ ä¸€ä¸ªä¸œè¥¿çš„ç¬¬ä¸€æ­¥ï¼Œè‚¯å®šæ˜¯å…ˆå®‰è£…ï¼Œç„¶åå†ä½¿ç”¨ï¼Œä½¿ç”¨æˆ‘è¿˜æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿‡ï¼Œä¸è¿‡æˆ‘æ„Ÿè§‰éƒ½æ˜¯sqlæ ‡å‡†ï¼Œå¤§å·®ä¸å·®å§ã€‚</p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p><a href="https://www.baidu.com/s?ie=UTF-8&wd=PostgreSQL">ç™¾åº¦ä¸€ä¸‹</a></p><p>å®˜ç½‘ä¸Šä¸‹è½½ã€‚æˆ‘è¿™è¾¹ä¸‹è½½çš„æ˜¯14.2çš„ç‰ˆæœ¬ï¼Œå‹ç¼©åŒ…çš„å®‰è£…æ–¹å¼ï¼Œä¸‹è½½è§£å‹è¿›å…¥<code>pgsql</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªdataæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®æ–‡ä»¶ï¼Œcmdè¿›å…¥<code>pgsql</code>ç›®å½•ã€‚æ‰§è¡Œå‘½ä»¤ã€‚</p><h3 id="åˆå§‹åŒ–æ•°æ®åº“"><a href="#åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="åˆå§‹åŒ–æ•°æ®åº“"></a>åˆå§‹åŒ–æ•°æ®åº“</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">bin<span class="token punctuation">\</span>initdb -D data -U postgres -A password -E utf8 --locale<span class="token operator">=</span>C -W<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><div class="note note-info">            <p>-D  data                       æŒ‡å®šåˆå§‹åŒ–çš„æ•°æ®åº“ç›®å½•(æ­¤å¤„ä¸ºå½“å‰ç›®å½•çš„dataæ–‡ä»¶å¤¹)<br>-U  postgres                æ•°æ®åº“è¶…çº§ç”¨æˆ·åï¼ˆæ­¤å¤„ä¸ºpostgresï¼Œå¦‚æœä¸è®¾ç½®ï¼Œä¼šç”¨å½“å‰windowsç”¨æˆ·åä¸ºè´¦å·ï¼‰<br>-A  password              æ•°æ®åº“ä½¿ç”¨å¯†ç æˆæƒ<br>-E  utf8                       æ•°æ®åº“ç¼–ç æ ¼å¼<br>â€“locale&#x3D;C                  æ•°æ®åº“ç°‡ä½¿ç”¨çš„æœ¬åœ°åŒ–è¯­è¨€<br>-W                              å‘½ä»¤è¡Œæ‰§è¡Œå è¾“å…¥å¯†ç </p>          </div><p>æ‰§è¡Œå‘½ä»¤è¿‡åè¾“å…¥å¯†ç ï¼Œåº”è¯¥è¦è¾“å…¥ä¸¤éï¼Œè¾“å…¥ä¸€ä¸ªè‡ªå·±è®°å¾—ä½çš„å¯†ç ï¼Œå…¶ä»–çš„ä»å‚æ•°è¾“å…¥ <code>initdb --help</code>æŸ¥çœ‹</p><h3 id="å¯åŠ¨æ•°æ®åº“"><a href="#å¯åŠ¨æ•°æ®åº“" class="headerlink" title="å¯åŠ¨æ•°æ®åº“"></a>å¯åŠ¨æ•°æ®åº“</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">bin<span class="token punctuation">\</span>pg_ctl -D data start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ç„¶åä½¿ç”¨æ•°æ®åº“è¿æ¥è½¯ä»¶è¿æ¥æŸ¥çœ‹å³å¯ã€‚</p><h3 id="æ³¨å†Œåˆ°æœåŠ¡"><a href="#æ³¨å†Œåˆ°æœåŠ¡" class="headerlink" title="æ³¨å†Œåˆ°æœåŠ¡"></a>æ³¨å†Œåˆ°æœåŠ¡</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">bin<span class="token punctuation">\</span>pg_ctl register -N <span class="token string">"pgsql"</span> -D xxxx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æ³¨æ„ï¼š</p><div class="note note-info">            <p>-Dåé¢å¡«å†™ä½ æ–°å»ºçš„é‚£ä¸ªdataæ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</p>          </div><p>è¿è¡Œè¿‡åå³å¯ä½¿ç”¨ <code>net start pgsql</code> å‘½ä»¤æ¥å¯åŠ¨æ•°æ®åº“æœåŠ¡ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æˆå¼€æœºè‡ªå¯ã€‚åœæ­¢è¿è¡Œçš„å‘½ä»¤<code>net stop pgsql</code>ï¼Œæ‰§è¡Œnetå‘½ä»¤å¤±è´¥çš„è¯è¯·ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½æ“ä½œCMD</p><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‹ç¼©åŒ…çš„å®‰è£…æ–¹å¼ï¼Ÿä¸»è¦æ•°æ®åº“è¿™ä¸œè¥¿å¤§å¤šæ•°éƒ½æ˜¯åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ï¼Œè€Œç°åœ¨å°å…¬å¸linuxæœåŠ¡ç”¨çš„å±…å¤šï¼Œå¤šæ˜¯æ²¡æœ‰æ“ä½œç•Œé¢çš„ï¼Œä½¿ç”¨å‹ç¼©åŒ…çš„å®‰è£…æ–¹å¼ä¸»è¦ä¸æŒ‘ç³»ç»Ÿã€‚å°±æ˜¯è¿™ä¸ªåŸå› ã€‚è¯è¯´æœ‰å‡ ä¸ªåŒå­¦çŸ¥é“Linuxè§£å‹æ–‡ä»¶çš„å‘½ä»¤æ˜¯ä»€ä¹ˆã€‚å“ˆå“ˆå“ˆğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1gzwgk3spe5j32yo1o04qq.jpg" alt="å†¬å¤©é›ªé£æ™¯"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springbooté¡¹ç›®è®°å½•httpè¯·æ±‚è®°å½•</title>
    <link href="/2022/02/18/java-09/"/>
    <url>/2022/02/18/java-09/</url>
    
    <content type="html"><![CDATA[<p>ä»£ç æ¥å’¯ï¼Œçœ‹ä»£ç å¤šæ˜¯ä¸€ä»¶ç¾äº‹å‘¦ï¼Œä½ ä»–å¥¶å¥¶çš„ä¸ºä»€ä¹ˆä¸çœ‹ä»£ç ï¼Œç»™æˆ‘çœ‹ã€‚</p><p>å·¥ä½œçš„æ—¶å€™ï¼Œå°¤å…¶æ˜¯æ¥å£è”è°ƒçš„æ—¶å€™ï¼Œæ‰“å°httpè¯·æ±‚è®°å½•æ˜¯ç”©é”…å’Œè§£å†³é—®é¢˜çš„æœ€å¥½çš„æ–¹å¼ã€‚å°¤å…¶æ˜¯è¯·æ±‚ä½“é‡Œçš„å†…å®¹ã€‚å°±æ˜¯è¿™ä¸ªè·å–è¯·æ±‚ä½“çš„å†…å®¹å…¶å®è¿˜æœ‰ç‚¹é—¨é“ï¼Œæˆ‘å°±è¢«å‘è¿‡ï¼Œä½ ç›´æ¥åœ¨æ‹¦æˆªå™¨é‡Œç›´æ¥è·å–requesté‡Œé¢çš„bodyï¼Œæ‹¦æˆªå™¨é‡Œèƒ½è·å–åˆ°ï¼ŒControlleré‡Œé¢å°±è·å–ä¸åˆ°äº†ã€‚å…·ä½“åŸå› ä¸æ·±ç©¶ï¼Œå°±æ˜¯Bodyæ˜¯ç”¨æµä¼ çš„ï¼Œä½ è¯»å–äº†ä¹‹åè¿™ä¸ªæµå°±è¢«æ¶ˆè€—äº†ï¼Œç„¶ååé¢çš„ä»£ç å†ä»requesté‡Œé¢å°±è¯»å–ä¸åˆ°äº†ã€‚</p><h2 id="å¼•å…¥spring-boot-starter-actuator"><a href="#å¼•å…¥spring-boot-starter-actuator" class="headerlink" title="å¼•å…¥spring-boot-starter-actuator"></a>å¼•å…¥<code>spring-boot-starter-actuator</code></h2><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- ä¾èµ– --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¼•å…¥ä¹‹åï¼Œé…ç½®å­˜å‚¨æ–¹å¼<code>httpTraceRepository</code>ï¼Œè¿™ä¸ªå®ä¾‹å°±æ˜¯æ·»åŠ åœ¨å†…å­˜ä¸­å­˜å‚¨æœ€è¿‘100æ¬¡è¯·æ±‚è®°å½•</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigTrace</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">HttpTraceRepository</span> <span class="token function">httpTraceRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryHttpTraceRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æœ€ååœ¨application.propertiesä¸­åŠ å…¥</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">management.endpoints.web.exposure.include<span class="token operator">=</span>*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>è¿è¡Œé¡¹ç›®è®¿é—®<code>http://localhost:8080/actuator/httptrace</code></p><p>å¾—åˆ°è¿™æ ·çš„JSONæ•°æ®ï¼ˆå·²ç»æ ¼å¼åŒ–ï¼‰ï¼Œ</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"traces"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2022-02-19T05:08:05.370267100Z"</span><span class="token punctuation">,</span>      <span class="token property">"principal"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>      <span class="token property">"session"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"method"</span><span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>        <span class="token property">"uri"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/index?a=%E4%BB%8E%E5%89%8D%E4%BB%8E%E5%89%8D&amp;b=%E6%9C%89%E4%B8%AA%E4%BA%BA%E7%88%B1%E4%BD%A0%E5%BE%88%E4%B9%85"</span><span class="token punctuation">,</span>        <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"host"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"localhost:8080"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"content-type"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"application/x-www-form-urlencoded"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"connection"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"Keep-Alive"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"accept-encoding"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"gzip,deflate"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"user-agent"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span>          <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"remoteAddress"</span><span class="token operator">:</span> <span class="token null keyword">null</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token property">"response"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"status"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>        <span class="token property">"headers"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"Keep-Alive"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"timeout=60"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"Connection"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"keep-alive"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"Content-Length"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"35"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"Date"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"Sat, 19 Feb 2022 05:08:05 GMT"</span>          <span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token property">"Content-Type"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token string">"text/plain;charset=UTF-8"</span>          <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token property">"timeTaken"</span><span class="token operator">:</span> <span class="token number">120</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¼•å…¥è¿™ä¸ªä¾èµ–çš„å¥½å¤„ï¼Œå°±æ˜¯å‡ ä¹ä¸éœ€è¦å†™ä»»ä½•ä»£ç ï¼Œå¼•å…¥ï¼Œç„¶åé…ç½®ä¸€ä¸‹å³å¯æŸ¥çœ‹ï¼Œç¼ºç‚¹ä¹Ÿæœ‰å°±æ˜¯ä¸èƒ½è®°å½•postè¯·æ±‚çš„è¯·æ±‚ä½“ï¼Œä¹Ÿæ— æ³•è®°å½•è¿”å›å€¼ï¼ŒæŒä¹…åŒ–ï¼Œç›®å‰æˆ‘æ²¡æœ‰ç ”ç©¶ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰å¯ä»¥ã€‚å¯ä»¥è‡ªè¡ŒæŸ¥é˜…èµ„æ–™ç ”ç©¶ã€‚</p><h2 id="ä½¿ç”¨springmvcè‡ªå¸¦çš„ä¸€ä¸ªç±»"><a href="#ä½¿ç”¨springmvcè‡ªå¸¦çš„ä¸€ä¸ªç±»" class="headerlink" title="ä½¿ç”¨springmvcè‡ªå¸¦çš„ä¸€ä¸ªç±»"></a>ä½¿ç”¨springmvcè‡ªå¸¦çš„ä¸€ä¸ªç±»</h2><p>å¢åŠ ä¸€ä¸ªé…ç½®ç±»</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>    <span class="token class-name">CommonsRequestLoggingFilter</span> <span class="token function">loggingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">CommonsRequestLoggingFilter</span> loggingFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonsRequestLoggingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®°å½• å®¢æˆ·ç«¯ IPä¿¡æ¯</span>        loggingFilter<span class="token punctuation">.</span><span class="token function">setIncludeClientInfo</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®°å½•è¯·æ±‚å¤´</span>        loggingFilter<span class="token punctuation">.</span><span class="token function">setIncludeHeaders</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¦‚æœè®°å½•è¯·æ±‚å¤´çš„è¯ï¼Œå¯ä»¥æŒ‡å®šå“ªäº›è®°å½•ï¼Œå“ªäº›ä¸è®°å½•</span>        <span class="token comment">// loggingFilter.setHeaderPredicate();</span>        <span class="token comment">// è®°å½• è¯·æ±‚ä½“  ç‰¹åˆ«æ˜¯POSTè¯·æ±‚çš„bodyå‚æ•°</span>        loggingFilter<span class="token punctuation">.</span><span class="token function">setIncludePayload</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è¯·æ±‚ä½“çš„å¤§å°é™åˆ¶ é»˜è®¤50</span>        loggingFilter<span class="token punctuation">.</span><span class="token function">setMaxPayloadLength</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®°å½•è¯·æ±‚è·¯å¾„ä¸­çš„queryå‚æ•°</span>        loggingFilter<span class="token punctuation">.</span><span class="token function">setIncludeQueryString</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> loggingFilter<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>CommonsRequestLoggingFilter</code>å¯ä»¥ç‚¹è¿›å»çœ‹ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªspringbootæä¾›å¾—ä¸€ä¸ªç±»ã€‚å¯ä»¥è‡ªå·±è¿›è¡Œæ”¹é€ ã€‚æ¥ä¸‹æ¥å†é…ç½®ä¸€ä¸‹logbackå°±è¡Œã€‚é…ç½®å¦‚ä¸‹ã€‚çœ‹ä¸æ‡‚æˆ–è€…ä¸ç†è§£çœ‹è¿™ä¸ª<a href="https://wangijun.com/2022/01/05/java-07/">logbacké…ç½®è¯¦æƒ…</a></p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        è¾“å‡ºæ—¥å¿—åˆ°æ§åˆ¶å°    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/log.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/log%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- è¿™ä¸ªæ˜¯é‡ç‚¹ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.filter.CommonsRequestLoggingFilter<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>é…ç½®å¥½æ‰“å°çš„æ—¥å¿—åº”è¯¥æ˜¯è¿™æ ·</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-19</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">608</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-1</span><span class="token punctuation">]</span> o.s.w.f.CommonsRequestLoggingFilter.CommonsRequestLoggingFilter#beforeRequest<span class="token punctuation">[</span>CommonsRequestLoggingFilter.java<span class="token operator">:</span><span class="token number">47</span><span class="token punctuation">]</span> Before request <span class="token punctuation">[</span>GET /index?a=%E4%BB%8E%E5%<span class="token number">89</span>%8D%E4%BB%8E%E5%<span class="token number">89</span>%8D&amp;b=%E6%9C%<span class="token number">89</span>%E4%B8%AA%E4%BA%BA%E7%<span class="token number">88</span>%B1%E4%BD%A0%E5%BE%<span class="token number">88</span>%E4%B9%<span class="token number">85</span><span class="token punctuation">,</span> client=<span class="token number">127.0</span>.<span class="token number">0.1</span><span class="token punctuation">,</span> headers=<span class="token punctuation">[</span>host<span class="token operator">:</span><span class="token string">"localhost:8080"</span><span class="token punctuation">,</span> connection<span class="token operator">:</span><span class="token string">"Keep-Alive"</span><span class="token punctuation">,</span> user-agent<span class="token operator">:</span><span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span><span class="token punctuation">,</span> accept-encoding<span class="token operator">:</span><span class="token string">"gzip,deflate"</span><span class="token punctuation">,</span> Content-Type<span class="token operator">:</span><span class="token string">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-19</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">668</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-1</span><span class="token punctuation">]</span> o.s.w.f.CommonsRequestLoggingFilter.CommonsRequestLoggingFilter#afterRequest<span class="token punctuation">[</span>CommonsRequestLoggingFilter.java<span class="token operator">:</span><span class="token number">55</span><span class="token punctuation">]</span> After request <span class="token punctuation">[</span>GET /index?a=%E4%BB%8E%E5%<span class="token number">89</span>%8D%E4%BB%8E%E5%<span class="token number">89</span>%8D&amp;b=%E6%9C%<span class="token number">89</span>%E4%B8%AA%E4%BA%BA%E7%<span class="token number">88</span>%B1%E4%BD%A0%E5%BE%<span class="token number">88</span>%E4%B9%<span class="token number">85</span><span class="token punctuation">,</span> client=<span class="token number">127.0</span>.<span class="token number">0.1</span><span class="token punctuation">,</span> headers=<span class="token punctuation">[</span>host<span class="token operator">:</span><span class="token string">"localhost:8080"</span><span class="token punctuation">,</span> connection<span class="token operator">:</span><span class="token string">"Keep-Alive"</span><span class="token punctuation">,</span> user-agent<span class="token operator">:</span><span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span><span class="token punctuation">,</span> accept-encoding<span class="token operator">:</span><span class="token string">"gzip,deflate"</span><span class="token punctuation">,</span> Content-Type<span class="token operator">:</span><span class="token string">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-19</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">737</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-3</span><span class="token punctuation">]</span> o.s.w.f.CommonsRequestLoggingFilter.CommonsRequestLoggingFilter#beforeRequest<span class="token punctuation">[</span>CommonsRequestLoggingFilter.java<span class="token operator">:</span><span class="token number">47</span><span class="token punctuation">]</span> Before request <span class="token punctuation">[</span>POST /save<span class="token punctuation">,</span> client=<span class="token number">127.0</span>.<span class="token number">0.1</span><span class="token punctuation">,</span> headers=<span class="token punctuation">[</span>content-length<span class="token operator">:</span><span class="token string">"14"</span><span class="token punctuation">,</span> host<span class="token operator">:</span><span class="token string">"localhost:8080"</span><span class="token punctuation">,</span> connection<span class="token operator">:</span><span class="token string">"Keep-Alive"</span><span class="token punctuation">,</span> user-agent<span class="token operator">:</span><span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span><span class="token punctuation">,</span> accept-encoding<span class="token operator">:</span><span class="token string">"gzip,deflate"</span><span class="token punctuation">,</span> Content-Type<span class="token operator">:</span><span class="token string">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-19</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">743</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-3</span><span class="token punctuation">]</span> o.s.w.f.CommonsRequestLoggingFilter.CommonsRequestLoggingFilter#afterRequest<span class="token punctuation">[</span>CommonsRequestLoggingFilter.java<span class="token operator">:</span><span class="token number">55</span><span class="token punctuation">]</span> After request <span class="token punctuation">[</span>POST /save<span class="token punctuation">,</span> client=<span class="token number">127.0</span>.<span class="token number">0.1</span><span class="token punctuation">,</span> headers=<span class="token punctuation">[</span>content-length<span class="token operator">:</span><span class="token string">"14"</span><span class="token punctuation">,</span> host<span class="token operator">:</span><span class="token string">"localhost:8080"</span><span class="token punctuation">,</span> connection<span class="token operator">:</span><span class="token string">"Keep-Alive"</span><span class="token punctuation">,</span> user-agent<span class="token operator">:</span><span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span><span class="token punctuation">,</span> accept-encoding<span class="token operator">:</span><span class="token string">"gzip,deflate"</span><span class="token punctuation">,</span> Content-Type<span class="token operator">:</span><span class="token string">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> payload=a=%E4%BD%A0%E5%A5%BD%E4%B8%<span class="token number">96</span>%E7%<span class="token number">95</span>%8C<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>payloadä¸­å¾—ä¸œè¥¿ä¸ºè¯·æ±‚ä½“ã€‚ä¸€æ¬¡è¯·æ±‚ä¼šæ‰“å°ä¸¤æ¡æ—¥å¿—ï¼ŒBefore requestä¸ºè¿‡æ»¤å™¨å‰ï¼ŒAfter requestä¸ºè¿‡æ»¤å™¨åçš„è®°å½•ï¼Œè¿™ç§æ–¹å¼å…¶å®å·²ç»æŒºå¥½ç”¨äº†ã€‚ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸èƒ½è®°å½•è¿”å›å€¼ï¼Œä¹Ÿæœ‰æ–¹æ³•ã€‚</p><h2 id="è®°å½•è¿”å›å€¼"><a href="#è®°å½•è¿”å›å€¼" class="headerlink" title="è®°å½•è¿”å›å€¼"></a>è®°å½•è¿”å›å€¼</h2><p>ç»§æ‰¿<code>ResponseBodyAdvice</code>å’Œä½¿ç”¨<code>RestControllerAdvice</code>æ³¨è§£æ¥å®ç°ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@RestControllerAdvice</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestBodyAdvice</span> <span class="token keyword">implements</span> <span class="token class-name">ResponseBodyAdvice</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_MAX_PAYLOAD_LENGTH <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> REQUEST_MESSAGE_PREFIX <span class="token operator">=</span> <span class="token string">"Request ["</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> REQUEST_MESSAGE_SUFFIX <span class="token operator">=</span> <span class="token string">"]"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * é¡¶çº§å¼‚å¸¸     * å¼‚å¸¸çš„ä¿¡æ¯ä¹Ÿèƒ½æ•è·åˆ°     */</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">,</span>                                              <span class="token class-name">HttpServletRequest</span> rq<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> rp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"é¡¶çº§å¼‚å¸¸: &#123;&#125;"</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"ç³»ç»Ÿé”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">MethodParameter</span> returnType<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> converterType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@SneakyThrows</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">beforeBodyWrite</span><span class="token punctuation">(</span><span class="token class-name">Object</span> body<span class="token punctuation">,</span>                                  <span class="token class-name">MethodParameter</span> returnType<span class="token punctuation">,</span>                                  <span class="token class-name">MediaType</span> selectedContentType<span class="token punctuation">,</span>                                  <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> selectedConverterType<span class="token punctuation">,</span>                                  <span class="token class-name">ServerHttpRequest</span> request<span class="token punctuation">,</span>                                  <span class="token class-name">ServerHttpResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ServletServerHttpRequest</span> servletServerHttpRequest <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ServletServerHttpRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token function">createRequestMessage</span><span class="token punctuation">(</span>servletServerHttpRequest<span class="token punctuation">.</span><span class="token function">getServletRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> REQUEST_MESSAGE_PREFIX<span class="token punctuation">,</span> REQUEST_MESSAGE_SUFFIX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœbodyå·²ç»æ˜¯JOSNæ•°æ®äº†åœ¨è¿›è¡Œè½¬JSONå¤„ç†ä¼šæŠ¥é”™ã€‚</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Response Body ["</span><span class="token operator">+</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> body<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">checkPrimitive</span><span class="token punctuation">(</span><span class="token class-name">Object</span> body<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> clazz <span class="token operator">=</span> body<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> clazz<span class="token punctuation">.</span><span class="token function">isPrimitive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token operator">||</span> clazz<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token operator">||</span> <span class="token class-name">Collection</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span>                <span class="token operator">||</span> body <span class="token keyword">instanceof</span> <span class="token class-name">Number</span>                <span class="token operator">||</span> body <span class="token keyword">instanceof</span> <span class="token class-name">Boolean</span>                <span class="token operator">||</span> body <span class="token keyword">instanceof</span> <span class="token class-name">Character</span>                <span class="token operator">||</span> body <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">createRequestMessage</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> prefix<span class="token punctuation">,</span> <span class="token class-name">String</span> suffix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StringBuilder</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">;</span>        msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> queryString <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>queryString <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token char">'?'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>queryString<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> client <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getRemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", client="</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", session="</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> user <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getRemoteUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", user="</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletServerHttpRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", headers="</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token function">getMessagePayload</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>payload <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">", payload="</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> msg<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">getMessagePayload</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ContentCachingRequestWrapper</span> wrapper <span class="token operator">=</span>                <span class="token class-name">WebUtils</span><span class="token punctuation">.</span><span class="token function">getNativeRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">ContentCachingRequestWrapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>wrapper <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">getContentAsByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span>length<span class="token punctuation">,</span> DEFAULT_MAX_PAYLOAD_LENGTH<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> wrapper<span class="token punctuation">.</span><span class="token function">getCharacterEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token string">"[unknown]"</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç„¶åå†é…ç½®logback</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.springboothttptrace.RestBodyAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>é…ç½®ä¸€ä¸‹ï¼Œè¾“å‡ºçš„æ—¥å¿—ä¸º</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-21</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">880</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-3</span><span class="token punctuation">]</span> c.e.s.RestBodyAdvice.RestBodyAdvice#beforeBodyWrite<span class="token punctuation">[</span>RestBodyAdvice.java<span class="token operator">:</span><span class="token number">64</span><span class="token punctuation">]</span> Request <span class="token punctuation">[</span>POST /save<span class="token punctuation">,</span> client=<span class="token number">127.0</span>.<span class="token number">0.1</span><span class="token punctuation">,</span> headers=<span class="token punctuation">[</span>content-length<span class="token operator">:</span><span class="token string">"14"</span><span class="token punctuation">,</span> host<span class="token operator">:</span><span class="token string">"localhost:8080"</span><span class="token punctuation">,</span> connection<span class="token operator">:</span><span class="token string">"Keep-Alive"</span><span class="token punctuation">,</span> user-agent<span class="token operator">:</span><span class="token string">"Apache-HttpClient/4.5.13 (Java/11.0.12)"</span><span class="token punctuation">,</span> accept-encoding<span class="token operator">:</span><span class="token string">"gzip,deflate"</span><span class="token punctuation">,</span> Content-Type<span class="token operator">:</span><span class="token string">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> payload=a=%E4%BD%A0%E5%A5%BD%E4%B8%<span class="token number">96</span>%E7%<span class="token number">95</span>%8C<span class="token punctuation">]</span><span class="token number">2022</span><span class="token number">-02</span><span class="token number">-21</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">880</span> DEBUG <span class="token punctuation">[</span>http-nio<span class="token number">-8080</span>-exec<span class="token number">-3</span><span class="token punctuation">]</span> c.e.s.RestBodyAdvice.RestBodyAdvice#beforeBodyWrite<span class="token punctuation">[</span>RestBodyAdvice.java<span class="token operator">:</span><span class="token number">66</span><span class="token punctuation">]</span> Response Body <span class="token punctuation">[</span><span class="token string">"ä½ å¥½ä¸–ç•Œ"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>è‡³æ­¤ï¼Œhttpçš„è¯·æ±‚è®°å½•å°±å…¨éƒ¨è®°å½•åˆ°äº†ï¼Œpayloadä¸­ä¸ºè¯·æ±‚ä½“ï¼Œè¯·æ±‚ä½“å’Œè¿”å›å†…å®¹ã€‚è‡ªå·±å¯ä»¥æŒ‰éœ€ä½¿ç”¨ï¼Œå¼€å‘è¿‡ç¨‹ä¸­å»ºè®®æ‰“å°å…¨éƒ¨æ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼Œä¸Šçº¿åï¼Œå¯ä»¥ä¸æ‰“å°ã€‚å»æ‰ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œç›´æ¥åœ¨logbacké…ç½®ä¸­é…ç½®ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1gzkx54or65j32yo1o01ky.jpg" alt="ååœ¨æ ‘ä¸Šçš„ç¾å¥³å®‹ä»ä½• ç»¿è‰²è£™å­ ç¾è…¿ æŠ¤çœ¼æ£®ç³»"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot</tag>
      
      <tag>httptrace</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ç å¦‚è¯—</title>
    <link href="/2022/01/26/gossip-06/"/>
    <url>/2022/01/26/gossip-06/</url>
    
    <content type="html"><![CDATA[<p>ä»£ç å¦‚è¯—ï¼Œåªæœ‰æ‡‚ï¼Œæ‰èƒ½äº†è§£ï¼Œè¿›è€Œæ‰èƒ½æ¬£èµã€‚æ²¡äº‹çš„æ—¶å€™è¯»äº†è¯»Javaç¼–ç¨‹æ€æƒ³è¿™æœ¬ä¹¦ï¼Œæƒ³èµ·è‡ªå·±ä»¥å‰å¯¹ç¼–ç¨‹æ€æƒ³è¿™ä¸œè¥¿ä¸æ€ä¹ˆåœ¨ä¹ï¼Œç‹‚å¦„ä¸”å‚²æ…¢çš„è®¤ä¸ºåªéœ€è¦å®ç°åŠŸèƒ½å°±å¯ä»¥äº†ï¼Œä½†ä¸å¾—ä¸è¯´ï¼Œç¡®å®èƒ½å®ç°åŠŸèƒ½ï¼Œä½†å¦‚æœä½ ä¸€ç›´æ˜¯è¿™ç§å¿ƒæ€ï¼Œä½ å†™ä¸å‡ºä»€ä¹ˆå¤šå¤§çš„é¡¹ç›®ï¼Œæˆ–è€…è¯´ï¼Œæ²¡æœ‰åŠæ³•å…»æˆæ¶æ„çš„æ€æƒ³ã€‚åªèƒ½è§£å†³è§£å†³è¾¹è§’æ–™é—®é¢˜ï¼Œå½“ç„¶ï¼Œè§£å†³è¾¹è§’æ–™é—®é¢˜ï¼Œä¹Ÿæ˜¯æœ‰å·¥èµ„çš„ï¼Œä¹Ÿæ˜¯èƒ½åƒé¥­çš„ï¼Œä½†å°±æ„Ÿè§‰å·®äº†é‚£ä¹ˆä¸€ç‚¹ç‚¹ã€‚</p><p>é˜…è¯»ä»£ç æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œæ€ä¹ˆå†™å‡ºå¥½æ–‡ç« ï¼Œå¤šè¯»ä¹¦å˜›ï¼Œä»£ç ä¹Ÿæ˜¯è¿™ä¸ªé“ç†å˜›ï¼Œå¤šçœ‹ï¼Œå¤šæƒ³å˜›ï¼Œçœ‹çœ‹ä¼˜ç§€æ¡†æ¶å¦‚ä½•ä¿è¯ä»£ç è‡ªç”±çš„æƒ…å†µä¸‹å°½å¯èƒ½çš„æ–¹ä¾¿ä½¿ç”¨ï¼ŒåŒæ—¶åˆå…¼é¡¾ç€ä»£ç è§„èŒƒã€‚</p><p>é˜…è¯»æ–‡æ¡£åŒé˜…è¯»ä»£ç ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç¼–ç ä¹ æƒ¯ã€‚å¾ˆå¤šäººå°±æ˜¯ä¸çœ‹æ–‡æ¡£ï¼Œå°¤å¤§çš„ç»å…¸è¨€è®ºï¼Œå°±æ˜¯ä¸çœ‹æ–‡æ¡£ï¼Œå¾ˆå¤šåŠŸèƒ½ï¼Œæˆ–è€…å®Œæˆéœ€æ±‚çš„æ–¹å¼æ–‡æ¡£é‡Œé¢æ˜¯æœ‰ä»‹ç»çš„ï¼Œé˜…è¯»æ–‡æ¡£å’Œä»£ç å®é™…ä¸Šæ˜¯ä¸€ç§ä»£ç å‚¨å¤‡ã€‚</p><p>è¶Šæ¥è§¦åº•å±‚ï¼Œèƒ½è§£å†³çš„é—®é¢˜å°±è¶Šå¤šã€‚å¤§é“è‡³ç®€ã€‚åœ¨äº«å—springbootå¸¦æ¥çš„ä¾¿åˆ©æ—¶ï¼Œä¸€ä¸ªå¤šæ•°æ®æºçš„éœ€æ±‚å®ç°èµ·æ¥å´å˜çš„ååˆ†éº»çƒ¦äº†èµ·æ¥ï¼Œè€ŒåŸå§‹çš„JDBCï¼Œå‹æ ¹å°±ä¸éœ€è¦å¤šæ•°æ®æºè¿™ä¸ªæ¦‚å¿µï¼ŒJDBCä¸­ä¸€ä¸ªDataSourceå°±æ˜¯ä¸€ä¸ªæ•°æ®æºï¼Œæˆ‘ä¹Ÿå¹¶ä¸æ˜¯æå€¡ä½¿ç”¨åŸå§‹çš„ä¸œè¥¿ï¼Œå› ä¸ºæ•ˆç‡ç¡®å®æ¯”è¾ƒä½ï¼Œæˆ‘éœ€è¦äº†è§£è¿™ä¸ªæ¦‚å¿µï¼Œå¤šæ•°æ®æºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ›å»ºå¤šä¸ªDataSourceã€‚å†è¯´å›springï¼Œæ¦‚å¿µåœ¨æä¸€å˜´ï¼Œå®ç°äº†AOPçš„ä¸€ä¸ªè½»é‡åŒ–Beanå®¹å™¨ã€‚AOPå°±æ˜¯å„ç§æ¡†æ¶çš„çµé­‚ï¼ŒAOPä¾é çš„æ˜¯ä»€ä¹ˆï¼Ÿåå°„ã€‚å¥½äº†ï¼Œé€šè¿‡æ³¨è§£æ¥ä½¿ç”¨å¤šæ•°æ®æºçš„ä»£ç é›å½¢ä»¥åŠåœ¨è„‘æµ·é‡Œäº†ï¼Œåˆ©ç”¨AOPçš„å‰ç½®åœ¨æ–¹æ³•æ‰§è¡Œå‰ï¼Œæ›¿æ¢DataSourceï¼Œæœ¬è´¨å°±æ˜¯è¿™æ ·ï¼Œå…·ä½“å®ç°ä»ç„¶éœ€è¦è€ƒè™‘å¾ˆå¤šç»†èŠ‚ï¼Œåªæ˜¯ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä¸åšæ·±ç©¶ã€‚</p><p>åœ¨èŠæ•°æ®æºï¼Œè¿è¡Œæ—¶å¯¹æ•°æ®æºè¿›è¡Œå˜åŠ¨è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å®Œæˆã€‚åœ¨ä¸é‡å¯é¡¹ç›®çš„æƒ…å†µä¸‹ï¼Œå¢åˆ æˆ–è€…ä¿®æ”¹æ•°æ®æºã€‚æˆ‘ä¹Ÿæ˜¯å‡ºäºæ–°å¥‡ï¼Œä»¥å‰æ²¡äº†è§£è¿‡ï¼Œæ•°æ®æºè¿˜èƒ½è¿™ä¹ˆç©ï¼Œæ„Ÿè§‰å°±è´¼å¥½ç”¨äº†ä¸”å¼ºå¤§äº†ï¼Œè™½ç„¶å®é™…ä¸­å¯èƒ½ç”¨åˆ°çš„æœºä¼šä¸å¤šï¼Œä½†è¿™ä¸œè¥¿æ€ä¹ˆè¯´å‘¢ï¼Œè™½è¯´ä¹°èœç”¨ä¸ä¸Šå¾®ç§¯åˆ†ï¼Œä½†æ˜¯å§ï¼Œæˆ‘ä¼šå¾®ç§¯åˆ†ä¹°èœæ˜¯ä¸æ˜¯å¯ä»¥æ¯”åˆ«äººç¡¬æ°”ä¸€ç‚¹ï¼ŒğŸ˜‚ğŸ˜‚ğŸ˜‚</p><p>åªæ˜¯ç®€å•èŠä¸€èŠï¼Œåœ¨ä¸ºåç»­çš„åšå®¢å†™ä¸‹ä¸€ä¸ªä¼ç¬”ï¼Œå¤šæ•°æ®æºä»¥åŠåŠ¨æ€å¢åˆ æ”¹æ•°æ®æºã€‚å·¥ä½œä¸­ç”¨çš„æŠ€æœ¯éƒ½è¿‡äºåº•å±‚ï¼ˆè½åï¼‰åè€Œå¸®åŠ©äº†æˆ‘äº†è§£äº†å¾ˆå¤šä»¥å‰æ²¡æœ‰æƒ³è¿‡çš„ä¸œè¥¿ï¼Œè¯´Javaçš„ç½‘ç»œç¼–ç¨‹ï¼Œäº†è§£çš„äººä¸å¤šï¼Œå¯å¦‚æœè¯´Webç¼–ç¨‹ï¼Œå•Šï¼Œé‚£è¿™æˆ‘ä¼šï¼Œæ®Šä¸çŸ¥åŸºäºServletçš„Httpåè®®åªæ˜¯Javaç½‘ç»œç¼–ç¨‹çš„ä¸€ä¸ªå­åˆ†æ”¯ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸”è¢«å¤§å®¶éµå®ˆçš„ä¸€ä¸ªSocketé€šä¿¡åè®®ã€‚</p><p>Unixç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç†å¿µï¼Œä¸‡ç‰©çš†æ–‡ä»¶ï¼Œä½ å¯¹æ­¤æ¦‚å¿µç†è§£æœ‰å‡ åˆ†ã€‚æˆ‘æ˜¯å­¦Javaå…¥é—¨çš„ï¼Œé¢å‘å¯¹è±¡çš„Javaå¸®æˆ‘ä»¬åšäº†å¾ˆå¤šçš„äº‹ï¼Œç»å…¸çš„å°±æ˜¯æŠŠä¸‡ç‰©çš†æ–‡ä»¶ï¼Œå˜æˆäº†ä¸‡ç‰©çš†å¯¹è±¡ã€‚è¯·æƒ³ä¸€æƒ³è¿™æ˜¯ä½•ç­‰å£®ä¸¾ã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax3.sinaimg.cn/large/005NNTS5ly1gyrfsbigf3j32yo1o0kjl.jpg" alt="è¥¿åŸŸç¾å¥³"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯·æ±‚ç¬¬ä¸‰æ–¹æ¥å£çš„å„ç§å§¿åŠ¿</title>
    <link href="/2022/01/16/java-08/"/>
    <url>/2022/01/16/java-08/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å†™äº†ä¸€äº›è¯·æ±‚ç¬¬ä¸‰æ–¹æ¥å£çš„éœ€æ±‚ï¼ŒåŸºäºhttpåè®®çš„æ¥å£ï¼Œå®é™…ä¸Šå†™èµ·æ¥å¹¶ä¸éº»çƒ¦ï¼Œå› ä¸ºå°±ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼Œåœ°å€ï¼Œè¯·æ±‚æ–¹å¼ï¼Œè¯·æ±‚å†…å®¹ã€‚åœ°å€ä»–ä»¬ç»™çš„æ˜¯ä»€ä¹ˆåœ°å€å°±æ˜¯ä»€ä¹ˆåœ°å€ï¼Œæ²¡æœ‰å˜æ•°ï¼Œè¯·æ±‚æ–¹å¼æ˜¯å†™æ­»çš„ï¼Œå¤æ‚ä¸”å®¹æ˜“å‡ºé”™çš„åœ°æ–¹å°±æ˜¯è¯·æ±‚å†…å®¹ï¼Œä¸åŒçš„è¯·æ±‚æ–¹å¼åˆæœ‰ä¸åŒçš„ä¼ å‚æ–¹å¼ã€‚è¯·æ±‚å†…å®¹æ˜¯JSONæ•°æ®è¿˜æ˜¯è¡¨å•æ•°æ®ï¼Œç­‰ç­‰ï¼Œæœ‰æ—¶å› ä¸ºæä¾›æ¥å£çš„å¼€å‘è€…æè¿°ä¸å‡†ç¡®ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Œå¾ˆç®€å•çš„ä¸€ä¸ªä¸€ä¸ªè¯•ï¼ŒåŸºæœ¬ä¸Šåªéœ€è¦è¯•ä¸¤åˆ°ä¸‰ä¸‹å°±èƒ½è§£å†³é—®é¢˜ã€‚ä½ é—®äººæ˜¯è¡¨å•æ•°æ®è¿˜æ˜¯JSONæ•°æ®å¯èƒ½ä»–ä»¬è‡ªå·±ä¹Ÿè¯´ä¸æ¸…æ¥šï¼Œå› ä¸ºè¿™ä¸ªè¡¨å•æ•°æ®çš„æ•°æ®æ ¼å¼æˆ‘ä¹Ÿä¸çŸ¥é“å®˜æ–¹çš„å«æ³•æ˜¯ä»€ä¹ˆï¼Œè¡¨å•æ•°æ®ï¼Œæ˜¯æˆ‘è‡ªå·±çš„ç†è§£ï¼Œæ„ä¹‰å¯èƒ½å°±æ˜¯ä¸ºäº†åŒºåˆ†ä¸æ˜¯JSONæ•°æ®ï¼Œæœ‰è¿™ä¸ªé—®çš„æ—¶é—´ï¼Œä½ å·²ç»è¯•å‡ºæ¥äº†ã€‚å› ä¸ºå°±è¿™ä¸‰ç§æ•°æ®ï¼Œè¿˜æœ‰ä¸€ç§æ•°æ®æ˜¯ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®ï¼Œé™¤å»æ–‡ä»¶æ•°æ®å°±ä¸¤ç§æ•°æ®ã€‚getè¯·æ±‚åªèƒ½å‘é€è¡¨å•æ•°æ®ï¼Œpostèƒ½å‘é€è¡¨å•æ•°æ®ï¼Œä¹Ÿèƒ½å‘é€jsonæ•°æ®ï¼Œä¸€èˆ¬postç”¨çš„å¤šã€‚æ‰€ä»¥è®°ä½è¿™ä¸¤ç§ä¼ å‚æ–¹å¼å°±å¯ä»¥äº†ã€‚</p><p>å®é™…æ“ä½œä¸­ä½¿ç”¨äº†hutoolè¿™ä¸ªå·¥å…·ç±»ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨å¤§å®¶æ›´ä¸ºç†ŸçŸ¥ä¸€ç‚¹çš„okhttpè¿™ä¸ªhttpå·¥å…·ï¼Œèåœé’èœéƒ½èƒ½å†™ï¼Œåªä¸è¿‡æˆ‘æ„Ÿè§‰hutoolæä¾›çš„å·¥å…·ä»£ç æ¯”è¾ƒç®€æ´ä¹Ÿä¾¿äºç†è§£ã€‚</p><p>ä¾èµ–</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">implementation<span class="token punctuation">(</span><span class="token string">'cn.hutool:hutool-all:5.7.19'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>å®é™…æ“ä½œä»£ç </p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å‘èµ·getè¯·æ±‚ï¼Œå¹¶è·å–è¿”å›å†…å®¹</span><span class="token class-name">String</span> body <span class="token operator">=</span> <span class="token class-name">HttpRequest</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token comment">// è¯·æ±‚æ–¹å¼ï¼Œä»¥åŠurl</span>        <span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"å°çº¢"</span><span class="token punctuation">)</span><span class="token comment">// å‚æ•°ï¼Œé‡å¤è°ƒç”¨å³å¯</span>        <span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token string">"24"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è·å–bodyå†…å®¹</span><span class="token comment">// å‘èµ·postè¯·æ±‚å‘é€è¡¨å•æ•°æ®ï¼Œå¹¶è·å–è¿”å›æ•°æ®</span><span class="token class-name">String</span> body1 <span class="token operator">=</span> <span class="token class-name">HttpRequest</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"utl"</span><span class="token punctuation">)</span> <span class="token comment">// postè¯·æ±‚</span>        <span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"å°çº¢"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token string">"24"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å‘é€postè¯·æ±‚å¹¶å‘é€JSONæ•°æ®ï¼Œå¹¶è·å–è¿”å›ä¿¡æ¯</span><span class="token class-name">String</span> body2 <span class="token operator">=</span> <span class="token class-name">HttpRequest</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span>                <span class="token punctuation">.</span><span class="token function">createObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"å°çº¢"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¦‚æœç¡®è®¤ä¼ é€’çš„å‚æ•°æ²¡æœ‰é—®é¢˜ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•åŸºæœ¬å°±èƒ½è§£å†³é—®é¢˜ã€‚å¦‚æœè¿˜æœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œé˜…è¯»æºç ï¼Œå»ºè®®ç›´æ¥çœ‹æºç ï¼Œæ³¨é‡Šéƒ½æ˜¯ä¸­æ–‡çš„ï¼Œä½¿ç”¨èµ·æ¥åŸºæœ¬æ²¡æœ‰ä»»ä½•éšœç¢ã€‚<a href="https://www.hutool.cn/docs/#/http/Http%E8%AF%B7%E6%B1%82-HttpRequest">å®˜ç½‘æ–‡æ¡£åœ°å€</a></p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva2.sinaimg.cn/large/005NNTS5ly1gyfnlrsvuyj32yo1o0kjl.jpg" alt="æµ·ç´çƒŸ åŒäºº"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http</tag>
      
      <tag>hu-tool</tag>
      
      <tag>api</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºJavaç¨‹åºçš„æ—¥å¿—å¤„ç†</title>
    <link href="/2022/01/05/java-07/"/>
    <url>/2022/01/05/java-07/</url>
    
    <content type="html"><![CDATA[<p>æ—¥å¿—è®°å½•è¿™å—ï¼Œç®€å•çš„æ§åˆ¶å°æ‰“å°ä¹Ÿæ˜¯æ—¥å¿—ï¼Œè¾“å‡ºlogæ–‡ä»¶ä¹Ÿæ˜¯æ—¥å¿—ï¼Œè·¨æœåŠ¡å™¨è¾“å‡ºæ—¥å¿—ï¼Œä¹Ÿæ˜¯æ—¥å¿—ã€‚è¿™è¿˜æ²¡è¯´å¤æ‚çš„æ—¥å¿—ç›‘æ§ï¼Œæ—¥å¿—ç›‘æ§ï¼Œéœ€è¦å¯¹ä»£ç æ‰“å°æ—¥å¿—çš„æ ‡å‡†æœ‰è¦æ±‚ã€‚è¿™ä¸ªå°±æ¯”è¾ƒå¤æ‚äº†ï¼Œ</p><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œæ—¥å¿—æ˜¯æœ‰çº§åˆ«çš„ï¼Œlog4j,æˆ‘è®°å¾—å¥½åƒæœ‰7ä¸ªçº§åˆ«ï¼Œslf4jï¼Œæœ‰äº”ä¸ªçº§åˆ«ã€‚é¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“log4jå’Œslf4jæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œä¸ºå•¥æŠŠè¿™ä¸¤ä¸ªæ”¾åœ¨ä¸€èµ·è¯´ã€‚é¢˜å¤–è¯è¯´ä¸€ä¸‹å‘½åï¼Œè¿™ä¸ª4jåº”è¯¥ä¸å°‘äººæœ‰ç–‘é—®ï¼Œå› ä¸ºè¿™ä¸œè¥¿ä¸ç¬¦åˆJavaçš„é©¼å³°å‘½åè§„åˆ™å•Šï¼Œä¸ºå•¥è¦èµ·è¿™ä¸ªåå‘¢ï¼Œå¥½å§ï¼Œå…¶å®å°±æ˜¯For Javaçš„éŸ³è¯‘åŠ ç¼©å†™ã€‚æ®è¯´æ˜¯ä¼ ç»Ÿï¼Œæ¯”å¦‚ä»€ä¹ˆdom4jç­‰ç­‰ã€‚è¿™ä¸ªçº§åˆ«æ˜¯ç”¨æ¥æ§åˆ¶æ—¥å¿—è¾“å‡ºå†…å®¹çš„ï¼Œä½ è®¾ç½®çš„çº§åˆ«è¶Šé«˜ï¼Œæ‰“å°çš„æ—¥å¿—å°±è¶Šå°‘ï¼Œä½ é…ç½®çº§åˆ«æœ€ä½ï¼Œåˆ™æ‰“å°å…¨éƒ¨çº§åˆ«çš„æ—¥å¿—ã€‚å‡†ç¡®æ¥è¯´æ˜¯åŒ…å«å…³ç³»ï¼Œå°±åƒä¸€ä¸ªé‡‘å­—å¡”ç»“æ„ä¸€æ ·ã€‚</p><p>è¿˜æœ‰Log4jå’ŒSlf4jè¿™ä¸¤ä¸ªå¹¶ä¸è´Ÿè´£è¾“å‡ºæ—¥å¿—ï¼Œå‡†ç¡®çš„è¯´è¿™ä¸¤ä¸ªæ˜¯Javaæ—¥å¿—çš„é—¨é¢ï¼Œåˆæˆ–è€…æ˜¯æ ‡å‡†ï¼Œé—¨é¢æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå°±æ˜¯æœåŠ¡å‘˜ï¼Œä½ å»åƒé¥­ï¼Œåªéœ€è¦å’ŒæœåŠ¡å‘˜è¯´ï¼Œæˆ‘è¦ä¸€ç¢—è›‹ç‚’é¥­ã€‚è‡³äºæœåŠ¡å‘˜å»æ‰¾å“ªä¸ªå¨å¸ˆå¸®ä½ åšï¼Œä½ ä¸ç”¨ç®¡ï¼Œè¿™ä¸¤ä¸ªä¸œè¥¿ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä½ å’Œslf4jè¯´ï¼Œæˆ‘è¦æ‰“å°æ—¥å¿—ï¼Œslf4jå¾—å»æ‰¾å®ç°ç»™ä½ æ‰“å°æ—¥å¿—ï¼Œä½†æ˜¯åªæœ‰slf4jæ˜¯æ²¡æœ‰åŠæ³•ç»™ä½ æ‰“å°æ—¥å¿—çš„ã€‚è¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦å»æ‰¾ä¸€ä¸ªå¨å¸ˆï¼Œå°±æ˜¯å®ç°ã€‚logbackæ˜¯ç›´æ¥å®ç°äº†slf4jçš„ä¸€ä¸ªæ—¥å¿—å®ç°ã€‚å¥½äº†ã€‚åº”è¯¥è¯´æ˜ç™½äº†ã€‚</p><p>å®é™…ä¸Š<a href="https://logback.qos.ch/">logbackå®˜ç½‘</a>ä¸Šæ˜¯æœ‰ååˆ†è¯¦ç»†çš„ä»‹ç»ï¼Œå°¬å°±å°¬åœ¨ï¼Œæ˜¯è‹±æ–‡æ–‡æ¡£ã€‚</p><h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>æ™®é€šçš„Javaé¡¹ç›®</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">implementation <span class="token string">'ch.qos.logback:logback-classic:1.2.10'</span>implementation <span class="token string">'ch.qos.logback:logback-core:1.2.10'</span>implementation <span class="token string">'org.slf4j:slf4j-api:1.7.32'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>springbootä¸­æ— éœ€æ­¤ä¾èµ–ï¼Œé»˜è®¤çš„æ—¥å¿—å°±æ˜¯lagbackã€‚</p><h2 id="é…ç½®æ–‡ä»¶ä»‹ç»"><a href="#é…ç½®æ–‡ä»¶ä»‹ç»" class="headerlink" title="é…ç½®æ–‡ä»¶ä»‹ç»"></a>é…ç½®æ–‡ä»¶ä»‹ç»</h2><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token comment">&lt;!--    configurationèŠ‚ç‚¹æœ‰ä¸‰ä¸ªå±æ€§    scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue    scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½é»˜è®¤å•ä½æ˜¯æ¯«ç§’ï¼Œå½“scanä¸ºtrueæ—¶æ­¤å±æ€§ç”Ÿæ•ˆï¼Œé»˜è®¤æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿ    debug:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ï¼Œé»˜è®¤å€¼ä¸ºfalse --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2 seconds<span class="token punctuation">"</span></span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è®¾ç½®ä¸Šä¸‹æ–‡åç§°ï¼Œæ¯ä¸ª&lt;logger>éƒ½å…³è”åˆ°&lt;logger>ä¸Šä¸‹æ–‡ï¼Œé»˜è®¤ä¸Šä¸‹æ–‡åç§°ä¸ºdefault,ä½†å¯ä»¥ä½¿ç”¨è®¾ç½®æˆå…¶ä»–åå­—ï¼Œç”¨äºåŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºçš„è®°å½•,ä¸€æ—¦è®¾ç½®ï¼Œä¸èƒ½ä¿®æ”¹,å¯ä»¥é€šè¿‡ %contextName æ¥æ‰“å°æ—¥å¿—ä¸Šä¸‹æ–‡åç§°ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¸ç”¨è¿™ä¸ªå±æ€§ï¼Œå¯æœ‰å¯æ— ã€‚     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contextName</span><span class="token punctuation">></span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contextName</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--         ç”¨æ¥å®šä¹‰å˜é‡çš„èŠ‚ç‚¹ï¼Œå®šä¹‰å˜é‡åï¼Œå¯ä»¥ä½¿$&#123;&#125;æ¥ä½¿ç”¨å˜é‡,ä¸¤ä¸ªå±æ€§        è¿™ä¸ªå±æ€§åªæœ‰åœ¨springbootç¯å¢ƒä¸­ä½¿ç”¨æ‰å¯ä»¥ï¼Œä¸”é…ç½®æ–‡ä»¶åè¦ä¸ºlogback-spring.xmlæ‰å¯æ­£å¸¸ä½¿ç”¨ã€‚        name: å’Œä¸‹æ–‡ä¸­çš„nameä¸€æ ·        scopeï¼šä¸€èˆ¬å°±å¡«contextå°±è¡Œäº†ï¼Œå…·ä½“é…ç½®å¯æŸ¥çœ‹å®˜ç½‘        source: è¯»å–application.ymlæˆ–application.propertiesæ–‡ä»¶ä¸­çš„é…ç½®ï¼Œ     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app_name<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logging.file.name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--         ç”¨æ¥å®šä¹‰å˜é‡çš„èŠ‚ç‚¹ï¼Œå®šä¹‰å˜é‡åï¼Œå¯ä»¥ä½¿$&#123;&#125;æ¥ä½¿ç”¨å˜é‡,ä¸¤ä¸ªå±æ€§,å½“å®šä¹‰äº†å¤šä¸ª&lt;appender>çš„æ—¶å€™è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ï¼š        nameï¼šå˜é‡å        valueï¼šå˜é‡å€¼     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log.dir<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logs<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--    å®šä¹‰æ»šåŠ¨è®°å½•æ–‡ä»¶appender ä½œç”¨:æ»šåŠ¨è®°å½•æ–‡ä»¶,å…ˆå°†æ—¥å¿—è®°å½•åˆ°æŒ‡å®šæ–‡ä»¶,å½“ç¬¦åˆæŸä¸ªæ¡ä»¶æ—¶,å°†æ—¥å¿—è®°å½•åˆ°å…¶ä»–æ–‡ä»¶    RollingFileAppender class="ch.qos.logback.core.rolling.RollingFileAppender"        å‚æ•°ï¼š        &lt;append>:å¦‚æœæ˜¯trueæ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯falseæ¸…ç©ºç°å­˜æ–‡ä»¶,é»˜è®¤æ˜¯true        &lt;fileNamePattern>:è¢«å†™å…¥çš„æ–‡ä»¶åï¼Œå¯ä»¥æ˜¯ç›¸å¯¹ç›®å½•ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ç›®å½•ï¼Œå¦‚æœä¸Šçº§ç›®å½•ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œæ²¡æœ‰é»˜è®¤å€¼        &lt;rollingPolicy>:å½“å‘ç”Ÿæ»šåŠ¨æ—¶ï¼Œå†³å®šRollingFileAppenderçš„è¡Œä¸ºï¼Œæ¶‰åŠæ–‡ä»¶ç§»åŠ¨å’Œé‡å‘½å        &lt;triggeringPolicy>:å‘ŠçŸ¥RollingFileAppenderåˆé€‚æ¿€æ´»æ»šåŠ¨        &lt;prudent>:å½“ä¸ºtrueæ—¶ä¸æ”¯æŒFixedWindowRollingPolicyæ”¯æŒTimeBasedRollingPolicyï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªé™åˆ¶:1ä¸æ”¯æŒä¹Ÿä¸å…è®¸æ–‡ä»¶å‹ç¼©,2ä¸èƒ½è®¾ç½®fileå±æ€§å¿…é¡»ç•™ç©º    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- æ¯å¤©æ»šåŠ¨ä¸€æ¬¡çš„æ—¥å¿— åªä¿ç•™30å¤©å†…çš„æ—¥å¿—æ–‡ä»¶ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/info%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰File å±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™            å¦‚æœåŒæ—¶æœ‰&lt;File>å’Œ&lt;FileNamePattern>ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File>ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤©            çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸã€‚å³ï¼Œ&lt;File> çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„ã€‚        --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--             å½“ä¸ºtrueæ—¶ä¸æ”¯æŒFixedWindowRollingPolicyæ”¯æŒTimeBasedRollingPolicyï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªé™åˆ¶:1ä¸æ”¯æŒä¹Ÿä¸å…è®¸æ–‡ä»¶å‹ç¼©,2ä¸èƒ½è®¾ç½®fileå±æ€§å¿…é¡»ç•™ç©º         --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/error%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--             é…ç½®æ—¥å¿—çº§åˆ«è¿‡æ»¤å™¨ ä½œç”¨:æ ¹æ®æ—¥å¿—çº§åˆ«è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœæ—¥å¿—çº§åˆ«ç­‰äºé…ç½®çº§åˆ«è¿‡æ»¤å™¨ä¼šæ ¹æ®onMathå’ŒonMismatchæ¥æ”¶æˆ–æ‹’ç»æ—¥å¿—             å‚æ•°:             &lt;level>:è®¾ç½®è¿‡æ»¤çº§åˆ«             &lt;onMatch>:ç”¨äºé…ç½®ç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„æ“ä½œ             &lt;onMismatch>:ç”¨äºé…ç½®ä¸ç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„æ“ä½œ                                       æ­¤å¤„é…ç½®ä¸ºåªæ¥æ”¶ERRORæ—¥å¿—çº§åˆ«ä¿¡æ¯         --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- å®šä¹‰æ§åˆ¶å°appender ä½œç”¨:æŠŠæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å° class="ch.qos.logback.core.ConsoleAppender" --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--       loggerç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…çš„æ—¥å¿—æ‰“å°çº§åˆ«       &lt;loger> ä»…æœ‰ä¸€ä¸ªnameå±æ€§,ä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§               name:ç”¨æ¥æŒ‡å®šå—æ­¤logerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»               level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«,å¤§å°å†™æ— å…³:TRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFF               addtivity:æ˜¯å¦å‘ä¸Šçº§logerä¼ é€’æ‰“å°ä¿¡æ¯ã€‚é»˜è®¤æ˜¯true,ä¼šå°†ä¿¡æ¯è¾“å…¥åˆ°rooté…ç½®æŒ‡å®šçš„åœ°æ–¹,å¯ä»¥åŒ…å«å¤šä¸ªappender-refï¼Œæ ‡è¯†è¿™ä¸ªappenderä¼šæ·»åŠ åˆ°è¿™ä¸ªlogger   --></span>    <span class="token comment">&lt;!--    &lt;logger name="com.xcbeyond.springboot" level="debug"/>--></span>    <span class="token comment">&lt;!-- å°†rootçš„æ‰“å°çº§åˆ«è®¾ç½®ä¸º"error",æŒ‡å®šäº†åå­—ä¸º"console","fileAppender","errorAppender"çš„appender --></span>    <span class="token comment">&lt;!--         springProfileæ ‡ç­¾ç”¨æ¥å¤„ç†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„ä¸åŒé…ç½®        name: è¯»å–spring.profiles.activeçš„å€¼        profileå³æ ¹æ®ä¸åŒçš„ç¯å¢ƒä½¿ç”¨ä¸åŒçš„æ—¥å¿—ç­–ç•¥ï¼Œè¿™é‡Œä¸¾ä¾‹å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒï¼š     --></span>     <span class="token comment">&lt;!-- å¼€å‘ç¯å¢ƒè¾“å‡ºåˆ°æ§åˆ¶å° --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span>  <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dev<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- ç”Ÿäº§ç¯å¢ƒè¾“å‡ºåˆ°æ–‡ä»¶ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span>  <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>FILE_LOG<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>console<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åº”è¯¥æ˜¯ä»‹ç»çš„æ¯”è¾ƒè¯¦ç»†äº†ï¼Œå› ä¸ºè¿™ä¸œè¥¿å¹³æ—¶å¾ˆå°‘æœ‰äººå»ä¸“é—¨å»è®°ä¸€ä¸‹ï¼Œæˆ‘ä¹Ÿæ˜¯å¼„å¥½ä¸€å¥—ï¼Œç„¶åCVä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œ<strong>æ³¨æ„ä¸Šé¢çš„é…ç½®åªæ˜¯ç”¨æ¥æ¼”ç¤ºçš„ï¼Œå¹¶ä¸èƒ½ç›´æ¥CVä¸‹æ¥ç”¨ã€‚ä¸‹é¢æˆ‘é…ç½®å‡ ç§å¸¸ç”¨çš„é…ç½®ï¼Œå¯ä»¥ç›´æ¥CVä¸‹æ¥ç”¨çš„ã€‚</strong></p><h2 id="å…¨éƒ¨æ—¥å¿—ä¸€ä¸ªæ–‡ä»¶"><a href="#å…¨éƒ¨æ—¥å¿—ä¸€ä¸ªæ–‡ä»¶" class="headerlink" title="å…¨éƒ¨æ—¥å¿—ä¸€ä¸ªæ–‡ä»¶"></a>å…¨éƒ¨æ—¥å¿—ä¸€ä¸ªæ–‡ä»¶</h2><div class="note note-info">            <p>æ§åˆ¶å°æ‰“å°æ—¥å¿—ï¼Œå¹¶è¾“å‡ºæ—¥å¿—æ–‡ä»¶ã€‚</p>          </div><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è¾“å‡ºæ—¥å¿—åˆ°æ§åˆ¶å°    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/log.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/log%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="ä¸åŒçº§åˆ«ä¸åŒæ–‡ä»¶"><a href="#ä¸åŒçº§åˆ«ä¸åŒæ–‡ä»¶" class="headerlink" title="ä¸åŒçº§åˆ«ä¸åŒæ–‡ä»¶"></a>ä¸åŒçº§åˆ«ä¸åŒæ–‡ä»¶</h2><div class="note note-info">            <p>æ§åˆ¶å°æ‰“å°å¤ªåŸºç¡€æˆ‘å°±ä¸è¯´äº†ï¼ŒåŠ å¼ºä¸»è¦é’ˆå¯¹logæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®æˆ‘ä»¬æŒ‰æ—¥å¿—çº§åˆ«è¾“å‡ºå¯¹åº”çº§åˆ«çš„æ—¥å¿—ã€‚æ–¹ä¾¿æˆ‘ä»¬å®šä½å’ŒæŸ¥æ‰¾ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦infoå’Œerrorçº§åˆ«çš„æ—¥å¿—å³å¯ã€‚</p>          </div><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è¾“å‡ºæ—¥å¿—åˆ°æ§åˆ¶å°    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>infoAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/info.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/info%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- ä¸¤ä¸ªè¿‡æ»¤å™¨è¿‡æ»¤warnå’ŒerroråŸºæœ¬çš„æ—¥å¿— --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤ WARN--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>WARN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤ Error--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/error%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--             è¿‡æ»¤æ—¥å¿—ï¼ŒåªåŒ…å«warnä»¥åŠwarnä»¥ä¸Šçº§åˆ«çš„æ—¥å¿—ä¹Ÿå°±æ˜¯errorçš„æ—¥å¿—         --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>WARN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>infoAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æœ€ç»ˆç»“æœæ˜¯ä¼šè¾“å‡ºä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œ<code>info.log</code>å’Œ<code>error.log</code>, infoåŒ…æ‹¬infoçº§åˆ«ä»¥åŠä»¥ä¸‹çº§åˆ«çš„æ—¥å¿—ï¼Œ<code>error.log</code>åŒ…æ‹¬<code>warn</code>å’Œ<code>error</code>ä¸¤ä¸ªçº§åˆ«çš„æ—¥å¿—ã€‚</p><h2 id="ä¸åŒåŒ…ä¸åŒæ—¥å¿—æ–‡ä»¶"><a href="#ä¸åŒåŒ…ä¸åŒæ—¥å¿—æ–‡ä»¶" class="headerlink" title="ä¸åŒåŒ…ä¸åŒæ—¥å¿—æ–‡ä»¶"></a>ä¸åŒåŒ…ä¸åŒæ—¥å¿—æ–‡ä»¶</h2><p>æˆ‘ä»¬ä¸€èˆ¬çš„ç³»ç»ŸåŸºæœ¬éƒ½æœ‰å‡ å±‚æ¶æ„ï¼Œæœ‰controllerå±‚ï¼Œä»¥åŠserviceå±‚ï¼Œlogbackå¯ä»¥æ ¹æ®ä¸åŒçš„åŒ…æ¥è¾“å‡ºæ—¥å¿—ï¼Œä¹Ÿå¯ä»¥ç²¾ç¡®åˆ°å…·ä½“çš„æŸä¸€ä¸ªç±»åã€‚ä¸»è¦ä½¿ç”¨<code>logger</code>è¿™ä¸ªæ ‡ç­¾æ¥å®Œæˆã€‚<strong>è¿™ä¸ªæ²¡æœ‰åŠæ³•CVï¼Œå› ä¸ºä¸åŒçš„é¡¹ç›®åŒ…åä¸ä¸€æ ·ï¼Œæ ¹æ®è‡ªå·±çš„é¡¹ç›®éœ€è¦ä¿®æ”¹ä¸€ä¸‹</strong>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        è¾“å‡ºæ—¥å¿—åˆ°æ§åˆ¶å°    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶     --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>infoAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/info.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/info%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤ WARN--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>WARN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤ Error--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/%d&#123;yyyy-MM-dd&#125;/error%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>WARN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wlfAppender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å¦‚æœæ˜¯true,æ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯false,æ¸…ç©ºç°å­˜æ–‡ä»¶.é»˜è®¤æ˜¯true --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prudent</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prudent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>logs/wlf/wlf.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>logs/wlf/%d&#123;yyyy-MM-dd&#125;/wlf%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä½“ç§¯ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date %level [%thread] %logger&#123;10&#125;.%class&#123;0&#125;#%method[%file:%line] %n%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--         è¿™ä¸ªé…ç½®è¡¨ç¤ºæŠŠcom.wlfåŒ…ä¸‹çš„æ—¥å¿—ä»¥wlfAppenderçš„é…ç½®è¿›è¡Œæ‰“å°æ—¥å¿—        levelï¼š ä»£è¡¨æ—¥å¿—çº§åˆ«ï¼Œä¸é…ç½®é»˜è®¤ä¸ºall    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wlf<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>debug<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wlfAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>soutAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>infoAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>errorAppender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¿™ä¸ªä¸æ€ä¹ˆå¸¸ç”¨ï¼Œåªéœ€è¦çŸ¥é“å°±è¡Œäº†ï¼Œä¸€èˆ¬åªä½¿ç”¨ç¬¬äºŒä¸ªé…ç½®å°±è¡Œäº†ï¼Œç›´æ¥CVå°±è¡Œã€‚è‡³äºå’Œspringbootä¸­ä½¿ç”¨ï¼Œå¯ä»¥æ•´ï¼Œä½†æ˜¯æ²¡å•¥å¿…è¦ã€‚å…·ä½“çš„é…ç½®è¿˜æ˜¯å¤šçœ‹çœ‹ä»‹ç»ï¼Œå¤šå¤šå­¦ä¹ ã€‚æˆ–è€…ç›´æ¥CVã€‚ğŸ˜ğŸ˜</p><h2 id="å°¾"><a href="#å°¾" class="headerlink" title="å°¾"></a>å°¾</h2><p>ä¸»è¦å†…å®¹åˆ°è¿™é‡Œå°±ä»‹ç»å®Œäº†ï¼Œlogbackçš„é…ç½®ååˆ†çš„çµæ´»ï¼Œä½†æƒ³è¦çµæ´»çš„ä½¿ç”¨ï¼Œè¿˜æ˜¯éœ€è¦å¤šå¤šçš„äº†è§£ã€‚å½“ç„¶æ‰“å°æ—¥å¿—å½’æ‰“å°æ—¥å¿—ï¼Œå¦‚æœä½ å†™ä»£ç æ‰“æ—¥å¿—æ—¶ä¸æŒ‰ç…§æ ‡å‡†è¾“å‡ºï¼Œå†ç‰›é€¼çš„é…ç½®ä¹Ÿæ•‘ä¸äº†ã€‚æ‰“å°æ—¥å¿—ä¹Ÿéœ€è¦è§„èŒƒä¸€ç‚¹ã€‚å¼€å‘ä½¿ç”¨debugï¼Œéœ€è¦ç•™å­˜çš„æ—¥å¿—ä¿¡æ¯ç”¨infoï¼Œå¼‚å¸¸ä¿¡æ¯ç”¨errorã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1gy6gxzioj4j32yo1o0gv3.jpg" alt="2022æ–°å¹´å¿«ä¹"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>log</tag>
      
      <tag>logback</tag>
      
      <tag>slf4j</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®æ ¡éªŒäºŒä¸‰äº‹</title>
    <link href="/2021/12/25/java-06/"/>
    <url>/2021/12/25/java-06/</url>
    
    <content type="html"><![CDATA[<p>åšå¼€å‘çš„åº”è¯¥éƒ½å†™è¿‡ç±»ä¼¼çš„æ ¡éªŒæ–¹æ³•ï¼Œæœ€ç®€å•çš„åˆ¤æ–­nullï¼Œå¤æ‚ä¸€ç‚¹çš„å­—ç¬¦ä¸²æ­£åˆ™æ ¡éªŒã€‚å•çº¯ä»é€»è¾‘ä¸Šè¯´è¿™ç±»ä»£ç ä¸å¤æ‚ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½å‡å¦‚éœ€è¦ä¸€æ¬¡æ€§åˆ¤æ–­å¤šä¸ªï¼Œå†åŠ ä¸Šåˆ¤æ–­å¤±è´¥åçš„å¤„ç†é€»è¾‘ï¼Œè¿˜æœ‰å¯èƒ½éœ€è¦ä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œæ¯”å¦‚æ­£åˆ™æ ¡éªŒï¼Œç­‰ç­‰ï¼Œä¸‰ä¸ªä¸€ä¸‹ï¼Œå†™å†™ä¹Ÿè¿˜è¡Œï¼Œäº”ä¸ªä»¥ä¸Šï¼Œå¦‚æœä»£ç æŒ‰è¡Œæ”¶è´¹çš„è¯ï¼Œé‚£èƒ½å¤Ÿç‹ ç‹ çš„èµšäº†ä¸€ç¬”ã€‚</p><p>å¤§å®¶è„‘æµ·é‡Œçš„ä»£ç å¯èƒ½æ˜¯è¿™æ ·</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"by_id"</span><span class="token punctuation">)</span>    <span class="token class-name">Object</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//Â·Â·Â·Â·Â·</span>            <span class="token keyword">return</span> <span class="token string">"msg: idä¸ºnull"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// Â·Â·Â·Â·</span>            <span class="token keyword">return</span> <span class="token string">"id,é•¿åº¦è¿‡é•¿"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¿™åªæ˜¯ä¸€ä¸ªï¼Œå®é™…å¼€å‘ä¸­æœ‰äº›å½•å…¥éå¸¸å¤æ‚çš„è¡¨å•æ•°æ®æ—¶å¯èƒ½æœ‰ä¸‰å››åä¸ªï¼Œä¸Šé¢æˆ‘å†™çš„å¤„ç†é€»è¾‘ä¹Ÿä¸å¤æ‚ï¼ŒçœŸå®ä¸­å¯èƒ½æœ‰äº›éœ€è¦ä½¿ç”¨å¼‚å¸¸æç¤ºï¼Œæœ‰äº›éœ€è¦ç›´æ¥returnè¿”å›ä¿¡æ¯ï¼Œç­‰ç­‰ï¼Œå¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚éš¾ä»¥ç»´æŠ¤ï¼Œåˆ°å¹¶ä¸æ˜¯ä¸èƒ½ç»´æŠ¤ï¼Œé’±ç»™çš„å¤Ÿå¤šï¼Œç»´æŠ¤ï¼Œä¹Ÿè¿˜æ˜¯èƒ½ç»´æŠ¤çš„ï¼Œå½“ç„¶è¿™ä¸ªæ ä¸èƒ½è¿™æ ·æŠ¬ã€‚ğŸ¤£ğŸ˜‚ğŸ˜‚ğŸ˜‚</p><p>ä»‹ç»ä¸€ä¸ªå·¥å…·ï¼Œåº”è¯¥è¯´æ˜¯ä¸€å¥—å·¥å…·ï¼ŒåŸºäºæ³¨è§£å’Œåå°„ã€‚</p><p>çœ‹åˆ°è¿™ä¸¤ä¸ªè¯ï¼Œæ€§èƒ½æœ‰æ‰€æŸè€—æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å¼€å‘å…¨å‘˜Mapï¼Œå…¶å®ä»£ç çš„è¿è¡Œé€Ÿåº¦æ¥è¯´ï¼Œä¸æ…¢ï¼Œä½†æ˜¯æ€»æ‰€å‘¨çŸ¥HASH(å“ˆå¸Œ)è¡¨æ˜¯ä¸€ç§éå¸¸è€—å†…å­˜çš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ä»£ç åœ¨æœ¬åœ°è·‘çš„æ—¶å€™æ—¶ä¸æ—¶çš„ommå¼‚å¸¸ä¸€ä¸‹ä¹Ÿæ˜¯åˆç¬¦æƒ…ç†çš„ä¸€ä»¶äº‹ã€‚ğŸ˜ğŸ˜ï¼Œç°åœ¨è¿™ç¡¬ä»¶å‘å±•çš„ç¯å¢ƒï¼Œåº”è¯¥ä¸ç¼ºå†…å­˜è¿™ä¸œè¥¿ã€‚</p><h3 id="validationæ˜¯ä»€ä¹ˆ"><a href="#validationæ˜¯ä»€ä¹ˆ" class="headerlink" title="validationæ˜¯ä»€ä¹ˆ"></a>validationæ˜¯ä»€ä¹ˆ</h3><p>æ¡†æ¶åå­—å«javax.validationï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„æ³¨è§£æ¥è¿›è¡Œå¯¹JavaBeançš„å‚æ•°æ ¡éªŒã€‚é€šå¸¸ç”¨æ¥å¤„ç†Controlleré‡Œé¢æ–¹æ³•çš„å‚æ•°çš„æ ¡éªŒã€‚å°±æ˜¯æš´éœ²å‡ºå»çš„APIï¼Œå†…éƒ¨çš„æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨ï¼Œä½†æ²¡å¿…è¦ï¼Œæš´éœ²å‡ºå»çš„æ¥å£è·å–çš„æ•°æ®æ˜¯ä¸å¯æ§çš„ï¼Œæ‰€ä»¥æ‰éœ€è¦æ ¡éªŒï¼Œå†…éƒ¨çš„æ•°æ®æ˜¯å¯æ§çš„ï¼Œå½“ç„¶å†…éƒ¨æ–¹æ³•å¯æ§çš„å‰ææ˜¯æºå¤´çš„æ•°æ®æ˜¯å¯æ§çš„ã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>springbootä¸­æœ‰äº›åšå®¢ä¸­å†™çš„æ˜¯è¿™ä¸ªä¾èµ–é»˜è®¤åŒ…å«åœ¨starter-webä¸­äº†ï¼Œä¸æ¸…æ¥šä»å“ªä¸ªç‰ˆæœ¬å¼€å§‹å°±ä¸åŒ…å«åœ¨å…¶ä¸­äº†ï¼Œå°±è¯´ç°åœ¨çš„ç¯å¢ƒæ˜¯springboot2.5.xç³»åˆ—çš„ï¼Œvalidationé»˜è®¤å·²ç»ä¸åŒ…å«åœ¨starter-webä¸­äº†ï¼Œéœ€è¦å•ç‹¬å¼•å…¥è¿™ä¸ªä¾èµ–ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--Controllerå‚æ•°æ ¡éªŒ--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åœ¨å…¶ä»–é¡¹ç›®ä¸­å¯ä»¥å¼•å…¥è¿™ä¸ªä¾èµ–ï¼Œå¹¶è‡ªå·±è°ƒæ•´ç‰ˆæœ¬å³å¯ä½¿ç”¨ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.hibernate.validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>hibernate-validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>6.0.2.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="æ³¨è§£è¯´æ˜"><a href="#æ³¨è§£è¯´æ˜" class="headerlink" title="æ³¨è§£è¯´æ˜"></a>æ³¨è§£è¯´æ˜</h3><table><thead><tr><th>éªŒè¯æ³¨è§£</th><th>éªŒè¯çš„æ•°æ®ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@AssertFalse</td><td>Boolean,boolean</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯false</td></tr><tr><td>@AssertTrue</td><td>Boolean,boolean</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯true</td></tr><tr><td>@NotNull</td><td>ä»»æ„ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸æ˜¯null</td></tr><tr><td>@Null</td><td>ä»»æ„ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯null</td></tr><tr><td>@Min(value&#x3D;å€¼)</td><td>BigDecimalï¼ŒBigInteger, byte,short, int, longï¼Œç­‰ä»»ä½•Numberæˆ–CharSequenceï¼ˆå­˜å‚¨çš„æ˜¯æ•°å­—ï¼‰å­ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å¤§äºç­‰äº@MinæŒ‡å®šçš„valueå€¼</td></tr><tr><td>@Maxï¼ˆvalue&#x3D;å€¼ï¼‰</td><td>å’Œ@Minè¦æ±‚ä¸€æ ·</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å°äºç­‰äº@MaxæŒ‡å®šçš„valueå€¼</td></tr><tr><td>@DecimalMin(value&#x3D;å€¼)</td><td>å’Œ@Minè¦æ±‚ä¸€æ ·</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å¤§äºç­‰äº@ DecimalMinæŒ‡å®šçš„valueå€¼</td></tr><tr><td>@DecimalMax(value&#x3D;å€¼)</td><td>å’Œ@Minè¦æ±‚ä¸€æ ·</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å°äºç­‰äº@ DecimalMaxæŒ‡å®šçš„valueå€¼</td></tr><tr><td>@Digits(integer&#x3D;æ•´æ•°ä½æ•°, fraction&#x3D;å°æ•°ä½æ•°)</td><td>å’Œ@Minè¦æ±‚ä¸€æ ·</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼çš„æ•´æ•°ä½æ•°å’Œå°æ•°ä½æ•°ä¸Šé™</td></tr><tr><td>@Size(min&#x3D;ä¸‹é™, max&#x3D;ä¸Šé™)</td><td>å­—ç¬¦ä¸²ã€Collectionã€Mapã€æ•°ç»„ç­‰</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼çš„åœ¨minå’Œmaxï¼ˆåŒ…å«ï¼‰æŒ‡å®šåŒºé—´ä¹‹å†…ï¼Œå¦‚å­—ç¬¦é•¿åº¦ã€é›†åˆå¤§å°</td></tr><tr><td>@Past</td><td>java.util.Date,java.util.Calendar;Joda Timeç±»åº“çš„æ—¥æœŸç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ï¼ˆæ—¥æœŸç±»å‹ï¼‰æ¯”å½“å‰æ—¶é—´æ—©</td></tr><tr><td>@Future</td><td>ä¸@Pastè¦æ±‚ä¸€æ ·</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ï¼ˆæ—¥æœŸç±»å‹ï¼‰æ¯”å½“å‰æ—¶é—´æ™š</td></tr><tr><td>@NotBlank</td><td>CharSequenceå­ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºç©ºï¼ˆä¸ä¸ºnullã€å»é™¤é¦–ä½ç©ºæ ¼åé•¿åº¦ä¸º0ï¼‰ï¼Œä¸åŒäº@NotEmptyï¼Œ@NotBlankåªåº”ç”¨äºå­—ç¬¦ä¸²ä¸”åœ¨æ¯”è¾ƒæ—¶ä¼šå»é™¤å­—ç¬¦ä¸²çš„é¦–ä½ç©ºæ ¼</td></tr><tr><td>@Length(min&#x3D;ä¸‹é™, max&#x3D;ä¸Šé™)</td><td>CharSequenceå­ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼é•¿åº¦åœ¨minå’ŒmaxåŒºé—´å†…</td></tr><tr><td>@NotEmpty</td><td>CharSequenceå­ç±»å‹ã€Collectionã€Mapã€æ•°ç»„</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºnullä¸”ä¸ä¸ºç©ºï¼ˆå­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º0ã€é›†åˆå¤§å°ä¸ä¸º0ï¼‰</td></tr><tr><td>@Range(min&#x3D;æœ€å°å€¼, max&#x3D;æœ€å¤§å€¼)</td><td>BigDecimal,BigInteger,CharSequence, byte, short, int, longç­‰åŸå­ç±»å‹å’ŒåŒ…è£…ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼åœ¨æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´</td></tr><tr><td>@Email(regexp&#x3D;æ­£åˆ™è¡¨è¾¾å¼,flag&#x3D;æ ‡å¿—çš„æ¨¡å¼)</td><td>CharSequenceå­ç±»å‹ï¼ˆå¦‚Stringï¼‰</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯Emailï¼Œä¹Ÿå¯ä»¥é€šè¿‡regexpå’ŒflagæŒ‡å®šè‡ªå®šä¹‰çš„emailæ ¼å¼</td></tr><tr><td>@Pattern(regexp&#x3D;æ­£åˆ™è¡¨è¾¾å¼,flag&#x3D;æ ‡å¿—çš„æ¨¡å¼)</td><td>Stringï¼Œä»»ä½•CharSequenceçš„å­ç±»å‹</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸æŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</td></tr><tr><td>@Valid</td><td>ä»»ä½•éåŸå­ç±»å‹</td><td>æŒ‡å®šé€’å½’éªŒè¯å…³è”çš„å¯¹è±¡å¦‚ç”¨æˆ·å¯¹è±¡ä¸­æœ‰ä¸ªåœ°å€å¯¹è±¡å±æ€§ï¼Œå¦‚æœæƒ³åœ¨éªŒè¯ç”¨æˆ·å¯¹è±¡æ—¶ä¸€èµ·éªŒè¯åœ°å€å¯¹è±¡çš„è¯ï¼Œåœ¨åœ°å€å¯¹è±¡ä¸ŠåŠ @Validæ³¨è§£å³å¯çº§è”éªŒè¯</td></tr></tbody></table><p>è¿™é‡Œåªåˆ—å‡ºHibernate Validatoræä¾›çš„å¤§éƒ¨åˆ†éªŒè¯çº¦æŸæ³¨è§£ï¼Œå¦‚éœ€äº†è§£æ›´å¤šè¯·å‚è€ƒhibernate validatorå®˜æ–¹æ–‡æ¡£äº†è§£å…¶ä»–éªŒè¯çº¦æŸæ³¨è§£å’Œè¿›è¡Œè‡ªå®šä¹‰çš„éªŒè¯çº¦æŸæ³¨è§£å®šä¹‰ã€‚è¿™å—å†…å®¹åŸºæœ¬å°±æ˜¯ç¿»è¯‘æ–‡æ¡£ï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚</p><h3 id="å®é™…ä½¿ç”¨"><a href="#å®é™…ä½¿ç”¨" class="headerlink" title="å®é™…ä½¿ç”¨"></a>å®é™…ä½¿ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æ¥å£æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼è¿›è¡Œå‚æ•°æ ¡éªŒã€‚</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/save/valid"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span> <span class="token class-name">UserDTO</span> userDTO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>userDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"æˆåŠŸ"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// å¦‚æœæ¥å£æ¥æ”¶å‚æ•°æ˜¯è¿™ç§åŸå­ç±»å‹ï¼Œéœ€è¦åœ¨è¿™ä¸ªæ–¹æ³•æ‰€åœ¨ç±»ä¸Š `@Validated` æ³¨è§£</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get/id"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotBlank</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>userDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"æˆåŠŸ"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>DTO ä¸Šçš„æ³¨è§£</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token comment">/*** ç”¨æˆ·ID*/</span>    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·idä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>        <span class="token comment">/** ç”¨æˆ·å*/</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Length</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">"^[\\u4E00-\\u9FA5A-Za-z0-9\\*]*$"</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·æ˜µç§°é™åˆ¶ï¼šæœ€å¤š20å­—ç¬¦ï¼ŒåŒ…å«æ–‡å­—ã€å­—æ¯å’Œæ•°å­—"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>        <span class="token comment">/** æ‰‹æœºå·*/</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">"^[1][3,4,5,6,7,8,9][0-9]&#123;9&#125;$"</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·æ ¼å¼æœ‰è¯¯"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>    <span class="token comment">/**æ€§åˆ«*/</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>    <span class="token comment">/** é‚®ç®±*/</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"è”ç³»é‚®ç®±ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±æ ¼å¼ä¸å¯¹"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>    <span class="token comment">/** å¯†ç */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>    <span class="token comment">/*** åˆ›å»ºæ—¶é—´ */</span>    <span class="token annotation punctuation">@Future</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ—¶é—´å¿…é¡»æ˜¯å°†æ¥æ—¶é—´"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å…¨å±€å¼‚å¸¸å¤„ç†"><a href="#å…¨å±€å¼‚å¸¸å¤„ç†" class="headerlink" title="å…¨å±€å¼‚å¸¸å¤„ç†"></a>å…¨å±€å¼‚å¸¸å¤„ç†</h3><p>å‚æ•°æ ¡éªŒå¤±è´¥æ—¶ä¼šæŠ¥å¼‚å¸¸ï¼Œä½†æ˜¯æŠŠå¼‚å¸¸ç›´æ¥æ˜¾ç¤ºç»™ç”¨æˆ·æ˜¯éå¸¸ä¸å‹å¥½çš„ï¼Œäºæ˜¯éœ€è¦å…¨å±€å¤„ç†ä¸€ä¸‹å¼‚å¸¸ã€‚</p><p>é»˜è®¤å¼‚å¸¸ä¿¡æ¯</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2022-01-01T04:41:23.164+00:00"</span><span class="token punctuation">,</span>  <span class="token property">"status"</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>  <span class="token property">"error"</span><span class="token operator">:</span> <span class="token string">"Internal Server Error"</span><span class="token punctuation">,</span>  <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"/by_id"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å…¨å±€å¼‚å¸¸æ‹¦æˆªå™¨</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestControllerAdvice</span><span class="token comment">// å…¨å±€å¼‚å¸¸æ‹¦æˆªå¹¶è¿”å›JSONæ•°æ®</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**    è¿™ä¸ªæ‹¦æˆªå¼‚å¸¸ï¼Œå¼‚å¸¸çš„æ¥å£çº§åˆ«è¶Šé«˜å°±è¶Šè¦æ”¾åœ¨ä¸‹é¢å†™ï¼Œ    å› ä¸ºè¿™ä¸ªæ‹¦æˆªå¼‚å¸¸æ˜¯åŒ¹é…é“¾çš„æ–¹å¼ï¼Œå¦‚æœåŒ¹é…åˆ°äº†å°±ä¸å¾€ä¸‹åŒ¹é…äº†ï¼Œ    å¦‚æœä½ ç¬¬ä¸€ä¸ªå°±å†™æœ€é«˜çº§åˆ«çš„å¼‚å¸¸ï¼Œé‚£ä¹ˆä¸‹é¢çš„å¼‚å¸¸åŒ¹é…å°±åŒ¹é…ä¸åˆ°ã€‚    */</span>    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DUPLICATE_KEY_CODE <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> PARAM_FAIL_CODE <span class="token operator">=</span> <span class="token number">1002</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> VALIDATION_CODE <span class="token operator">=</span> <span class="token number">1003</span><span class="token punctuation">;</span>    <span class="token comment">/**     * å¤„ç†è‡ªå®šä¹‰å¼‚å¸¸     */</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">BizException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">// æ³¨è§£é‡Œé¢å†™éœ€è¦æ‹¦æˆªçš„å¼‚å¸¸å³å¯</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleRRException</span><span class="token punctuation">(</span><span class="token class-name">BizException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ–¹æ³•å‚æ•°æ ¡éªŒ     */</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleMethodArgumentNotValidException</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ValidationException     */</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">ValidationException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleValidationException</span><span class="token punctuation">(</span><span class="token class-name">ValidationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ConstraintViolationException     */</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleConstraintViolationException</span><span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">NoHandlerFoundException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handlerNoFoundException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">DuplicateKeyException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleDuplicateKeyException</span><span class="token punctuation">(</span><span class="token class-name">DuplicateKeyException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">// è‡ªå·±å†³å®šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è‡ªå®šä¹‰å‚æ•°æ³¨è§£"><a href="#è‡ªå®šä¹‰å‚æ•°æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰å‚æ•°æ³¨è§£"></a>è‡ªå®šä¹‰å‚æ•°æ³¨è§£</h3><p>å¦‚æœé»˜è®¤çš„æ³¨è§£ä¸å¤Ÿç”¨ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰æ³¨è§£ï¼Œæ¯”å¦‚ä¸€ä¸ªèº«ä»½è¯å·çš„éªŒè¯</p><h4 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Documented</span><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>PARAMETER<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>FIELD<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token class-name">IdentityCardNumberValidator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">IdentityCardNumber</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"èº«ä»½è¯å·ç ä¸åˆæ³•"</span><span class="token punctuation">;</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="è‡ªå®šä¹‰Validator"><a href="#è‡ªå®šä¹‰Validator" class="headerlink" title="è‡ªå®šä¹‰Validator"></a>è‡ªå®šä¹‰Validator</h4><p>è¿™é‡Œæ‰æ˜¯æ‰æ˜¯çœŸæ­£çš„å¤„ç†é€»è¾‘ï¼Œæ³¨è§£ç±»ä¼¼æ˜¯ä¸€ä¸ªå¾½ç« ï¼Œåœ¨AOPå¤„ç†å¤„ç†æ—¶ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è¯†ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IdentityCardNumberValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">IdentityCardNumber</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">IdentityCardNumber</span> identityCardNumber<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> constraintValidatorContext<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">IdCardValidatorUtils</span><span class="token punctuation">.</span><span class="token function">isValidate18Idcard</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"èº«ä»½è¯å·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@IdentityCardNumber</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"èº«ä»½è¯ä¿¡æ¯æœ‰è¯¯,è¯·æ ¸å¯¹åæäº¤"</span><span class="token punctuation">)</span><span class="token keyword">private</span> <span class="token class-name">String</span> clientCardNo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h3 id="ä½¿ç”¨groupsçš„æ ¡éªŒ"><a href="#ä½¿ç”¨groupsçš„æ ¡éªŒ" class="headerlink" title="ä½¿ç”¨groupsçš„æ ¡éªŒ"></a>ä½¿ç”¨groupsçš„æ ¡éªŒ</h3><p>å°±æ˜¯åˆ†ç»„æ ¡éªŒï¼Œä¸€ä¸ªå®ä½“ç±»ä½œä¸ºä¸åŒçš„æ¥å£å‚æ•°æ ¡éªŒæ—¶ï¼Œå¯èƒ½æœ‰ä¸åŒçš„éœ€æ±‚ã€‚å®šä¹‰ä¸¤ä¸ªæ¥å£ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>groups<span class="token punctuation">.</span></span><span class="token class-name">Default</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Create</span> <span class="token keyword">extends</span> <span class="token class-name">Default</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>groups<span class="token punctuation">.</span></span><span class="token class-name">Default</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Update</span> <span class="token keyword">extends</span> <span class="token class-name">Default</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å†åœ¨éœ€è¦æ ¡éªŒçš„åœ°æ–¹@Validatedå£°æ˜æ ¡éªŒç»„</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/update/groups"</span><span class="token punctuation">)</span>                 <span class="token comment">// è¿™é‡Œå°±æ˜¯æ ¸å¿ƒ</span>   <span class="token keyword">public</span> <span class="token class-name">RspDTO</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">UserDTO</span> userDTO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       userService<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>userDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token class-name">RspDTO</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>DTO æ”¹ä¸€ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token comment">/*** ç”¨æˆ·ID*/</span>    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·idä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token class-name">Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>    <span class="token comment">/**     * ç”¨æˆ·å     */</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Length</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·åä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">"^[\\u4E00-\\u9FA5A-Za-z0-9\\*]*$"</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·æ˜µç§°é™åˆ¶ï¼šæœ€å¤š20å­—ç¬¦ï¼ŒåŒ…å«æ–‡å­—ã€å­—æ¯å’Œæ•°å­—"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>    <span class="token comment">/**     * æ‰‹æœºå·     */</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">"^[1][3,4,5,6,7,8,9][0-9]&#123;9&#125;$"</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"æ‰‹æœºå·æ ¼å¼æœ‰è¯¯"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>    <span class="token comment">/**     * æ€§åˆ«     */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>    <span class="token comment">/**     * é‚®ç®±     */</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"è”ç³»é‚®ç®±ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"é‚®ç®±æ ¼å¼ä¸å¯¹"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>    <span class="token comment">/**     * å¯†ç      */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>    <span class="token comment">/*** åˆ›å»ºæ—¶é—´ */</span>    <span class="token annotation punctuation">@Future</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"æ—¶é—´å¿…é¡»æ˜¯å°†æ¥æ—¶é—´"</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>tips æ³¨æ„:åœ¨å£°æ˜åˆ†ç»„çš„æ—¶å€™å°½é‡åŠ ä¸Š <code>extend javax.validation.groups.Default</code> å¦åˆ™,åœ¨ä½ å£°æ˜<code>@Validated(Update.class)</code> çš„æ—¶å€™,å°±ä¼šå‡ºç°ä½ åœ¨é»˜è®¤æ²¡æ·»åŠ <code>groups = {}</code>çš„æ—¶å€™çš„æ ¡éªŒç»„<code>@Email(message = &quot;é‚®ç®±æ ¼å¼ä¸å¯¹&quot;)</code>,ä¼šä¸å»æ ¡éªŒ,å› ä¸ºé»˜è®¤çš„æ ¡éªŒç»„æ˜¯<code>groups = {Default.class}</code></p>          </div><h3 id="restfulé£æ ¼ç”¨æ³•"><a href="#restfulé£æ ¼ç”¨æ³•" class="headerlink" title="restfulé£æ ¼ç”¨æ³•"></a>restfulé£æ ¼ç”¨æ³•</h3><p>åœ¨å¤šä¸ªå‚æ•°æ ¡éªŒ,æˆ–è€…@RequestParam å½¢å¼æ—¶å€™,éœ€è¦åœ¨controllerä¸ŠåŠ æ³¨@Validated</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">RspDTO</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·idä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RspDTO</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nonAbsent</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·ä¸å­˜åœ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RspDTO</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>éœ€è¦åŠ ä¸Š</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"user/"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Validated</span>  <span class="token comment">// è¿™ä¸ªæ˜¯é‡ç‚¹</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractController</span> <span class="token punctuation">&#123;</span>    Â·Â·Â·Â·Â·Â·Â·Â·Â·<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¯´äº†ä¸€å¤§é€šåŸºç¡€çš„ä¸œè¥¿ï¼Œä½†æ˜¯æ„Ÿè§‰å…¶å®æŒºå…¨é¢äº†ï¼Œå„ç§ç”¨æ³•éƒ½ä»‹ç»äº†ï¼Œä¸è¶³å°±æ˜¯ ä½†æ˜¯æ²¡æœ‰å¾ˆæ·±å…¥ï¼Œå¦‚å¼‚å¸¸çš„æ—¥å¿—çš„è®°å½•ï¼Œç­‰ç­‰ã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax3.sinaimg.cn/large/005NNTS5ly1gxy53k0f3ej335s1o0nif.jpg" alt="é›†åŸç¾ ç²‰è‰²å¸½å­"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>validation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ™šé—»</title>
    <link href="/2021/12/20/gossip-05/"/>
    <url>/2021/12/20/gossip-05/</url>
    
    <content type="html"><![CDATA[<p>æ­£å¸¸æ™šä¸Šä¸‹ç­ï¼Œä¸‹äº†å…¬äº¤è½¦ï¼Œè½¦ç«™åˆ°æˆ‘ç§Ÿçš„çš„å‡ºç§Ÿå±‹é‡Œè¿˜æœ‰æ®µè·ç¦»ï¼Œä¸‹äº†ç­åˆ°ä¹Ÿä¸ç€æ€¥ï¼Œæ‚ å“‰æ¸¸å“‰çš„èµ°åœ¨è·¯ä¸Šï¼Œè§†é‡é‡Œä¸çŸ¥é“ä»å“ªä¸ªè§’è½é‡Œå†’å‡ºæ¥ä¸€åªæµæµªç‹—ï¼Œä¸€å¼€å§‹æˆ‘å¹¶æ²¡æœ‰å»æ³¨æ„è¿™ä¸ªåŠ¨ç‰©ï¼Œäººæ¥äººå¾€çš„å¤§è¡—ä¸Šæµæµªç‹—å¾ˆå¤šï¼Œæˆ‘åªæ˜¯ä¸€ä¸ªè·¯äººè€Œå·²ï¼Œæ— èŠçš„æ‘‡å¤´æ™ƒè„‘æ—¶ä¸ç»æ„æ’‡äº†ä¸€çœ¼ï¼Œæ˜¯ä¸€åªæˆ‘ä¹Ÿä¸å¤ªä¼šå½¢å®¹ï¼Œä¸ªå­ä¸é«˜ï¼Œå››è‚¢çŸ­å°ï¼Œä¸çŸ¥ æ˜¯å› ä¸ºæµæµªçš„ç¼˜æ•…ï¼Œè¿˜æ˜¯å¤œè‰²ç¬¼ç½©çš„ç¼˜æ•…ï¼Œæˆ‘çœ‹ç€æ˜¯åªç°æºœæºœçš„å°ç‹—ï¼Œä¸è¿‡çœ¼ç›åœ¨ç°æš—ä¸­æ˜¾çš„å¾ˆäº®ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ²¡ç”±å¤´çš„å¿µæƒ³è®©æˆ‘æƒ³è·Ÿç€å®ƒèµ°ä¸€èµ°ï¼Œå°±è·Ÿäº†å®ƒä¸€é˜µå­ï¼Œæƒ³è¯•è¯•èƒ½ä¸èƒ½æŠŠå®ƒå¸¦èµ°ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šç”Ÿå‡ºè¿™ç§æƒ³æ³•ï¼Œä¸‹äº†ç­çš„æ—¶é—´æ˜¯æˆ‘å¯ä»¥è‡ªç”±æ”¯é…çš„æ—¶é—´ï¼Œæˆ‘ä¾¿è·Ÿç€å®ƒèµ°äº†ä¸€æ®µæ—¶é—´ï¼Œå°ç‹—çš„æˆ’å¿ƒæ¯”è¾ƒé‡ï¼Œæ ¹æœ¬ä¸è®©æˆ‘é è¿‘ï¼Œè¿™ä¹Ÿæ˜¯å®ƒå­˜æ´»åˆ°ç°åœ¨çš„åŸå› å§ï¼Œæˆ‘ä¸æ˜¯ä¸€ä¸ªå¾ˆæœ‰è€å¿ƒçš„äººï¼Œè·Ÿç€çš„æ—¶å€™ï¼Œæˆ‘æ²¡æœ‰åˆ«çš„è¡ŒåŠ¨ï¼Œæˆ‘å”¯ä¸€åšçš„å°±æ˜¯è·Ÿåœ¨åé¢å°è¯•å¦‚æœå®ƒå›è¿‡å¤´æ¥æˆ‘å°±è¹²ä¸‹ï¼Œä¼¸å‡ºæ‰‹æ¥ï¼Œçœ‹çœ‹å®ƒä¼šä¸ä¼šè¿‡æ¥ï¼Œæœ€åçš„æœ€åå®ƒæ²¡æœ‰è¿‡æ¥ï¼Œæˆ‘ä¹Ÿè½¬èº«å›å»äº†ï¼Œæˆ‘å¯¹è‡ªå·±è¯´ï¼Œè¿™å°±æ˜¯æ²¡æœ‰ç¼˜åˆ†å•Šï¼Œä¸ä»…äººä¸äººï¼Œäººä¸ç‹—ä¹Ÿæ˜¯ã€‚è·¯ä¸Šæˆ‘å¯ä»¥ä»åº—é‡Œä¹°ä¸¤æ ¹ç«è…¿è‚ ï¼Œè¿™æ ·åšä¹Ÿè®¸ä¼šå¢åŠ å®ƒè¿‡æ¥çš„å‡ ç‡ï¼Œå¯æˆ‘ä¸æƒ³ï¼Œè¿™ç§äº‹è¿˜æ˜¯ç›¸ä¿¡ç¼˜åˆ†å§ï¼Œä¹°ç«è…¿è¿™ç§è¡Œä¸ºä¼šä¸ä¼šåªæ˜¯åœ¨éª—è‡ªå·±ã€‚å®ƒä¸è¿‡æ¥ï¼Œè¿™ä¹Ÿä¸æ˜¯ä¸€ä»¶åäº‹ï¼Œæˆ‘å°±ä¸€æ™®æ™®é€šé€šæ‰“å·¥äººï¼Œå°±ç®—å®ƒè¿‡æ¥è·Ÿæˆ‘èµ°äº†ï¼Œæˆ‘å¯ä»¥è®©å®ƒâ€œé”¦è¡£ç‰é£Ÿâ€ï¼Œâ€œå¹²å¹²å‡€å‡€â€ä¸€æ®µæ—¶é—´ï¼Œå¯ç°å®æ˜¯ï¼Œæˆ‘æ²¡æœ‰æ±½è½¦ï¼Œæˆ‘æ²¡æœ‰åŠæ³•å¸¦å®ƒä¸Šé«˜é“ï¼Œæˆ–è€…å¤§å·´ï¼Œå¯èƒ½è¿™ä¹Ÿæ˜¯å€Ÿå£ï¼Œæ˜¯æˆ‘ä¸ºæˆ‘çš„è‡ªç§è‡ªåˆ©æ‰¾çš„ä¸€ä¸ªå€Ÿå£ï¼Œæ²¡æœ‰åŠæ³•å¸¦å›å®¶ã€‚åœ¨è¿‡å¹´å›å®¶è¿™ä¸€é“å¾‹ä¸‹ï¼Œå®ƒè¢«æˆ‘æŠ›å¼ƒçš„å¯èƒ½æ€§å¾ˆé«˜ã€‚é‚£æ—¶å€™æ‰æ˜¯çœŸæ­£çš„å¥½å¿ƒåŠäº†åäº‹ï¼Œå®ƒæœ¬æ¥å°±æ˜¯æµæµªçš„ï¼ŒåŸæœ¬å°±æ˜¯ï¼Œä¸€ç›´å¦‚æ­¤å°±æŒºå¥½ã€‚</p><p>å› ä¸ºä½ çš„ä¸€ç‚¹â€œå–„æ„â€ã€‚ä½ æ‰“ç ´å®ƒå¹³é™çš„ç”Ÿæ´»ï¼Œæ•…äº‹çš„æœ€åï¼Œä½ è¿˜è¡¨ç°å‡ºä¸€å¹…æˆ‘å·²ç»å°½åŠ›çš„æ— è¾œè¡¨æƒ…ã€‚æŒºè®©äººç¬‘è¯çš„ã€‚</p><blockquote><p>åŸæ–‡è®°äº2020å¹´æœ«</p></blockquote><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva3.sinaimg.cn/large/005NNTS5ly1gxkcc6lgslj32yo1o0x6p.jpg" alt="ç«å½±å¿è€…æ˜¥é‡æ¨±"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆæ‹</title>
    <link href="/2021/12/20/other-05/"/>
    <url>/2021/12/20/other-05/</url>
    
    <content type="html"><![CDATA[<div class="note note-light">            <p>æ— è®ºæˆ‘ä»¬æœ€åç”Ÿç–æˆä»€ä¹ˆæ ·å­ï¼Œæ›¾ç»å¯¹ä½ çš„å¥½éƒ½æ˜¯çœŸçš„ï¼Œå°±ç®—ç»ˆæœ‰ä¸€æ•£ï¼Œä¹Ÿåˆ«è¾œè´Ÿç›¸é‡ï¼Œå¸Œæœ›ä½ ä¸åæ‚”è®¤è¯†æˆ‘ï¼Œä¹Ÿæ˜¯çœŸçš„å¿«ä¹è¿‡ï¼Œå¦‚æœèƒ½å›åˆ°ä»å‰ï¼Œæˆ‘ä¼šé€‰æ‹©ä¸è®¤è¯†ä½ ï¼Œä¸æ˜¯æˆ‘åæ‚”ï¼Œæ˜¯æˆ‘ä¸èƒ½é¢å¯¹ç°åœ¨çš„ç»“å±€ã€‚</p>          </div><div class="note note-light">            <p>ç›¸æ‹867å¤©ï¼Œåˆ†æ‰‹ä¸ƒå¹´ï¼Œå•èº«ä¸ƒå¹´ï¼Œè‡³ä»Šæ— æ³•é‡Šæ€€ï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯ä¸ç”˜å§ã€‚</p>          </div><div class="note note-light">            <p>åˆ°ç°åœ¨éƒ½è®°å¾—å¾ˆæ¸…æ¥šï¼<br>è¯»åˆäºŒï¼ŒæŠ¥é“çš„ç¬¬ä¸€å¤©ï¼Œä¸€çœ¼æœ›å»å°±çœ‹ä¸­äº†ä»–ï¼Œç„¶åç»™äº†æˆ‘ä¸€ä¸ªæœ‹å‹5å—é’±ï¼Œå«ä»–è·Ÿæˆ‘æ¢åº§ä½ã€‚è¿™æ ·å°±ååœ¨äº†å¥¹åé¢ä½ç½®ï¼Œå°±è¿™æ ·ä¸€æ¥äºŒå»æ…¢æ…¢ç†Ÿæ‚‰äº†ï¼Œåæ¥åœ¨ä¸€èµ·äº†ï¼Œåˆä¸‰è¯»å®Œå¥¹è€ƒä¸Šäº†é«˜ä¸­æˆ‘å› ä¸ºå·®äº†å‡ åˆ†ï¼Œæœ€åè¯»äº†èŒæ ¡ï¼Œåˆ°äº†2015å¹´å› ä¸ºè¯»èŒæ ¡å­¦ä¼šäº†æ··ç¤¾ä¼šï¼Œæœ€åå®¶é‡Œä¸‹äº†é€šç‰’ï¼Œä¸å¥¹å•†é‡äº†åé€‰æ‹©äº†å…¥ä¼ï¼Œå½“æ—¶è®°å¾—è¿˜è·Ÿå¥¹çº¦å®šå¥½äº†ï¼Œäº”å¹´åå›æ¥å°±å¨¶å¥¹ï¼Œ2016å¹´æˆ‘æ»¡18å²çš„æ—¶å€™å¥¹è¿˜è·Ÿæˆ‘çˆ¶æ¯æ¥äº†éƒ¨é˜Ÿè·Ÿæˆ‘åº†ç¥ç”Ÿæ—¥ï¼Œæˆ‘çˆ¶æ¯å¯¹å¥¹ä¹Ÿå¾ˆæ»¡æ„ï¼Œå†œå†2016å¤§å¹´ä¸‰åï¼Œå› ä¸ºéƒ¨é˜Ÿæ™šä¸Šæœ‰è·¨å¹´æ™šä¼šï¼Œæ‰‹æœºå°±æ”¾åœ¨äº†å®¿èˆé‡Œï¼Œç­‰åˆ°å›æ¥æ—¶ï¼ŒåªçŸ¥é“å¥¹è·Ÿæˆ‘è¯´å‡ºäº†åˆ†æ‰‹ï¼éšåæˆ‘2017å¹´é€€ä¼ï¼Œå›æ¥ä¹Ÿæ‰“å¬äº†å¥¹æ¶ˆæ¯ï¼Œå¯æ˜¯ä¸æ„¿æ„è§æˆ‘ï¼ä¹‹åè°ˆè¿‡å‡ ä¸ªå¥³æœ‹å‹ï¼Œä½†æ˜¯éƒ½å·²ä¹ æƒ¯ä¸å¥¹åšæ¯”è¾ƒï¼Œç›´åˆ°ç°åœ¨éƒ½è®°å¾—å¥¹çš„ç”Ÿæ—¥ï¼Œæ‰‹æœºå·ç ï¼Œæˆ–è®¸å¥¹æ‰‹æœºå·ç å·²æ¢ï¼Œæˆ–è®¸å¥¹å·²ç»“å©šï¼Œä¸ºäººæ¯ï¼Œä½†æ˜¯å¾ˆé«˜å…´æœ‰è¿™ä¹ˆä¸€æ®µå›å¿†ï¼Œæˆ–è®¸ä¸ç¾å¥½ï¼</p>          </div><div class="note note-light">            <p>æˆ‘çš„åˆæ‹æ˜¯ä¸€ä¸ªå¾ˆå–„è§£äººæ„çš„å¥³å­©ï¼Œåªæ˜¯è´¥åœ¨äº†å½“åˆçš„å¹´å°‘æ— çŸ¥ï¼Œå¦‚ä»Šå›å¿†èµ·æ¥ï¼Œè¿½æ‚”è«åŠï¼</p>          </div><div class="note note-light">            <p>å¥¹æ˜¯ç¬¬ä¸€ä¸ªæˆ‘å¾ˆæ­£å¼çš„ä»‹ç»ç»™å®¶é‡Œçš„å¥³å­©å­</p>          </div><div class="note note-light">            <p>åˆæ‹ ä¸€ä¸ªç°åœ¨æ—¶åˆ»ç‰µåŠ¨æˆ‘æƒ…ç»ªçš„äºº å³ä½¿åˆ†å¼€äº† ä¹Ÿå¸Œæœ›å¥¹èƒ½è¿‡çš„å¥½ å¹´å°‘ä¸æ‡‚çˆ±çš„æ—¶æœŸç¢°åˆ°çˆ±çš„äººçœŸçš„å¾ˆéš¾æŠŠæ¡ä½ å½“ä¸€ä¸ªè¦èµ°ä¸€ä¸ªæŒ½ç•™æ— æœçš„æ—¶å€™ é‚£æ—¶å¯èƒ½çœŸçš„æ˜¯å¿ƒåŠ›æ†”æ‚´ æ— èƒ½ä¸ºåŠ›å§ åªèƒ½è¯´é”™è¿‡äº†å¥¹ä»¥å è²Œä¼¼æ˜¯ä¸§å¤±äº†çˆ±åˆ«äººçš„èƒ½åŠ› æ¯å½“è‡ªå·±å»åšæˆ–è€…å¾—åˆ°æ–°çš„ä¸œè¥¿çš„æ—¶å€™ æ€»ä¼šå¹»æƒ³å¥¹åœ¨èº«è¾¹åº”è¯¥ä¼šæ˜¯æ€ä¹ˆæ · å¯èƒ½åˆ°ç°åœ¨ä¹Ÿè¿˜æ²¡æœ‰é‡Šæ€€ é‡Šæ€€ä¸æ‰è¿™æ®µæ„Ÿæƒ… é‡Šæ€€ä¸æ‰å¥¹ æ€»æ˜¯åœ¨å›å¿†ä¸ç°å®ä¸­æ¥å›æ‹‰æ‰¯ ä¸è¿‡å¯ä»¥ç¡®å®šçš„æ˜¯å¥¹ä¸ä¼šå›æ¥äº† ä¹Ÿæ²¡æœ‰åæ–¹å‘çš„é’Ÿ ä¹Ÿä¸ä¼šæœ‰é‚£ä¸ªä¸€èµ·ä¸Šè¯¾ ä¸€èµ·è‡ªä¹  ä¸€èµ·åƒé¥­çš„æƒ…æ™¯ ä¸Šè¯¾ è‡ªä¹  åƒé¥­å¯èƒ½ä¸ä¼šå˜ å˜å¾—åªæ˜¯ä»ä¸¤äººå˜æˆä¸¤ä¸ªäºº é™·å…¥å›å¿†ä¸å¯è‡ªæ‹” å¯èƒ½çœŸçš„æ˜¯æƒ³è°ˆä¸€åœºä»å§‹è€Œç»ˆçš„æ‹çˆ± å¯¼è‡´çˆ±å¾—å¤ªæ»¡ å¤ªç”¨åŠ› åŠå¹´æ„Ÿæƒ…ä¸¤å¹´ç¥­å¥  æ‰€ä»¥è¯´å•Š ä¸ä¼šçˆ±çš„å¹´çºª å¹´å°‘æ—¶æœŸçœŸçš„ä¸è¦çˆ±çš„å¤ªç”¨åŠ› ç‰©æå¿…å<br> åªèƒ½è¯´ä¸€æ­¥ä¸€å›çœ¸ ä½†ä¸ä¼šåœç•™åŸåœ°</p>          </div><div class="note note-light">            <p>å¥¹æ˜¯æˆ‘æƒ³æŠŠæ‰€æœ‰æ¸©æš–éƒ½ç»™å¥¹çš„äºº å¥¹ä¹Ÿæ•‘èµè¿‡æˆ‘</p>          </div><div class="note note-light">            <p>åˆæ‹å•Šï¼Œæœ‰ç‚¹ç”œæœ‰ç‚¹é…¸æœ‰ç‚¹æ— å¥ˆï¼Œè®©æˆ‘ä¹…ä¹…ä¸èƒ½å¿˜æ€€ï¼Œä»–è¯´è¿‡çš„è¯åšè¿‡çš„äº‹éƒ½åˆ»åœ¨æˆ‘å¿ƒé‡Œå¹¶æ°¸è¿œå­˜åœ¨ï¼Œå’Œä»–åˆ†å¼€æˆ‘è§‰å¾—æˆ‘å†ä¹Ÿä¸ä¼šé‚£ä¹ˆå¼€å¿ƒï¼Œæ­¤æ—¶æ­¤åˆ»æˆ‘éƒ½è§‰å¾—æˆ‘ä»¬åº”è¯¥æ°¸è¿œåœ¨ä¸€èµ·ï¼Œå¥½æƒ³æ‹¥æœ‰ä¸€å°æ—¶å…‰æœºå•Šï¼Œå›åˆ°æˆ‘ä»¬çœ¼é‡Œéƒ½æ˜¯å½¼æ­¤çš„æ—¶å€™ã€‚ã€‚ã€‚</p>          </div><div class="note note-light">            <p>å¥¹å°±ç«™åœ¨å“ªå„¿ ç«™åœ¨æˆ‘åå…«å²çš„å¿ƒä¸­ã€‚</p>          </div><div class="note note-light">            <p>å¤§æ¦‚å°±æ˜¯å±±æµ·äº¦å¯å¹³ï¼Œå”¯æœ‰å¥¹ç»ˆæ˜¯æ„éš¾å¹³å§</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1gxk2cqm12uj32yo1o0kjp.jpg" alt="é˜¿å°”å‘æ–¯å±±"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤§å­¦é‡Œdeä¸€äº›äº‹</title>
    <link href="/2021/12/14/gossip-04/"/>
    <url>/2021/12/14/gossip-04/</url>
    
    <content type="html"><![CDATA[<p>é¥æƒ³åˆšè¿›å¤§å­¦ï¼Œæ¼«æ— ç›®çš„ï¼Œä¸çŸ¥é“è‡ªå·±è¦èµ°å“ªæ¡è·¯ï¼Œæ— ä¸€ä¾‹å¤–ï¼ŒåšæŒä¸‹æ¥å°±æ˜¯ä½ èµ°çš„è·¯ã€‚å¤§ä¸€åˆï¼ŒåŸæœ¬çš„è®¡ç®—æœºç½‘ç»œä¸“ä¸šï¼Œä¸“ç§‘å°±ä¸“ç§‘å‘—ï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰ä¸»è§ï¼Œå¬äº†åˆ«äººçš„è¦æ±‚ï¼Œè½¬äº†ä¸€æ¬¡ä¸“ä¸šï¼Œè½¬åˆ°äº†åœŸæœ¨ä¸“ä¸šï¼Œæˆ‘çš„æ€§æ ¼æ˜¯å±äºæ¯”è¾ƒæç«¯çš„ï¼Œæˆ–è€…è¯´åŠå…¶çš„éµå¾ªæœ¬å¿ƒï¼Œä¸“ä¸šè¯¾å­¦å¾—ä¸å¤šï¼Œç®—æ˜¯ä¸ºè‡ªå·±ä¸å¥½å¥½å­¦ä¹ æ‰¾äº†ä¸ªå€Ÿå£å§ï¼Œå¬é—»å¤§å­¦é‡Œé¢å­¦ç”Ÿä¼šæœ‰æ„æ€ï¼Œç†æ‰€åº”å½“çš„åŠ äº†ä¸€ä¸ªå­¦ç”Ÿä¼šï¼Œæ„Ÿå—äº†ä¸€ä¸‹ï¼Œç®—æ˜¯æœ‰äº†ä¸€ç‚¹è§è§£ã€‚å¤§ä¸€ç”±äºåªæ˜¯ä¸€ä¸ªå¤§ä¸€æ–°ç”Ÿï¼Œåˆç”±äºä¸€äº›è®©äººç”Ÿæ¼çš„æ„ç»ªï¼Œæˆ‘æ²¡å•¥è¡¨ç°ï¼Œåªæ˜¯æœ¬æœ¬åˆ†åˆ†çš„åšä¸€äº›ç®€å•çš„äº‹ã€‚</p><p>å¤§äºŒï¼Œå½“äº†ä¸€ä¸ªæ‰€è°“çš„éƒ¨é•¿ï¼Œå½“æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå°±æƒ³ç•™ä¸‹æ¥ï¼Œ</p><p>æˆ‘è®°å¾—å­¦ç”Ÿä¼šä¸»å¸­è¯´çš„è¯æˆ‘æœ‰ä¸€ç‚¹è§è§£ï¼Œè¯´ä½ ä»¬å½“éƒ¨é•¿ä¸æ˜¯å› ä¸ºä½ ä»¬æœ‰å¤šä¼˜ç§€ï¼Œè€Œæ˜¯åªæ˜¯ä½ ä»¬æ„¿æ„ç•™ä¸‹æ¥ã€‚æ˜¯å•Šï¼Œæ„¿æ„ç•™ä¸‹æ¥çš„æ‰æ˜¯çœŸçš„æƒ³ç•™ä¸‹æ¥çš„ï¼Œä¼˜ç§€ä¸ä¼˜ç§€ï¼Œç•™ä¸‹æ¥çš„æ‰æ˜¯çœŸçš„ã€‚ç•™ä¸‹æ¥çš„æ‰æ˜¯çœŸçš„ã€‚</p><p>æ¥ä¸‹æ¥çš„æ—¥å­ï¼Œå¤§äºŒä¸€å¹´æ˜¯æˆ‘æœ€å·…å³°çš„æ—¶å€™ï¼Œå¸¦ç€å¤§ä¸€çš„æ–°ç”Ÿä¸€èµ·ç©é—¹ï¼Œå‡ ä¸ªéƒ¨é•¿ä¹‹é—´çš„æ‰“é—¹ï¼Œè¿™æ®µæ—¶é—´ç®—æ˜¯æˆ‘å¤§å­¦é‡Œæœ€å¿«ä¹çš„æ—¶å…‰ï¼Œæˆ‘çš„æ€§æ ¼å¦‚æ­¤ï¼Œå¦‚æœæ²¡æœ‰äº‹æƒ…è®©æˆ‘ä»¬äº§ç”Ÿè”ç³»ï¼Œæˆ‘ä»¬çš„å…³ç³»åŠå…¶å®¹æ˜“å°±æ­¢æ­¥äºæ­¤ï¼Œå°±ç®—å¶å°”èƒ½æ’è§ï¼Œä¹Ÿåªæ˜¯ç®€å•çš„å¯’æš„ä¸¤å¥ï¼Œæ˜¯æ²¡æœ‰åŠæ³•å›åˆ°ä»å‰çš„ã€‚ä»å°åˆ°å¤§ï¼Œæ— ä¸€ä¾‹å¤–ï¼</p><p>å†è€…å¤§ä¸‰äº†ï¼Œå½“æ—¶ä¸Šå­¦æœŸè¿˜æ˜¯ä¸€èµ·ç›´æ¥åœ¨æ“åœºä¸Šå–å•¤é…’ï¼Œçœ¼é‡Œé—ªç€å°æ˜Ÿæ˜Ÿå’Œå¤§å®¶è¯´ç€è¢«ç²‰é¥°è¿‡åçš„çˆ±æƒ…æ•…äº‹ï¼Œå¬å®Œä¹äº†ï¼Œæˆ‘ä¹Ÿä¹äº†ã€‚ä¸Šå¤´ä¹‹åï¼Œæœ‰äººåµï¼Œæœ‰äººé—¹ï¼Œæœ‰äººå“­ç€å–Šç€è¦åƒå¥èƒƒæ¶ˆé£Ÿç‰‡ï¼Œæˆ‘ä¹Ÿä¸è¯´æ˜¯è°ï¼Œè¿™ä¸ªç¡®å®æŒºè®¨å–œã€‚åæ¥å•Šï¼Œå› ä¸ºæ²¡æœ‰å­¦ç”Ÿä¼šçš„äº¤é›†ï¼ŒåŠ ä¸Šæˆ‘æ¯•ä¸šå°†è‡³ï¼Œå†åæ¥ï¼Œå› ä¸ºä¸€åœºçªå¦‚å…¶æ¥çš„ç–«æƒ…ï¼Œæœˆäº®ä¸‹äº†å±±ï¼Œæ˜Ÿæ˜Ÿä¹Ÿå¤±äº†çº¦ï¼Œæˆ‘ä»¬éƒ½å¼„ä¸¢äº†ä¸€äº›äººå’Œäº‹ï¼Œå°½ç®¡ä½ ç°åœ¨å˜å¾—æ¯”ä»¥å‰ä¼˜ç§€äº†ã€‚</p><p>åˆæ˜¯ä¸€å¹´å¯’å†¬ï¼Œæˆ‘åœ¨ä½•å¤„å¤©æ¶¯ï¼Œä½ åˆåœ¨è°çš„ä¼ä¸‹ã€‚</p><blockquote><p>åŸæ–‡è®°äº2020å¹´å¹´æœ«ã€‚</p></blockquote><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1gxdqoo9ln1j32yo1o07wj.jpg" alt="é›†åŸç¾2å‘¨å¹´ç”Ÿæ—¥å¿«ä¹"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çŸ¥æ˜“è¡Œéš¾</title>
    <link href="/2021/12/14/gossip-03/"/>
    <url>/2021/12/14/gossip-03/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>â€œæ— ä¸€ä¾‹å¤–ï¼Œæˆ‘æ°¸è¿œçŸ¥é“å“ªæ¡è·¯æ˜¯å¯¹çš„ã€‚ä½†æˆ‘ä»æ¥ä¸èµ°ï¼Œå› ä¸ºå¤ªä»–å¨˜éš¾äº†â€</p><p>â€“ è¿™å¥è¯ä¸æ˜¯æˆ‘è¯´çš„ï¼Œä½†äº‹å®å¦‚æ­¤ã€‚</p>          </div><p>è·ç¦»ä¸Šä¸€æ¬¡å†™è¿™ä¸œè¥¿çš„æ—¶å€™å·²ç»è¿‡å»æœ‰æ®µæ—¶é—´äº†ï¼Œä»æ—¶é—´ä¸Šæ¥è¯´ï¼Œæˆ‘å¹¶ä¸å¿™ï¼Œä½†æ˜¯æˆ‘å´è¿Ÿè¿Ÿä¸åŠ¨é”®ç›˜ï¼Œæˆ‘å´ä¸€ç›´æ²¡æœ‰äº§å‡ºï¼Œåœ¨ä¿æŒè¾“å‡ºçš„æ—¶å€™ï¼ŒåŒæ—¶ä¹Ÿæ˜¯éœ€è¦ä¿æŒè¾“å…¥çš„ï¼Œå¦åˆ™ä¼šæœ‰ä¸€ç§æ‹”å‰‘å››é¡¾å¿ƒèŒ«ç„¶çš„æ„Ÿè§‰ï¼Œåˆä¼‘çš„æ—¶å€™ï¼Œç”µè„‘é¢å‰ä¸€åï¼Œæ„Ÿè§‰æˆ‘åº”è¯¥åšç‚¹ä»€ä¹ˆï¼Œäºæ˜¯æ–°å»ºäº†ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒğŸ‘¼ç„¶åå®‰å¿ƒçš„æ‰“å¼€äº†åŸç¥ã€‚</p><p>ç°åœ¨ç›¸è¾ƒäºå†™demoï¼Œæ›´å¤šçš„æ—¶é—´æ˜¯åœ¨çœ‹demoï¼Œæˆ‘ä»£ç å†™çš„å¹¶ä¸å°‘ï¼ŒåšæŒæ˜¯ä¸€ä»¶å¾ˆéš¾çš„äº‹ï¼Œåœ¨ä¸€æ¬¡ä¸€æ¬¡çš„é‡å¤é€ è½®å­ä¸­ï¼Œæˆ‘çš„å†™ä»£ç çš„çƒ­æƒ…å¥½åƒè¢«æ¶ˆè€—çš„éå¸¸ä¸¥é‡ï¼Œä¸€æ®µæ—¶é—´å°±æ˜¯æ‡’ç™Œä¸Šèº«ï¼Œä¸æƒ³é‡æ„ï¼Œä¸æƒ³çœ‹è‡ªå·±å†™çš„ä»£ç ï¼Œçœ‹è‡ªå·±çš„ä»£ç æœ‰ç§æ— åŠ›çš„èŒ«ç„¶æ„Ÿï¼Œè¿™æ—¶å€™æˆ‘ä¼šæœŸå¾…æœ‰ä¸ªäººèƒ½å¸®æˆ‘é‡æ„ä¸€ä¸‹ä»£ç ï¼Œèƒ½å¸®æˆ‘æŠŠè¿™ä¸ªä»£ç å˜å¾—è€³ç›®ä¸€æ–°ï¼Œä»¥è®©æˆ‘é‡æ‹¾å¯¹ä»£ç çš„çƒ­æƒ…ï¼Œä½†å¯æƒœçš„æ˜¯ï¼Œè¿™ç§æœŸå¾…åªèƒ½æ˜¯æœŸå¾…ï¼Œåªæ˜¯æˆ‘ç»™è‡ªå·±æ‰¾çš„ä¸€ä¸ªå€Ÿå£ï¼Œå€Ÿå£çš„èƒŒåå°±æ˜¯æˆ‘çœŸå®çš„æƒ°æ€§ã€‚é“ç†éƒ½æ‡‚ï¼Œä½ ä¸æƒ³åšçš„äº‹ï¼Œå…¶å®å°±æ˜¯ä½ åº”è¯¥åšçš„äº‹ã€‚çŸ¥æ˜“è¡Œéš¾ã€‚</p><p>çœ‹å¼€æºé¡¹ç›®çš„ä»£ç ï¼Œå®é™…ä¸Šæ˜¯å¾ˆè½»æ¾çš„ï¼Œä½†æœ‰äº›äººçœ‹ä»£ç æ„Ÿè§‰ç´¯ï¼Œæ„Ÿè§‰ç´¯ï¼Œåº”è¯¥å°±æ˜¯ä»£ç å†™å°‘äº†ï¼Œéœ€è¦å¤šå¤šå­¦ä¹ ï¼Œå¸¦å…¥åŸæœ‰å¼€å‘è€…çš„æ€æƒ³ï¼Œåœ¨ä½ æœªé˜…è¯»ä¸€å®šé‡çš„ä»£ç ä¹‹å‰ï¼Œè¯·åŠ¡å¿…è™šå¿ƒå½“ä¸€ä¸ªå­¦ä¹ è€…ã€‚</p><p>åŠªåŠ›è®©è‡ªå·±æˆä¸ºäº†ä¸€ä¸ªå‚ä¸è€…ï¼Œå‚ä¸å¼€æºé¡¹ç›®ï¼Œæ˜¯æœ€å¥½çš„æå‡è‡ªå·±çš„æ–¹å¼ï¼Œå­¦ä¹ ä¼˜ç§€é¡¹ç›®çš„æ€è·¯ï¼Œæ˜¯æå‡è‡ªå·±æœ€å¥½çš„æ–¹æ³•ï¼Œ</p><h2 id="é›¾å¤±æ¥¼å°"><a href="#é›¾å¤±æ¥¼å°" class="headerlink" title="é›¾å¤±æ¥¼å°"></a>é›¾å¤±æ¥¼å°</h2><div class="note note-info">            <p>é‚£æ—¥æœ¬äººé ä¸ä½ï¼Œæˆ‘é è°å•Šï¼Ÿè€è’‹ï¼Ÿâ€</p><p>â€œæ›´é ä¸ä½ã€‚â€</p><p>â€œä¸€ä¸ªå†™æ—¥è®°çš„äººã€‚â€</p><p>â€œæ­£ç»äººè°å†™æ—¥è®°å•Šã€‚â€</p><p>â€œæ˜¯å•Šã€‚â€</p><p>â€œä½ å†™æ—¥è®°å—ã€‚â€</p><p>â€œæˆ‘ä¸å†™ã€‚â€</p><p>â€œä½ å†™æ—¥è®°å—ï¼Ÿâ€</p><p>â€œè°èƒ½æŠŠå¿ƒé‡Œè¯å†™æ—¥è®°é‡Œï¼Ÿâ€</p><p>â€œå†™å‡ºæ¥çš„å“ªèƒ½å«å¿ƒé‡Œè¯ï¼Ÿâ€</p><p>â€œä¸‹è´±ã€‚â€</p><p>â€œä¸‹è´±ã€‚â€</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1gxdqc3tq92j31z41404qp.jpg" alt="å¥³å­©"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue+TS+é»˜è®¤ç»„åˆå¼API</title>
    <link href="/2021/11/29/vue-03/"/>
    <url>/2021/11/29/vue-03/</url>
    
    <content type="html"><![CDATA[<p>å¯¹äºå‰ç«¯çš„å¼€å‘ï¼Œæˆ‘ä¸€ç›´æœ‰åœ¨å…³æ³¨ï¼ŒVueçš„å†™æ³•æœ‰ç‚¹å¤šï¼Œæ˜¯å¥½äº‹è¿˜æ˜¯åäº‹ï¼Œæˆ‘ä¹Ÿæä¸æ‡‚äº†ï¼Œå‡ ç§å†™æ³•æˆ‘ä¹Ÿéƒ½è¯•äº†ä¸€è¯•ï¼Œå¯èƒ½æ˜¯TSçš„åŸå› ï¼Œè§‰å¾—å¹¶ä¸æ˜¯å¾ˆå®Œç¾ï¼Œé»˜è®¤çš„å†™æ³•å¯¹TSå…¼å®¹æ€§åº”è¯¥æ˜¯æœ€å¥½çš„ï¼Œå…¼å®¹çš„åœºæ™¯è¿˜æ˜¯è›®å¤šçš„ï¼Œä½†æ˜¯ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶çš„æ—¶å€™ï¼Œæ²¡æœ‰æç¤ºã€‚</p><p><code>&lt;script setup lang=&quot;ts&quot;&gt;</code>çš„å†™æ³•ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶çš„æç¤ºååˆ†å‹å¥½ï¼Œä½†è¿™ç§å†™æ³•è®¿é—®å­ç»„ä»¶é‡Œçš„å±æ€§æ—¶ä¹Ÿä¸å‹å¥½ã€‚ä½†æ˜¯è½¬å¿µæƒ³ä¸€æƒ³ï¼Œç»„ä»¶ä¹‹é—´åº”è¯¥æ˜¯ç‹¬ç«‹çš„ï¼Œå†µä¸”Vueä¹Ÿæä¾›äº†çˆ¶å­ç»„ä»¶äº¤äº’çš„æ–¹æ³•ï¼Œçˆ¶ç»„ä»¶ç›´æ¥æ“ä½œå­ç»„ä»¶è¿™ç§è¡Œä¸ºå¹¶ä¸æ¨èã€‚è¿™ç§å†™æ³•ä»£ç çš„ç®€æ´åº¦å¾ˆé«˜ï¼ŒæŒ‰å¸¸ç†æ¥è¯´ï¼Œä»£ç è¶Šå°‘è¶Šæ˜“ç»´æŠ¤ã€‚è‡ªå·±æ–Ÿé…Œã€‚</p><p>æˆ‘æ˜¯æœŸæœ›å‰ç«¯å‘å±•å¦‚åç«¯çš„springbootä¸€æ ·ï¼Œå†™æ³•è§„èŒƒç»Ÿä¸€èµ·æ¥ï¼Œä¸ç®¡ä»ç»´æŠ¤ä¸Šï¼Œè¿˜æ˜¯å¼€å‘ä¸Šéƒ½èƒ½å‡å°‘ä¸€äº›æ²¡æœ‰å¿…è¦çš„å·¥ä½œé‡ã€‚</p><h2 id="é»˜è®¤ç»„åˆå¼APIå†™æ³•"><a href="#é»˜è®¤ç»„åˆå¼APIå†™æ³•" class="headerlink" title="é»˜è®¤ç»„åˆå¼APIå†™æ³•"></a>é»˜è®¤ç»„åˆå¼APIå†™æ³•</h2><h3 id="å“åº”å¼"><a href="#å“åº”å¼" class="headerlink" title="å“åº”å¼"></a>å“åº”å¼</h3><h4 id="ç®€å•çš„å“åº”å¼"><a href="#ç®€å•çš„å“åº”å¼" class="headerlink" title="ç®€å•çš„å“åº”å¼"></a>ç®€å•çš„å“åº”å¼</h4><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123; name&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123;sum&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineComponent<span class="token punctuation">,</span> toRefs<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å®šä¹‰</span>        <span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>        <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'hahahahah'</span><span class="token punctuation">)</span>        <span class="token comment">// ä½¿ç”¨ç¬¬ä¸€æ­¥</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            sum<span class="token punctuation">,</span>name        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="å¤æ‚çš„å“åº”å¼"><a href="#å¤æ‚çš„å“åº”å¼" class="headerlink" title="å¤æ‚çš„å“åº”å¼"></a>å¤æ‚çš„å“åº”å¼</h4><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- ä½¿ç”¨ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123;user.name&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123;user.age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123;user.sex&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineComponent<span class="token punctuation">,</span> toRefs<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å®šä¹‰ä¸€ä¸ªå˜é‡</span>        <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å°çº¢'</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>            <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">'ç”·'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token comment">// å¯¼å‡ºæ‰èƒ½åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            user        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="ä¸€äº›å°å¦™æ‹›"><a href="#ä¸€äº›å°å¦™æ‹›" class="headerlink" title="ä¸€äº›å°å¦™æ‹›"></a>ä¸€äº›å°å¦™æ‹›</h4><p>ä¸æƒ³åœ¨returnä¸­å†™å¤ªå¤šçš„æ„Ÿè§‰æ²¡å•¥æ„ä¹‰çš„ä»£ç ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·å†™</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- ä½¿ç”¨ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123; user.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123; user.age &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123; user.sex &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>&#123;&#123; sum &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sunc(<span class="token punctuation">'</span>233<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æŒ‰é’®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineComponent<span class="token punctuation">,</span> toRefs<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å°çº¢'</span><span class="token punctuation">,</span>                <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>                <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">'ç”·'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token comment">// å¯ä»¥å†™ä»»æ„å˜é‡ï¼Œå°±ä¸éœ€è¦åœ¨returnä¸­å†™äº†</span>            <span class="token literal-property property">sum</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>            <span class="token comment">// å‡½æ•°ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œé¢å†™</span>            <span class="token function">sunc</span><span class="token punctuation">(</span>id<span class="token operator">:</span>string<span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'id='</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token comment">// è®¡ç®—å±æ€§ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œå†™ï¼Œå°±ä¸éœ€è¦åœ¨returné‡Œé¢å†™å¾ˆå¤šä»£ç äº†ã€‚</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// è§£æ„å¯¼å‡ºï¼Œè®¿é—®çš„æ—¶å€™ä¸éœ€è¦å¸¦ä¸Šdata</span>            <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ç›‘å¬äº‹ä»¶"><a href="#ç›‘å¬äº‹ä»¶" class="headerlink" title="ç›‘å¬äº‹ä»¶"></a>ç›‘å¬äº‹ä»¶</h3><p>å…³äºç›‘å¬çš„APIè¿˜æŒºå¤šçš„ï¼Œè¿™é‡Œä¸è¿‡å¤šä»‹ç»ï¼Œåªä»‹ç»å¸¸è§çš„ã€‚</p><h4 id="ç®€å•çš„ç›‘å¬"><a href="#ç®€å•çš„ç›‘å¬" class="headerlink" title="ç®€å•çš„ç›‘å¬"></a>ç®€å•çš„ç›‘å¬</h4><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">const</span> fastName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'3222'</span><span class="token punctuation">)</span>       <span class="token function">watch</span><span class="token punctuation">(</span>fastName<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span>oldVal</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal <span class="token operator">+</span><span class="token string">'---'</span><span class="token operator">+</span>oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>       <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>           fastName       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="ä¾¦å¬ä¸€ä¸ªGetterå‡½æ•°"><a href="#ä¾¦å¬ä¸€ä¸ªGetterå‡½æ•°" class="headerlink" title="ä¾¦å¬ä¸€ä¸ªGetterå‡½æ•°"></a>ä¾¦å¬ä¸€ä¸ªGetterå‡½æ•°</h4><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ä½¿ç”¨reactiveå®šä¹‰çš„ä¸èƒ½ç›´æ¥data.user.nameæ¥ç›‘å¬ã€‚</span>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å°çº¢'</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>            <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">'ç”·'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token comment">// å¯ä»¥å†™ä»»æ„å˜é‡ï¼Œå°±ä¸éœ€è¦åœ¨returnä¸­å†™äº†</span>        <span class="token literal-property property">sum</span><span class="token operator">:</span> <span class="token number">200</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">// ä½¿ç”¨è¿™ç§æ–¹å¼å°±æ˜¯å¯ä»¥ç›‘å¬å¾—åˆ°ã€‚</span>    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> data<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal <span class="token operator">+</span> <span class="token string">'---'</span> <span class="token operator">+</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è§£æ„å¯¼å‡ºï¼Œè®¿é—®çš„æ—¶å€™ä¸éœ€è¦å¸¦ä¸Šdata</span>        <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="ç›‘å¬å¤šä¸ªæº"><a href="#ç›‘å¬å¤šä¸ªæº" class="headerlink" title="ç›‘å¬å¤šä¸ªæº"></a>ç›‘å¬å¤šä¸ªæº</h4><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> fooRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span>    <span class="token keyword">const</span> barRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">"bar"</span><span class="token punctuation">)</span>    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fooRef<span class="token punctuation">,</span> barRef<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>foo<span class="token punctuation">,</span> bar<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>prevFoo<span class="token punctuation">,</span> prevBar<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'newVal = '</span> <span class="token operator">+</span> foo<span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> bar<span class="token operator">+</span><span class="token string">',,,oldVal'</span> <span class="token operator">+</span> prevFoo<span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> prevBar<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å®šä¹‰Props"><a href="#å®šä¹‰Props" class="headerlink" title="å®šä¹‰Props"></a>å®šä¹‰Props</h3><h4 id="ç®€å•çš„å®šä¹‰"><a href="#ç®€å•çš„å®šä¹‰" class="headerlink" title="ç®€å•çš„å®šä¹‰"></a>ç®€å•çš„å®šä¹‰</h4><p>çˆ¶ç»„ä»¶ä¼ å€¼æ—¶ä¼šæœ‰ç±»å‹æ ¡éªŒã€‚</p><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span>ctx</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="é«˜ç«¯çš„å®šä¹‰"><a href="#é«˜ç«¯çš„å®šä¹‰" class="headerlink" title="é«˜ç«¯çš„å®šä¹‰"></a>é«˜ç«¯çš„å®šä¹‰</h4><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">interface</span> <span class="token class-name">Book</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">title</span><span class="token operator">:</span> string  <span class="token literal-property property">author</span><span class="token operator">:</span> string  <span class="token literal-property property">year</span><span class="token operator">:</span> number<span class="token punctuation">&#125;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ™®é€šå˜é‡</span>    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>      <span class="token comment">// é»˜è®¤å€¼</span>      <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯é»˜è®¤å€¼'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token comment">// æ ¡éªŒ</span>      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">msg</span><span class="token operator">:</span> String</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> msg<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">3</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">// å¯¹è±¡å˜é‡</span>    <span class="token literal-property property">book</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¦ä½¿ç”¨PropTypeæ¥å®šä¹‰å˜é‡</span>      <span class="token literal-property property">type</span><span class="token operator">:</span> Object <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>Book<span class="token operator">></span><span class="token punctuation">,</span>      <span class="token comment">// è¯·åŠ¡å¿…ä½¿ç”¨ç®­å¤´å‡½æ•°</span>      <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'è¿™æ˜¯ä¸€ä¸ªé”™è¯¯'</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">book</span><span class="token operator">:</span> Book</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token operator">!</span>book<span class="token punctuation">.</span>title    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è‡ªå®šä¹‰äº‹ä»¶"><a href="#è‡ªå®šä¹‰äº‹ä»¶" class="headerlink" title="è‡ªå®šä¹‰äº‹ä»¶"></a>è‡ªå®šä¹‰äº‹ä»¶</h3><p>propså’Œè‡ªå®šä¹‰äº‹ä»¶éƒ½å±äºç»„ä»¶åŒ–å¸¸ç”¨çš„ï¼Œè‡ªå®šä¹‰äº‹ä»¶çš„å†å²åŒ…è¢±è¿‡é‡ï¼Œåœ¨setupçš„å†™æ³•ä¸­å¾—åˆ°äº†è§£å†³ï¼Œè¿™ä¸ªç»„åˆå¼APIä¸­æ²¡å•¥å¥½çš„åŠæ³•</p><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// è¿™é‡Œä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> aaaa <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token function">changeTaa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// æŠ›å‡ºäº‹ä»¶ï¼Œäº‹ä»¶åä¸ºdel</span>        ctx<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'del'</span><span class="token punctuation">,</span> <span class="token number">233</span><span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>      <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>aaaa<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> ç›‘å¬éƒ¨åˆ† <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>HelloWorld ref<span class="token operator">=</span><span class="token string">"model"</span> @del<span class="token operator">=</span><span class="token string">"testEmit"</span><span class="token operator">/</span><span class="token operator">></span><span class="token comment">// å½“åœ¨å­ç»„ä»¶ä¸­æŠ›å‡ºäº‹ä»¶æ­¤æ–¹æ³•å°±ä¼šè¢«è§¦å‘ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•è¿”å›å€¼æ¥ç»™å­ç»„ä»¶ä¼ é€’æ•°æ®ã€‚å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼ŒåŠåŠå­å¾ˆéš¾çš„å•¦ã€‚</span><span class="token function">testEmit</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">id</span><span class="token operator">:</span>string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è‡ªå®šä¹‰äº‹ä»¶è§¦å‘äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'id='</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åˆ°è¿™ï¼Œå¸¸ç”¨çš„ç»„åˆå¼APIçš„å†™æ³•å…¶å®å°±å·²ç»å·®ä¸å¤šäº†ã€‚</p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva3.sinaimg.cn/large/005NNTS5ly1gwwg1k0x9cj32yo1o04qq.jpg" alt="é›†åŸç¾Sky train"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>typescript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot2.5.xæ•´åˆQuartzå¹¶æŒä¹…åŒ–</title>
    <link href="/2021/11/22/java-05/"/>
    <url>/2021/11/22/java-05/</url>
    
    <content type="html"><![CDATA[<p>é£é£ç«ç«ï¼Œæææƒšæƒšï¼Œspringboot2.6.0æ­£å¼ç‰ˆä¹Ÿå‘å¸ƒäº†ï¼ŒåŒæ—¶ä¹Ÿå®£å¸ƒäº†2.4xç‰ˆæœ¬åœæ­¢ç»´æŠ¤ã€‚2.5.xç³»åˆ—ä¹Ÿæ˜¯ç›®å‰è‡ªå·±å†™Demoåœ¨ç”¨çš„ï¼Œä¸ºä»€ä¹ˆè¦è®°å½•ä¸‹æ¥å‘¢ï¼Œ ä¸»è¦æˆ‘æŠŠé¡¹ç›®å‡çº§åˆ°2.6ä¹‹åé¡¹ç›®è·‘ä¸èµ·æ¥äº†ï¼ŒåŸå› æˆ‘çŸ¥é“ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œçœ‹äº†çœ‹æœºç¿»çš„æ›´æ–°æ–‡æ¡£ï¼Œæœ‰å¤„å¯èƒ½æ˜¯å½±å“æˆ‘é¡¹ç›®è·‘ä¸èµ·æ¥çš„åŸå› ï¼Œå°±æ˜¯é™åˆ¶äº†ä¾èµ–çš„å¾ªç¯å¯¼å…¥ï¼Œç°åœ¨ä¾èµ–å¾ªç¯å¯¼å…¥ï¼Œé¡¹ç›®æ˜¯ä¼šç›´æ¥è·‘ä¸èµ·æ¥ã€‚æˆ‘çš„é—®é¢˜æ˜¯é¡¹ç›®é‡Œè·å–ä¸åˆ°DataSourceæ•°æ®æºï¼Œæˆ‘ç”¨äº†å„ç§å§¿åŠ¿ï¼Œéƒ½è·å–ä¸åˆ°ï¼Œé“ä»”åœ¨çº¿ç–‘æƒ‘ã€‚æ—¢ç„¶ä¸èƒ½æ— ç¼å‡çº§ï¼Œé‚£æˆ‘å°±è®°ä¸‹æ¥ä¸€ä¸ªæ­£å¸¸çš„ç‰ˆæœ¬ã€‚</p><p>å®šæ—¶ä»»åŠ¡æ˜¯å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚ç®€å•çš„ç”Ÿæ—¥æé†’ï¼Œæ¯å¤©å®šç‚¹æŸ¥è¯¢ç”¨æˆ·çš„ç”Ÿæ—¥ä¿¡æ¯ã€‚ç„¶åå‘å‡ºä¸€ç³»åˆ—çš„æç¤ºæ“ä½œã€‚ä¸äº†è§£ä½ å°±æ„Ÿè§‰å¾ˆéš¾ï¼Œä½†æ˜¯ç°åœ¨springç»™æˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤šçš„ä¾¿åˆ©ï¼Œçœ‹ä¸€çœ‹ï¼Œåœ¨å¤´è„‘é£æš´ä¸€ä¸‹ï¼Œä¹Ÿä¸éš¾ã€‚ç¼–ç¨‹ä¸€é€”ï¼Œæ®Šé€”åŒå½’ã€‚</p><p>ä¸»è¦å·¥ä½œä¸­å¥½å¤šåŒæ­¥ä»£ç æ„Ÿè§‰éƒ½å¯ä»¥ä½¿ç”¨å®šæ—¶ä»»åŠ¡æ¥å¤„ç†ï¼Œç„¶è€Œå®é™…ä¸Šç”¨çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„Mainæ–¹æ³•ï¼Œåæ§½å§ï¼Œäººå®¶é‚£ä»£ç åˆä¸æ˜¯ä¸èƒ½è·‘ï¼Œä¸ä»…èƒ½è·‘ï¼Œè¿˜èƒ½èµšé’±ã€‚æ²¡å•¥å¥½åæ§½çš„ï¼Œå°±æ˜¯ç»´æŠ¤æ—¶æƒ³éª‚å¨˜ï¼Œéª‚å¨˜å°±éª‚å¨˜ï¼Œè¿˜ååˆ†å®¹æ˜“å‡ºé”™ã€‚</p><h2 id="æ ¸å¿ƒé…ç½®ç±»"><a href="#æ ¸å¿ƒé…ç½®ç±»" class="headerlink" title="æ ¸å¿ƒé…ç½®ç±»"></a>æ ¸å¿ƒé…ç½®ç±»</h2><p>ç”¨äº†è¿™ä¸ªé…ç½®ç±»ï¼Œè…°ä¸é…¸äº†ï¼Œè…¿ä¸ç—›äº†ï¼Œä¸€æ¬¡èƒ½çˆ¬äº”å±‚æ¥¼ã€‚è§‰ä¹Ÿç¡çš„é¦™äº†ã€‚å¥½å§ï¼Œå‰é¢çº¯å±æ‰¯æ·¡ï¼Œå†™äº†è¿™ä¸ªymlä¸­å°±ä¸éœ€è¦é…ç½®äº†ï¼Œå¤§è‡´çœ‹ä¸€ä¸‹æ¯è¡Œçš„æ³¨é‡Šï¼Œæµ‹è¯•å­¦ä¹ ä¸­ä»¥å…ˆè·‘èµ·æ¥ä¸ºä¸»ï¼Œç„¶åå†æ…¢æ…¢ç ”ç©¶å³å¯ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * quartzé…ç½®ç±» */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuartzConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * æ­¤ç§æ³¨å…¥æ–¹å¼ï¼Œåœ¨springboot2.6ä¸­è·å–ä¸åˆ°ï¼Œ     */</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>    <span class="token comment">/**     * Describe: å®šæ—¶ä»»åŠ¡å·¥å‚     * Param: DataSource     * Return: ScheduleFactoryBean     * */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">SchedulerFactoryBean</span> <span class="token function">schedulerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Properties</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// QlSchedulerè¿™ä¸ªå€¼å¯ä»¥è‡ªå®šä¹‰</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.scheduler.instanceName"</span><span class="token punctuation">,</span> <span class="token string">"QlScheduler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®ä¸ºAUTOæ—¶ä½¿ç”¨ï¼Œé»˜è®¤çš„å®ç°org.quartz.scheduler.SimpleInstanceGeneratoræ˜¯åŸºäºä¸»æœºåç§°å’Œæ—¶é—´æˆ³ç”Ÿæˆã€‚</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.scheduler.instanceId"</span><span class="token punctuation">,</span> <span class="token string">"AUTO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// çº¿ç¨‹æ± ç›¸å…³é…ç½®</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.threadPool.class"</span><span class="token punctuation">,</span> <span class="token string">"org.quartz.simpl.SimpleThreadPool"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.threadPool.threadCount"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.threadPool.threadPriority"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// JobStoreTXåœ¨æ¯æ¬¡æ‰§è¡Œä»»åŠ¡åéƒ½ä½¿ç”¨commitæˆ–è€…rollbackæ¥æäº¤æ›´æ”¹ã€‚</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.class"</span><span class="token punctuation">,</span> <span class="token string">"org.quartz.impl.jdbcjobstore.JobStoreTX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é›†ç¾¤é…ç½®ï¼šå¦‚æœæœ‰å¤šä¸ªè°ƒåº¦å™¨å®ä½“çš„è¯åˆ™å¿…é¡»è®¾ç½®ä¸ºtrueï¼Œå¦‚æœé¡¹ç›®éƒ¨ç½²äº†å¤šä¸ªï¼Œå°±è®¾ç½®ä¸ºtrue</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.isClustered"</span><span class="token punctuation">,</span> <span class="token string">"false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é›†ç¾¤é…ç½®ï¼šæ£€æŸ¥é›†ç¾¤ä¸‹çš„å…¶ä»–è°ƒåº¦å™¨å®ä½“çš„æ—¶é—´é—´éš”</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.clusterCheckinInterval"</span><span class="token punctuation">,</span> <span class="token string">"15000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®ä¸€ä¸ªé¢‘åº¦(æ¯«ç§’)ï¼Œç”¨äºå®ä¾‹æŠ¥å‘Šç»™é›†ç¾¤ä¸­çš„å…¶ä»–å®ä¾‹</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.maxMisfiresToHandleAtATime"</span><span class="token punctuation">,</span> <span class="token string">"5000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è§¦å‘å™¨è§¦å‘å¤±è´¥åå†æ¬¡è§¦çŠ¯çš„æ—¶é—´é—´éš”</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.misfireThreshold"</span><span class="token punctuation">,</span> <span class="token string">"12000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ•°æ®åº“è¡¨å‰ç¼€ é‡ç‚¹è¿™ä¸ªå’Œå»ºè¡¨SQLæ˜¯å¯¹åº”çš„å…³ç³»ï¼Œå¦‚æœæ”¹äº†éœ€è¦æ”¹åŠ¨å»ºè¡¨è¯­å¥</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.tablePrefix"</span><span class="token punctuation">,</span> <span class="token string">"schedule_"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ä» LOCKS è¡¨æŸ¥è¯¢ä¸€è¡Œå¹¶å¯¹è¿™è¡Œè®°å½•åŠ é”çš„ SQL è¯­å¥</span>        prop<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"org.quartz.jobStore.selectWithLockSQL"</span><span class="token punctuation">,</span> <span class="token string">"SELECT * FROM &#123;0&#125;LOCKS UPDLOCK WHERE LOCK_NAME = ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SchedulerFactoryBean</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SchedulerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ•°æ®æº</span>        factory<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ä¸Šé¢çš„é…ç½®</span>        factory<span class="token punctuation">.</span><span class="token function">setQuartzProperties</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¯è‡ªå®šä¹‰</span>        factory<span class="token punctuation">.</span><span class="token function">setSchedulerName</span><span class="token punctuation">(</span><span class="token string">"QlScheduler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é¡¹ç›®å¯åŠ¨å30ç§’åå¯åŠ¨å¼€å§‹æ‰§è¡Œå®šæ—¶ä»»åŠ¡</span>        factory<span class="token punctuation">.</span><span class="token function">setStartupDelay</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        factory<span class="token punctuation">.</span><span class="token function">setApplicationContextSchedulerContextKey</span><span class="token punctuation">(</span><span class="token string">"applicationContextKey"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        factory<span class="token punctuation">.</span><span class="token function">setOverwriteExistingJobs</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è‡ªåŠ¨å¯åŠ¨</span>        factory<span class="token punctuation">.</span><span class="token function">setAutoStartup</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> factory<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>æ­¤ç§é…ç½®çš„Quartzæ˜¯æŒä¹…åŒ–åˆ°æ•°æ®åº“çš„ï¼Œå°±æ˜¯é¡¹ç›®é‡å¯å®šæ—¶ä»»åŠ¡çš„çŠ¶æ€å¹¶ä¸ä¼šä¸¢å¤±ã€‚</p>          </div><h2 id="ç”¨äºWebç®¡ç†Bean"><a href="#ç”¨äºWebç®¡ç†Bean" class="headerlink" title="ç”¨äºWebç®¡ç†Bean"></a>ç”¨äºWebç®¡ç†Bean</h2><p>å¯ä»¥è‡ªå®šä¹‰ï¼Œè¦ç‚¹çœ‹ä»£ç æ³¨é‡Šã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/**    * å®šæ—¶ä»»åŠ¡    */</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"schedule_job"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleJob</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¿…é¡»åºåˆ—åŒ–</span>    <span class="token comment">// å¿…é¡»è¦æœ‰</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> JOB_PARAM_KEY <span class="token operator">=</span> <span class="token string">"JOB_PARAM_KEY"</span><span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡id     */</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>ASSIGN_ID<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>    <span class="token comment">/**     * spring beanåç§°     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"bean_name"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> beanName<span class="token punctuation">;</span>    <span class="token comment">/**     * å‚æ•°     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"params"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> params<span class="token punctuation">;</span>    <span class="token comment">/**     * cronè¡¨è¾¾å¼     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"cron_expression"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> cronExpression<span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡çŠ¶æ€  0ï¼šæ­£å¸¸  1ï¼šæš‚åœ     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"`status`"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Byte</span> status<span class="token punctuation">;</span>    <span class="token comment">/**     * å¤‡æ³¨     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"remark"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> remark<span class="token punctuation">;</span>    <span class="token comment">/**     * åˆ›å»ºæ—¶é—´     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"create_time"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createTime<span class="token punctuation">;</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"job_name"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> jobName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»è¦æœ‰</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¥å¿—Bean"><a href="#å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¥å¿—Bean" class="headerlink" title="å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¥å¿—Bean"></a>å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¥å¿—Bean</h2><p>ä¸»è¦å°±æ˜¯è®°å½•ä¸€ä¸‹æ—¥å¿—ï¼Œå¯æ ¹æ®è‡ªå·±éœ€æ±‚ï¼Œè‡ªè¡Œæ‰©å±•ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>qluiserver<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/**    * å®šæ—¶ä»»åŠ¡æ—¥å¿—    */</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"schedule_log"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleLog</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * ä»»åŠ¡æ—¥å¿—id     */</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>INPUT<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡id     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"job_id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> jobId<span class="token punctuation">;</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"job_name"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> jobName<span class="token punctuation">;</span>    <span class="token comment">/**     * å‚æ•°     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"params"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> params<span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡çŠ¶æ€    0ï¼šæˆåŠŸ    1ï¼šå¤±è´¥     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"`status`"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> status<span class="token punctuation">;</span>    <span class="token comment">/**     * å¤±è´¥ä¿¡æ¯     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"error"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> error<span class="token punctuation">;</span>    <span class="token comment">/**     * è€—æ—¶(å•ä½ï¼šæ¯«ç§’)     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"times"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> times<span class="token punctuation">;</span>    <span class="token comment">/**     * åˆ›å»ºæ—¶é—´     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"create_time"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createTime<span class="token punctuation">;</span>    <span class="token comment">/**     * spring beanåç§°     */</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"bean_name"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> beanName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„ä¸Šä¸‹æ–‡"><a href="#æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„ä¸Šä¸‹æ–‡" class="headerlink" title="æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„ä¸Šä¸‹æ–‡"></a>æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„ä¸Šä¸‹æ–‡</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * Describe: å®šæ—¶ä»»åŠ¡æ‰§è¡Œä¸Šä¸‹æ–‡ * Author: å°±å…ä»ªå¼ * CreateTime: 2019/10/23 * */</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleContext</span> <span class="token keyword">extends</span> <span class="token class-name">QuartzJobBean</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * Describe: æ‰§è¡Œä»»åŠ¡å¹¶è®°å½•æ—¥å¿—     * Param: JobExecutionContext     * Return: æ— è¿”å›å€¼     * */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">executeInternal</span><span class="token punctuation">(</span><span class="token class-name">JobExecutionContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> o <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getMergedJobDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">.</span>JOB_PARAM_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleJob</span> jobBean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>        <span class="token class-name">ScheduleLogService</span> scheduleJobLogService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ScheduleLogService</span><span class="token punctuation">)</span> <span class="token class-name">SpringUtil</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"scheduleLogService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleLog</span> logBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScheduleLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">IdWorker</span><span class="token punctuation">.</span><span class="token function">getIdStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setJobId</span><span class="token punctuation">(</span>jobBean<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setJobName</span><span class="token punctuation">(</span>jobBean<span class="token punctuation">.</span><span class="token function">getJobName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setBeanName</span><span class="token punctuation">(</span>jobBean<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setParams</span><span class="token punctuation">(</span>jobBean<span class="token punctuation">.</span><span class="token function">getParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logBean<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> beginTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Object</span> target <span class="token operator">=</span> <span class="token class-name">SpringUtil</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>jobBean<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> method <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"run"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> jobBean<span class="token punctuation">.</span><span class="token function">getParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">long</span> executeTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> beginTime<span class="token punctuation">;</span>            logBean<span class="token punctuation">.</span><span class="token function">setTimes</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> executeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>            logBean<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å®šæ—¶å™¨ === >> "</span> <span class="token operator">+</span> jobBean<span class="token punctuation">.</span><span class="token function">getJobName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"æ‰§è¡ŒæˆåŠŸ,è€—æ—¶ === >> "</span> <span class="token operator">+</span> executeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">long</span> executeTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> beginTime<span class="token punctuation">;</span>            logBean<span class="token punctuation">.</span><span class="token function">setTimes</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>executeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>            logBean<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            logBean<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getCause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            e<span class="token punctuation">.</span><span class="token function">getCause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            scheduleJobLogService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>logBean<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®šæ—¶ä»»åŠ¡å¤„ç†å™¨"><a href="#å®šæ—¶ä»»åŠ¡å¤„ç†å™¨" class="headerlink" title="å®šæ—¶ä»»åŠ¡å¤„ç†å™¨"></a>å®šæ—¶ä»»åŠ¡å¤„ç†å™¨</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * Describe: å®šæ—¶ä»»åŠ¡å¤„ç†å™¨ * Author: å°±å…ä»ªå¼ * CreateTime: 2019/10/23 * */</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleHandler</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * å®šæ—¶ä»»åŠ¡æ ‡è¯† Key,     * */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SCHEDULE_NAME <span class="token operator">=</span> <span class="token string">"Ql_"</span> <span class="token punctuation">;</span>    <span class="token comment">/**     * è§¦å‘å™¨ KEY     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">TriggerKey</span> <span class="token function">getTriggerKey</span><span class="token punctuation">(</span><span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">TriggerKey</span><span class="token punctuation">.</span><span class="token function">triggerKey</span><span class="token punctuation">(</span>SCHEDULE_NAME <span class="token operator">+</span> jobId<span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * å®šæ—¶å™¨ Key     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JobKey</span> getJobKey <span class="token punctuation">(</span><span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">JobKey</span><span class="token punctuation">.</span><span class="token function">jobKey</span><span class="token punctuation">(</span>SCHEDULE_NAME<span class="token operator">+</span>jobId<span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è¡¨è¾¾å¼è§¦å‘å™¨     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CronTrigger</span> getCronTrigger <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">CronTrigger</span><span class="token punctuation">)</span>scheduler<span class="token punctuation">.</span><span class="token function">getTrigger</span><span class="token punctuation">(</span><span class="token function">getTriggerKey</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: åˆ›å»ºå®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> createJob <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">ScheduleJob</span> scheduleJob<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ„å»ºå®šæ—¶å™¨</span>            <span class="token class-name">JobDetail</span> jobDetail <span class="token operator">=</span> <span class="token class-name">JobBuilder</span><span class="token punctuation">.</span><span class="token function">newJob</span><span class="token punctuation">(</span><span class="token class-name">ScheduleContext</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withIdentity</span><span class="token punctuation">(</span><span class="token function">getJobKey</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>            <span class="token class-name">CronScheduleBuilder</span> scheduleBuilder <span class="token operator">=</span> <span class="token class-name">CronScheduleBuilder</span>                    <span class="token punctuation">.</span><span class="token function">cronSchedule</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getCronExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">withMisfireHandlingInstructionDoNothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>            <span class="token class-name">CronTrigger</span> trigger <span class="token operator">=</span> <span class="token class-name">TriggerBuilder</span><span class="token punctuation">.</span><span class="token function">newTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">withIdentity</span><span class="token punctuation">(</span><span class="token function">getTriggerKey</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">withSchedule</span><span class="token punctuation">(</span>scheduleBuilder<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            jobDetail<span class="token punctuation">.</span><span class="token function">getJobDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">.</span>JOB_PARAM_KEY<span class="token punctuation">,</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>            scheduler<span class="token punctuation">.</span><span class="token function">scheduleJob</span><span class="token punctuation">(</span>jobDetail<span class="token punctuation">,</span>trigger<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// å¦‚æœè¯¥å®šæ—¶å™¨å¤„äºæš‚åœçŠ¶æ€</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">pauseJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"createJob Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: æ›´æ–°å®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">updateJob</span><span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">ScheduleJob</span> scheduleJob<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">TriggerKey</span> triggerKey <span class="token operator">=</span> <span class="token function">getTriggerKey</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">CronScheduleBuilder</span> scheduleBuilder <span class="token operator">=</span> <span class="token class-name">CronScheduleBuilder</span><span class="token punctuation">.</span><span class="token function">cronSchedule</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getCronExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withMisfireHandlingInstructionDoNothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">CronTrigger</span> trigger <span class="token operator">=</span> <span class="token function">getCronTrigger</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">assert</span> trigger <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            trigger <span class="token operator">=</span> trigger<span class="token punctuation">.</span><span class="token function">getTriggerBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withIdentity</span><span class="token punctuation">(</span>triggerKey<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withSchedule</span><span class="token punctuation">(</span>scheduleBuilder<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            trigger<span class="token punctuation">.</span><span class="token function">getJobDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">.</span>JOB_PARAM_KEY<span class="token punctuation">,</span> scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>            scheduler<span class="token punctuation">.</span><span class="token function">rescheduleJob</span><span class="token punctuation">(</span>triggerKey<span class="token punctuation">,</span> trigger<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">pauseJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"updateJob Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: åœæ­¢å®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> pauseJob <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            scheduler<span class="token punctuation">.</span><span class="token function">pauseJob</span><span class="token punctuation">(</span><span class="token function">getJobKey</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"pauseJob Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: æ¢å¤å®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> resumeJob <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            scheduler<span class="token punctuation">.</span><span class="token function">resumeJob</span><span class="token punctuation">(</span><span class="token function">getJobKey</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"resumeJob Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: åˆ é™¤å®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> deleteJob <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span> jobId<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            scheduler<span class="token punctuation">.</span><span class="token function">deleteJob</span><span class="token punctuation">(</span><span class="token function">getJobKey</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"deleteJob Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Describe: æ‰§è¡Œå®šæ—¶ä»»åŠ¡     * Param: Scheduler ScheduleJobBean     * Return: null     * */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> run <span class="token punctuation">(</span><span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">,</span> <span class="token class-name">ScheduleJob</span> scheduleJob<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">JobDataMap</span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JobDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>            dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">.</span>JOB_PARAM_KEY<span class="token punctuation">,</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>            scheduler<span class="token punctuation">.</span><span class="token function">triggerJob</span><span class="token punctuation">(</span><span class="token function">getJobKey</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SchedulerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"run Fail"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤„ç†ç±»"><a href="#å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤„ç†ç±»" class="headerlink" title="å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤„ç†ç±»"></a>å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤„ç†ç±»</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * Describe: å®šæ—¶ä»»åŠ¡å¯åŠ¨å¤„ç†ç±» * Author: å°±çœ ä»ªå¼ * CreateTime: 2019/10/23 * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleStarted</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">Scheduler</span> scheduler <span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">ScheduleJobService</span> scheduleJobService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@PostConstruct</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> init <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ScheduleJob</span><span class="token punctuation">></span></span> scheduleJobList <span class="token operator">=</span> scheduleJobService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span> scheduleJob <span class="token operator">:</span> scheduleJobList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">CronTrigger</span> cronTrigger <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule<span class="token punctuation">.</span></span>ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">getCronTrigger</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cronTrigger <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule<span class="token punctuation">.</span></span>ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">createJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>schedule<span class="token punctuation">.</span></span>ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">updateJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Webæ¥å£"><a href="#Webæ¥å£" class="headerlink" title="Webæ¥å£"></a>Webæ¥å£</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduleController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">ScheduleJobService</span> jobService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">ScheduleLogService</span> logService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">Scheduler</span> scheduler<span class="token punctuation">;</span>            <span class="token comment">/**     * æ ¹æ®ä»»åŠ¡IDè¿è¡Œä¸€ä¸ªä»»åŠ¡     *     * @param id ä»»åŠ¡ID     * @return è¿è¡ŒçŠ¶æ€     */</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"task_run"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskRun</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ScheduleJob</span> job <span class="token operator">=</span> jobService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¿å­˜ä»»åŠ¡     *     * @param job ä»»åŠ¡å®ä½“     * @return ä¿å­˜ç»“æœ     */</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"task_save"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskSave</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span> job<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        job<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">IdWorker</span><span class="token punctuation">.</span><span class="token function">getIdStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        job<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jobService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">createJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ›´æ–°ä»»åŠ¡     *     * @param job ä»»åŠ¡æ•°æ®     * @return æ›´æ–°ç»“æœ     */</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"task_update"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskUpdate</span><span class="token punctuation">(</span><span class="token class-name">ScheduleJob</span> job<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        jobService<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">updateJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åœæ­¢å®šæ—¶ä»»åŠ¡     *     * @param id ä»»åŠ¡Id     * @return æ‰§è¡Œç»“æœ     */</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"task_pause"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskPause</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ScheduleJob</span> scheduleJob <span class="token operator">=</span> jobService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">pauseJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        scheduleJob<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jobService<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ¢å¤å®šæ—¶ä»»åŠ¡     *     * @param id ä»»åŠ¡Id     * @return æ‰§è¡Œç»“æœ     */</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"task_resume"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskResume</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ScheduleJob</span> scheduleJob <span class="token operator">=</span> jobService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">resumeJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        scheduleJob<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jobService<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>scheduleJob<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åˆ é™¤ä¸€ä¸ªä»»åŠ¡     *     * @param jobId ä»»åŠ¡ID     * @return åˆ é™¤ç»“æœ     */</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"task_del"</span><span class="token punctuation">)</span>    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">taskDel</span><span class="token punctuation">(</span><span class="token class-name">String</span> jobId<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ScheduleHandler</span><span class="token punctuation">.</span><span class="token function">deleteJob</span><span class="token punctuation">(</span>scheduler<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jobService<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span>jobId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å®šæ—¶ä»»åŠ¡ç±»"><a href="#å®šæ—¶ä»»åŠ¡ç±»" class="headerlink" title="å®šæ—¶ä»»åŠ¡ç±»"></a>å®šæ—¶ä»»åŠ¡ç±»</h2><h3 id="æ–°å¢æ¥å£æ¥å£BaseTaskService-java"><a href="#æ–°å¢æ¥å£æ¥å£BaseTaskService-java" class="headerlink" title="æ–°å¢æ¥å£æ¥å£BaseTaskService.java"></a>æ–°å¢æ¥å£æ¥å£BaseTaskService.java</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>task<span class="token punctuation">.</span>base</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseTaskService</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * ä»» åŠ¡ å® ç°     * */</span>    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span> params<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é€šç”¨å®šæ—¶ä»»åŠ¡"><a href="#é€šç”¨å®šæ—¶ä»»åŠ¡" class="headerlink" title="é€šç”¨å®šæ—¶ä»»åŠ¡"></a>é€šç”¨å®šæ—¶ä»»åŠ¡</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>task</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * Describe: ç¤ºä¾‹ä»»åŠ¡ * Author: å°±å…ä»ªå¼ * CreateTime: 2019/10/23 * */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">"commonTask"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonTaskImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BaseTaskService</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">SimpleDateFormat</span> FORMAT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡å®ç°     * */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span> params<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Params === >> "</span> <span class="token operator">+</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´::::"</span> <span class="token operator">+</span> FORMAT<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡ŒæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å¼‚å¸¸çš„å®šæ—¶ä»»åŠ¡"><a href="#å¼‚å¸¸çš„å®šæ—¶ä»»åŠ¡" class="headerlink" title="å¼‚å¸¸çš„å®šæ—¶ä»»åŠ¡"></a>å¼‚å¸¸çš„å®šæ—¶ä»»åŠ¡</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wangijun<span class="token punctuation">.</span>springbootdemo<span class="token punctuation">.</span>task</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">/** * Describe: ç¤ºä¾‹ä»»åŠ¡ * Author: å°±å…ä»ªå¼ * CreateTime: 2019/10/23 * å¼‚å¸¸ä»»åŠ¡ * */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">"exceptionTask"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExceptionTaskImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BaseTaskService</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">SimpleDateFormat</span> FORMAT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token comment">/**     * ä»»åŠ¡å®ç°     * */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span> params<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´::::"</span> <span class="token operator">+</span> FORMAT<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"å‘ç”Ÿå¼‚å¸¸"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>å»ºè¡¨è¯­å¥ä»¥åŠæµ‹è¯•é¡¹ç›®æºç ï¼Œmock.httpæ–‡ä»¶ä¸­é‡Œé¢æœ‰æµ‹è¯•æ•°æ®ï¼ŒIDEAå¯ä»¥å¾ˆæ–¹ä¾¿çš„æµ‹è¯•ã€‚</p><p><a href="https://gitee.com/wlf213/springboot-quartz">æºç </a></p><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tvax1.sinaimg.cn/large/005NNTS5ly1gwp89wm2nwj33n61o0x6q.jpg" alt="æ–°ç’ƒæœˆç©ºæ¸¯"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>quartz</tag>
      
      <tag>springboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue3+TS+SetUp</title>
    <link href="/2021/11/19/vue-02/"/>
    <url>/2021/11/19/vue-02/</url>
    
    <content type="html"><![CDATA[<p>å¯¹Vueä¹Ÿç®—æ¯”è¾ƒç†Ÿæ‚‰ï¼Œç†Ÿæ‚‰çš„åŸå› å¾ˆç®€å•ï¼Œä¸‰å¤§å‰ç«¯æ¡†æ¶ï¼Œåªæœ‰Vueçš„å®˜æ–¹æ–‡æ¡£ä¸­æ–‡æœ€å…¨ã€‚åˆšè¿›å…¥å·¥ä½œæ—¶ç”¨è¿‡Vue2,è¿˜æ˜¯å†…åµŒåˆ°HTMLé‡Œé¢çš„å½¢å¼ï¼Œlowæ˜¯lowäº†ç‚¹ï¼Œå¥½å¤„å°±æ˜¯å½“æ—¶ç”¨(å­¦)èµ·æ¥æœ‰æ²¡æœ‰ä»€ä¹ˆè´Ÿæ‹…ï¼Œå·¥ä½œé‡Œçš„å®è·µï¼Œé—²æš‡ä¸­é˜…è¯»æ–‡æ¡£ï¼Œå‘¨æœ«å¤§è‡´çœ‹çœ‹è§†é¢‘ï¼Œåˆ°ä¹Ÿä¸éš¾ç†è§£ï¼Œä¸»è¦å®˜æ–¹çš„ä¸­æ–‡æ–‡æ¡£å¾ˆè¯¦ç»†äº†ï¼Œåªè¦ä½ è€å¾—ä½æ€§å­å»çœ‹ï¼Œå»å­¦ã€‚</p><p>Vue3å‡ºæ¥ä¹ŸæŒºé•¿æ—¶é—´äº†ï¼Œåœ¨Vueï¼“çš„æ–‡æ¡£è¿˜æ²¡æœ‰ä¸­æ–‡ç¿»è¯‘çš„æ—¶å€™æˆ‘å°±å»çœ‹äº†ï¼Œå½“æ—¶å¯¹Vueè¿™ä¸œè¥¿ç†è§£å°šæµ…ï¼ŒåŠ ä¸Šä¸€äº›çäº‹ï¼Œæ²¡æ—¶é—´å»å­¦ï¼Œå­¦ä¸åŠ¨äº†ï¼ŒçœŸçš„å­¦ä¸åŠ¨äº†ã€‚ä¸æ€ä¹ˆå¿™çš„æ—¶é—´é‡Œï¼Œæˆ‘äºæ˜¯é™ä¸‹å¿ƒæ¥äº†è§£äº†ä¸€ä¸‹ã€‚</p><p>è¯´å‡çº§ï¼Œå¯¹äºä½¿ç”¨è€…æ¥è¯´ï¼Œæ— å¤–ä¹åºŸå¼ƒäº†ä¸€äº›APIï¼Œå†™æ³•ä¸Šå¤šäº†äº›é€‰æ‹©ï¼Œè‡³äºæ€§èƒ½æå‡ï¼Œä»£ç ä¼˜åŒ–ï¼Œè¿™äº›ä¸œè¥¿æˆ‘ä»¬å¹¶ä¸å¤ªéœ€è¦çŸ¥é“ã€‚Vueä¹‹æ‰€ä»¥ä¿ç•™æ—§ç‰ˆçš„å†™æ³•ï¼Œå®Œå…¨æ˜¯ä¸ºäº†ç…§é¡¾æ—§ç‰ˆæœ¬ï¼Œè®©ä½¿ç”¨è€…å°±ç®—æ‰“ç®—å‡çº§ä¹Ÿå¯ä»¥æ›´å¹³æ»‘çš„å‡çº§ã€‚è¿™å¯¹äºå‰ç«¯æ¡†æ¶æ¥è¯´éå¸¸éš¾å¾—ï¼Œæ­¤å¤„ç‚¹å@angular, å®Œå…¨ä¸ç®¡æ—§ç‰ˆæœ¬çš„æ­»æ´»ã€‚</p><p>å°¤å¤§å®˜æ–¹ä¹Ÿè¯´ï¼Œä¸å»ºè®®ä½¿ç”¨æ—§ç‰ˆçš„è¯­æ³•ï¼Œæ¨èä½¿ç”¨ç»„åˆå¼APIï¼Œé‚£å°±è¯•è¯•å»ç†è§£å­¦ä¹ ç»„åˆå¼APIã€‚å¯¹äºä¼šVue2çš„æ¥è¯´ç†è§£æœ€é‡è¦çš„ï¼Œå‡çº§çš„åº•å±‚æ ¸å¿ƒæˆ‘ä»¬è§¦ç¢°ä¸åˆ°ï¼Œä¹Ÿä¸éœ€è¦è§¦ç¢°åˆ°ï¼Œç†è§£Vue2çš„ç—›ç‚¹ï¼Œä»¥åŠç¼ºé™·ï¼Œå†å»ç†è§£Vue3æ–°è¯­æ³•è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œè¿™ä¸ªæ˜¯ç›®å‰ä¸»è¦éœ€è¦åšçš„äº‹ã€‚</p><p>Vue3ç®€å•çš„è¯´å°±æ˜¯æŠŠVue2ä¸­åˆ†çš„é›¶é›¶ç¢ç¢çš„ä»£ç æ”¾åœ¨äº†ä¸€èµ·ï¼Œé¦–å…ˆæˆ‘ä»¬å›æƒ³Vue2ä¸­æœ‰å“ªå‡ å—ä»£ç ï¼Œdata (å“åº”å¼çš„å±æ€§) methods (åŸºæœ¬çš„ä»£ç é€»è¾‘)è®¡ç®—å±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªç›‘å¬å±æ€§ï¼Œç”Ÿå‘½å‘¨æœŸå…ˆä¸è€ƒè™‘ï¼Œå°¤å¤§è®¤ä¸ºè¿™ç§å†™æ³•é€»è¾‘å¤ªè¿‡åˆ†æ•£ï¼Œä¸€ä¸ªæ•°æ®å¯èƒ½éœ€è¦è¦ç»è¿‡ä¸‰åˆ°å››ä¸ªä¸åŒçš„åœ°æ–¹,è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦åœ¨ä¸åŒçš„å—ä¸­æ‰¾ä»£ç ï¼Œè¿™ä¸ªä¸€ä¸ªå—é‡Œä¸Šç™¾è¡Œä»£ç æ˜¯éå¸¸å¸¸è§çš„ã€‚éœ€è¦è·³æ¥è·³å»çš„çœ‹ä»£ç ï¼Œå®¹æ˜“é€ æˆå…³æ³¨ç‚¹æ··ä¹±ã€‚</p><p>ç»„åˆå¼å†™æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œè€Œä¸”ç»„åˆå¼çš„æ–¹å‘å¯¹äº†ï¼Œæ²¡å†™è¿‡React,æ®è¯´æ˜¯å¾ˆåƒï¼Œç®€å•çš„ä¸€ç‚¹ç»„åˆå¼ä»£ç æç¤ºä¼šæ›´å‹å¥½ï¼Œæ˜çœ¼äººä¸€çœ‹ï¼Œèµ·ç ç»™IDEçš„è®¡ç®—è´Ÿæ‹…å‡ä½ä¸å°‘ã€‚ä¸ç®¡æ˜¯JSè¿˜æ˜¯TSã€‚é‚£ä¹ˆå­¦ä¹ ç»„åˆå¼éœ€è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Œä¸è¦æŠŠå®ƒæƒ³çš„å¾ˆéš¾,ä»€ä¹ˆç®€ç›´éƒ½éœ€è¦é‡å­¦ï¼Œå®é™…ä¸Šå°±æ˜¯æ¢äº†ä¸€ç§å†™æ³•ï¼Œå®šä¹‰dataå˜æˆäº†refä»¥åŠreactive,åŠ ä¸Šä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„è¯­æ³•ç³–ï¼Œå®šä¹‰methods,ç›´æ¥å®šä¹‰å‡½æ•°å°±è¡Œäº†ï¼Œç›‘å¬å±æ€§ï¼Œè®¡ç®—å±æ€§ï¼Œéƒ½æœ‰å¯¹åº”çš„å†™æ³•ï¼Œç”Ÿå‘½å‘¨æœŸéšä¾¿å†çœ‹çœ‹ã€‚Vue3å†…åµŒHtmlçš„ç”¨æ³•å°±è¿™äº›ã€‚ç»„ä»¶åŒ–æ—¶åŠ äº†ä¸¤ä¸ªä¸œè¥¿ä¸€ä¸ªpropsä»¥åŠè‡ªå®šä¹‰äº‹ä»¶( emit), è¿™ä¸¤ä¸ªä¸œè¥¿æ²¡æ€ä¹ˆå˜ï¼Œè‡³å°‘åŸºäºJSæ¥è¯´ã€‚å¯¹äºTSè¿™ä¸¤ä¸ªå˜åŒ–ç•¥å¤šï¼Œå¯ä»¥è¯´ä¸€ç§å†™æ³•ä¸€ç§å®šä¹‰æˆ–è€…å£°æ˜æ–¹å¼ï¼Œä¸»è¦è¿˜æ˜¯è¿™ä¸¤ä¸ªä¸œè¥¿å†å²åŒ…è¢±è¿‡é‡ã€‚</p><p>Vue3æ®æˆ‘ç›®å‰æ‰€äº†è§£çš„ï¼Œç®—ä¸Šæ—§ç‰ˆæœ¬çš„å†™æ³•ï¼Œè¿™ç§å†™æ³•ä¸é…æ‹¥æœ‰å§“åï¼Œæ‰€ä»¥åªèƒ½ç§°ä¹‹ä¸ºæ—§ç‰ˆæœ¬å†™æ³•ï¼Œç®—ä¸Šæ—§ç‰ˆæœ¬çš„å†™æ³•æœ‰å››ç§äº†ã€‚å¾ˆå¤šå•Šï¼Œæˆ‘æ²¡æœ‰å…´è¶£å»ç ”ç©¶é‚£ä¹ˆå¤šï¼ŒåŸºäºç›®å‰æ¥çœ‹ï¼Œ<code>&lt;script setup &gt;</code>è¿™ç§å†™æ³•åº”è¯¥æ˜¯æœ€ä¼˜é›…çš„ï¼Œå°¤å¤§å®˜æ–¹å¾®åšä¹Ÿè¯´äº†ï¼ŒVue3 + TS+ setup + Volar &#x3D; çœŸé¦™ã€‚ä¸‹é¢ä¸»è¦ä»£ç ä»‹ç»è¿™ç§å†™æ³•ã€‚</p><p>è¿™ç§å†™æ³•ä¸èƒ½ä½¿ç”¨HTMLæ¥å†™ï¼Œåªèƒ½ä½¿ç”¨å•æ–‡ä»¶æ–¹å¼æ¥å†™ï¼Œä¸»è¦çœ‹å†™æ³•</p><h3 id="ç»„ä»¶HelloWord"><a href="#ç»„ä»¶HelloWord" class="headerlink" title="ç»„ä»¶HelloWord"></a>ç»„ä»¶HelloWord</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hello<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>&#123;&#123; msg &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visible<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ˜¯å¦æ˜¾ç¤º &#123;&#123; visible &#125;&#125; sumcom = &#123;&#123; sumcom &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç‚¹å‡»æŠ›å‡ºäº‹ä»¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> watch<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> toRefs <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span><span class="token comment">// props,åªå£°æ˜ç±»å‹æ—¶çš„å†™æ³•</span><span class="token keyword">const</span> props <span class="token operator">=</span> defineProps<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span>  <span class="token literal-property property">msg</span><span class="token operator">:</span> string  <span class="token literal-property property">visible</span><span class="token operator">:</span> boolean<span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// propsæœ‰é»˜è®¤å€¼æ—¶çš„å†™æ³•</span><span class="token comment">/* interface Props &#123;  msg?: string  labels?: string[]&#125;const props = withDefaults(defineProps&lt;Props>(), &#123;  msg: 'hello',  labels: () => ['one', 'two']&#125;) */</span><span class="token comment">// end propsæœ‰é»˜è®¤å€¼æ—¶çš„å†™æ³•</span><span class="token comment">// è‡ªå®šä¹‰äº‹ä»¶,è¿™ç§å†™æ³•ä»£ç æç¤ºååˆ†å‹å¥½ï¼Œä¸”åœ¨ä½¿ç”¨ç»„ä»¶æ—¶çš„ä»£ç æç¤ºä¹Ÿååˆ†å‹å¥½</span><span class="token keyword">const</span> emit <span class="token operator">=</span> defineEmits<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span>  <span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token literal-property property">id</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>  <span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// å®šä¹‰ä¸€ä¸ªæ™®æ™®é€šé€šæ–¹æ³•</span><span class="token keyword">const</span> <span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token comment">// æŠ›å‡ºè‡ªå®šä¹‰äº‹ä»¶ï¼Œè¿™é‡Œçš„ä»£ç æç¤ºååˆ†å‹å¥½ï¼Œ</span>  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token string">'ä»å‰ä»å‰'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// å“åº”å¼</span><span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token comment">// è®¡ç®—å±æ€§</span><span class="token keyword">const</span> sumcom <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token parameter">number</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> sum<span class="token punctuation">.</span>value <span class="token operator">*</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// ç›‘å¬</span><span class="token function">watch</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal <span class="token operator">+</span> <span class="token string">"----"</span> <span class="token operator">+</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  <span class="token comment">// å¯¼å‡ºç»„ä»¶å†…çš„ä¸œè¥¿ï¼Œç»™ç»„ä»¶å¤–éƒ¨è®¿é—®ï¼Œçˆ¶ç»„ä»¶éœ€è¦è®¿é—®å­ç»„ä»¶å†…æ•°æ®æ—¶ï¼Œéœ€è¦å¯¼å‡ºï¼Œä¹Ÿå¯ä»¥å¯¼å‡ºå‡½æ•°ï¼Œ</span>  sum<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ç»„ä»¶APP"><a href="#ç»„ä»¶APP" class="headerlink" title="ç»„ä»¶APP"></a>ç»„ä»¶APP</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Vue logo<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./assets/logo.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HelloWorld</span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ¬¢è¿æ¥åˆ°ä½ çš„VUe+TSé¡¹ç›®<span class="token punctuation">"</span></span> <span class="token attr-name">:visible</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flag<span class="token punctuation">"</span></span> <span class="token attr-name">@update</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>upd<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>model<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@vue/reactivity'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@vue/runtime-core'</span><span class="token punctuation">;</span><span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">'./components/HelloWorld.vue'</span><span class="token punctuation">;</span><span class="token keyword">const</span> flag <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token keyword">const</span> upd <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token parameter"><span class="token keyword">void</span></span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>  flag<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>flag<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span><span class="token comment">// æš‚æ—¶åªèƒ½è¿™æ ·ï¼Œå®é™…ä¸Šä¸æŠ¥é”™ï¼Œä½†æ˜¯TSè¯­æ³•ä¼šæŠ¥é”™ï¼Œåªèƒ½è¿™æ ·å®šä¹‰äº†ã€‚</span><span class="token keyword">interface</span> <span class="token class-name">expHello</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">sum</span><span class="token operator">:</span> number<span class="token punctuation">&#125;</span><span class="token comment">// å¯¹åº”å­ç»„ä»¶</span><span class="token keyword">const</span> model <span class="token operator">=</span> ref<span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> HelloWorld<span class="token operator">></span> <span class="token operator">&amp;</span> expHello<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token comment">// è®¿é—®å­ç»„ä»¶é‡Œçš„å±æ€§</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>value<span class="token operator">?.</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><span class="token selector">#app</span> <span class="token punctuation">&#123;</span>  <span class="token property">font-family</span><span class="token punctuation">:</span> Avenir<span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>  <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>  <span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale<span class="token punctuation">;</span>  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>  <span class="token property">color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>  <span class="token property">margin-top</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1gwo8dswfcpj34mo334e86.jpg" alt="ç»¿è‰²çš„å¿ƒ"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>typescipt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éƒ­å¾·çº²å†™ç»™å„¿å­éƒ­éº’éºŸçš„ä¿¡</title>
    <link href="/2021/11/08/other-04/"/>
    <url>/2021/11/08/other-04/</url>
    
    <content type="html"><![CDATA[<p>ç”²åˆå¹´ï¼Œæ­£æœˆåˆä¹ï¼Œæˆ‘å„¿å­åå…«äº†ï¼Œæ­£æ‰€è°“æˆäººé•¿å¤§ï¼Œå­¦åå¥‡ä¸´ï¼Œå–å¥‡å¦™é™ä¸´ä¹‹æ„ï¼Œåä¸‹æµ·ï¼Œè‰ºåéº’éºŸï¼Œä¹ƒä»¿å‘¨å¤§å¸ˆä¹‹é—éŸµã€‚</p><p>äººç”Ÿä¸€ä¸–ï¼Œæä¸å®¹æ˜“ï¼Œç™»å¤©éš¾ï¼Œæ±‚äººæ›´éš¾ï¼Œé»„è¿è‹¦ï¼Œæ— é’±æ›´è‹¦ï¼Œæ±Ÿæ¹–é™©ï¼Œäººå¿ƒæ›´é™©ï¼Œæ˜¥å†°è–„ï¼Œäººæƒ…æ›´è–„ã€‚è¿‡å»æœ‰å¥è¯ï¼Œæ—¢è½æ±Ÿæ¹–å†…ï¼Œä¾¿æ˜¯è–„å‘½äººã€‚æˆ‘æœ¬ä¸æ„¿å„¿ä»è‰ºï¼Œå¥ˆä½•äººè‡ªæœ‰å¿—æ— æ³•æ¨ªæ‹¦ï¼Œä½†æœ‰å‡ å¥è¯è¦è¯´æ¸…æ¥šã€‚è‰ºäººåˆ†å‡ ç±»ï¼Œç§ç§ç›¸éš”ï¼Œä¸€æ˜¯æ™®é€šè‰ºäººï¼Œæœ‰ä¸€æŠ€ä¹‹é•¿ï¼Œå‡­èƒ½è€åƒé¥­ï¼Œä¸€æ˜¯åæ¼”å‘˜ï¼ŒçŸ¥ååº¦é«˜ï¼Œä½†ä¸ä»£è¡¨è‰ºæœ¯é«˜ã€‚æ­¤ç±»è¿˜è¦ä¸¤è¯´ï¼Œä¸€æ˜¯è§’å„¿ï¼Œä½•ä¸ºè§’å„¿ï¼Œèˆå°ä¸Šçš„é¡¶æ¢æŸ±ï¼Œå‰§å›¢ç­ç¤¾çš„çµé­‚ï¼Œè´´å‡ºä½ çš„åå­—è¦ä¿è¯å–çš„å‡ºç¥¨ï¼Œå…¨å›¢è€å°‘æŒ‡ç€ä½ åƒé¥­ï¼Œè§’å„¿æ˜¯æœ‰è´£ä»»çš„è‰ºäººã€‚</p><p>éƒ­éº’éºŸåˆšåå…«ï¼Œæˆ‘ä¸å¸Œæœ›å„¿å­å¤§çº¢ï¼Œäººçº¢éº»çƒ¦å¤šï¼Œä¸€å¤§ä¸‰å¤§ï¼Œåæ°”å¤§åï¼Œå¼€é”€å¤§å‹åŠ›å¤§æ˜¯éå¤§ï¼Œçº¢èµ·æ¥å®¹æ˜“ï¼Œéš¾çš„æ˜¯æ¥ä½è‡ªå·±ã€‚å¹´ä¸‰ååƒé¡¿é¥ºå­å®¹æ˜“ï¼Œä¹‹åå‘¢ï¼Ÿå¾—å¤©å¤©åƒé¥ºå­æ‰è¡Œå•Šã€‚å¯ä½ æœ‰é‚£ä¹ˆå¤šé¢å’Œé¦…å„¿å—ï¼Ÿæ‰€ä»¥ï¼Œè¦å¤šä¸‹åŠŸå¤«ï¼Œå¹¶ä¸”è¦ä¿æŒä¸€ä¸ªå¥½çš„å¿ƒæ€ï¼Œå¾ˆå¤šäººä¸æˆåŠŸçš„åŸå› ï¼Œä¸»è¦æ˜¯å¤ªå°Šé‡è‡ªå·±äº†ã€‚</p><p>ä¸€ä¸ªäººåˆšå‡ºé“ï¼Œä¸ç‹‚ï¼Œæ²¡å‡ºæ¯ï¼Œä½†å¦‚æœä¸€ç›´ç‹‚æ˜¯è‚¯å®šæ²¡æœ‰å‡ºæ¯çš„ã€‚ä½ çœ¼ä¸­çš„ä½ å’Œåˆ«äººçœ¼ä¸­çš„ä½ ä¸æ˜¯ä¸€å›äº‹ï¼Œæ— é™èµç¾è‡ªå·±åªæ˜¯ä¸€ç§èƒ†æ€¯ã€‚æˆ‘ä¸€ç›´è®¤ä¸ºææƒ§åˆ°å¤´å°±æ˜¯æ„¤æ€’ï¼Œå‘æŒ¥æ— æ•Œæƒ³è±¡ï¼Œç»™è‡ªå·±æç»˜äº†ä¸€ä¸ªç«¥è¯ä¸–ç•Œï¼Œç™½è¡£å¦‚é›ªæ¥å»å¦‚é£ï¼Œåˆ€å…‰å‰‘å½±é—ªè¿‡ä¹‹åï¼Œä½ æ»¡è„¸å†·é…·ç‹¬ç«‹äºç å³°é¡¶ç«¯ï¼Œå‚²è§†è‹ç”Ÿæ— æ¯”è‹±æ­¦ï¼Œæ­¤æ—¶æˆ‘è¦é—®çš„æ˜¯ï¼šå­©å­ï¼Œä½ æ€ä¹ˆä¸‹å»ï¼Ÿ</p><p>ä¸è®©å¤äººï¼Œæ˜¯è°“æœ‰å¿—ï¼Œä¸è®©ä»Šäººï¼Œæ˜¯è°“æ— è‰¯ã€‚è®°ä½äº†ï¼Œå°ä¿—ä¾¿é›…ï¼Œå¤§é›…åˆ™ä¿—ã€‚</p><p>æœ‰äººå¤¸ä½ ï¼Œåˆ«ä¿¡ï¼Œæœ‰äººéª‚ä½ ï¼Œåˆ«å¬ã€‚</p><p>å‘¨å›´äººéšæ„æ§éª‚ï¼Œä¸å¯ä¸ä¹‹äº¤ï¼Œå› å…¶æ— è‡³æ€§ä¹Ÿã€‚è®°ä½ï¼Œè¨€è¯­å¤šåå¤ï¼Œä»¥é˜²æ¬ºè¯ˆï¼Œå¿˜æ©æ€å°è¿‡ï¼Œå®šä¼šåæˆˆã€‚å¼€å£è¯´å¤§ä¹‰ï¼Œä¸´å¤§éš¾å¿…å˜èŠ‚ã€‚é€¢äººç§°å…„å¼Ÿï¼Œå³æ·±äº¤ä¹Ÿå¹³å¸¸ã€‚</p><p>æ­¤å¤–å‡¡äº‹è¦æ…é‡ã€‚æ±Ÿæ¹–å­å¼Ÿï¼Œæ‹¿å¾—èµ·æ¥æ”¾å¾—ä¸‹ï¼Œèº«è¾¹äººå¾ˆé‡è¦ã€‚ä¸€æ ¹ç¨»è‰ï¼Œæ‰”åˆ°è¡—ä¸Šå°±æ˜¯åƒåœ¾ï¼Œæ†ä¸Šç™½èœå°±æ˜¯ç™½èœä»·ï¼Œæ†ä¸Šå¤§é—¸èŸ¹å°±æ˜¯å¤§é—¸èŸ¹ä»·ã€‚åŒ…æ‹¬è„šä¸‹è¿™ä¸ªå¹³å°ä¹Ÿæé‡è¦ã€‚åŒæ ·æ˜¯ä¸€ä¸ªäººï¼Œæ­¥è¡Œä¸€å°æ—¶ä½ èƒ½èµ°å¤šè¿œï¼Ÿéª‘è½¦å‘¢ï¼Ÿå¼€è½¦å‘¢ï¼Ÿåé£æœºå‘¢ï¼Ÿå¹³å°ä¼šå†³å®šä½ çš„é€Ÿåº¦ã€‚ä¸”è®°ä¸”è®°ã€‚</p><p>æ­¤å¤–é’±è´¢è¦çæƒœã€‚ä½†ä¸å¯çœ‹å¾—å¤ªé‡ã€‚è´¢ä¹ƒå¤©åœ°è‡³å…¬ä¹‹ç‰©ï¼Œå‡æ‰‹äºäººç½¢äº†ï¼Œé›¨æ‰“æ®‹èŠ±é£å·æµäº‘ï¼Œè½®ç•ªæ›´è½¬è€Œå·²ã€‚ç©·è½¬å¯Œï¼Œå¯Œè½¬ç©·ï¼Œå“ªæœ‰ç™¾ä¸–å¯Œå®¶ç¿ã€‚</p><p>è‡³äºäº¤å‹ï¼Œåƒç‚¹äºä¹Ÿæ— å¦¨ï¼Œäººæ²¡æ‰€è°“ï¼Œç©·é€šå¯¿å¤­ä¸ºå‘½æ‰€ç³»ï¼Œå²‚ä¸çŸ¥é€ ç‰©ä¹‹æŠ¥æ–½ã€‚å…¨è§†äººä¹‹è‡ªå–ï¼ŒèŠ¸èŠ¸ä¼—ç”Ÿå¯Œè´µè´«å¯’ï¼Œä¸æ˜¯è°éƒ½å¯ä»¥å‚²ä¸–ä¹¾å¤çš„ï¼Œå…¶ä¸­æœ‰å‘½æœ‰è¿ã€‚è¦çŸ¥å› æœæ‡‚å–„æ¶,æˆ‘å„¿ä¸”è®°, ä½†è¡Œå¥½äº‹ ï¼Œè«é—®å‰ç¨‹ã€‚</p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax1.sinaimg.cn/large/005NNTS5ly1gw7jy4zpuwj32yo1o0u0x.jpg" alt="åˆ»æ™´cosåŸç¥"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springbootäº‹åŠ¡ä¸‰ä¸¤è¨€</title>
    <link href="/2021/11/01/java-04/"/>
    <url>/2021/11/01/java-04/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>ç»å†æ˜¯ä¼šæ½œç§»é»˜åŒ–æ”¹å˜äººçš„ï¼Œè¿è‡ªå·±éƒ½ä¸çŸ¥é“ï¼Œè¿˜ä»¥ä¸ºè‡ªå·±å†…å¿ƒæ°¸è¿œå•çº¯ã€‚</p>          </div><p>èŠäº‹åŠ¡ï¼Œå…ˆæ˜ç™½ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Œä¸¾ä¸ªçƒ‚å¤§è¡—çš„ä¾‹å­ï¼Œé“¶è¡Œè½¬è´¦ï¼Œè½¬å‡ºæ–¹å‡é’±ï¼Œè½¬å…¥æ–¹åŠ é’±ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¯ä¸å…è®¸å…¶ä¸­ä¸€ä¸ªç¯èŠ‚å•ç‹¬å¤±è´¥çš„ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µåˆå¿…é¡»æ‰§è¡Œä¸¤æ¬¡ä»¥ä¸Šçš„æ•°æ®åº“æ“ä½œè¯­å¥ï¼Œä¿è¯è¯­å¥æ‰§è¡Œç»“æœçš„ä¸€è‡´æ€§åŠŸèƒ½å°±æ˜¯äº‹åŠ¡åŠŸèƒ½ã€‚</p><p>ç°åœ¨çš„å…³ç³»å‹æ•°æ®åº“å¤§å¤šéƒ½æ”¯æŒäº‹åŠ¡æ§åˆ¶ï¼Œäº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼Œæˆ‘è¿˜çœŸè®°ä¸å¤ªæ¸…ï¼ŒåŸå­æ€§ï¼Œéš”ç¦»æ€§ï¼Œä¸€è‡´æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯ä»€ä¹ˆæ¥ç€ï¼Œæˆ‘æŸ¥æŸ¥ï¼ŒæŸ¥åˆ°äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªæŒä¹…æ€§ã€‚æŒä¹…æ€§æ²¡å•¥å¥½è¯´çš„ï¼Œæˆ‘å°±è®°ä¸ä½ã€‚åŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œè¿™ä¸ªéƒ½å¥½ç†è§£ï¼Œå°±æ˜¯éƒ½æˆåŠŸæˆ–è€…éƒ½å¤±è´¥ã€‚éš”ç¦»æ€§ï¼Œè¿™ä¸ªå°±éœ€è¦æ³¨æ„ä¸€ç‚¹ã€‚å…·ä½“æƒ…å†µå…·ä½“å¤„ç†ã€‚ç†è®ºçŸ¥è¯†å°±ä¸èµ˜è¿°äº†ã€‚</p><p>æ¥ä¸‹æ¥è¿›å…¥ä¸‹ä¸€è¯é¢˜ï¼Œã€Šæ¯çŒªçš„äº§åæŠ¤ç†ã€‹ï¼Œå¯¹ä¸èµ·ï¼Œæ‹¿é”™ä¹¦äº†ï¼Œ</p><p>ä»‹ç»ä¸€ä¸‹springæä¾›çš„äº‹åŠ¡æ§åˆ¶ï¼Œåˆ†ä¸ºç¼–ç¨‹å¼å’Œå£°æ˜å¼ï¼Œå…ˆè¯´æˆ‘ä»¬ç”¨çš„å¤šçš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶ï¼Œä¸”ä¸å»ºè®®ä½¿ç”¨ç¼–ç¨‹å¼çš„äº‹åŠ¡æ§åˆ¶ï¼Œspringboot2.5.xç³»åˆ—é»˜è®¤å°±å¼€å¯äº†æ³¨è§£å¼äº‹åŠ¡æ§åˆ¶ï¼Œåªéœ€è¦åœ¨ç±»ä¸Šæˆ–æ–¹æ³•ä¸ŠåŠ ä¸Š<code>@Transactional</code>æ³¨è§£å°±å¯ä»¥äº†ï¼ŒåŠ åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºæ­¤ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½æ·»åŠ äº†é»˜è®¤çš„äº‹åŠ¡æ”¯æŒï¼Œå¦‚æœ ç±»ä¸Šå’Œæ–¹æ³•ä¸ŠåŒæ—¶åŠ äº†æ³¨è§£ï¼Œä»¥æ–¹æ³•ä¸Šçš„æ³¨è§£ä¸ºå‡†ã€‚åªè¦æ–¹æ³•æŠ›å‡ºäº†RuntimeExceptionï¼Œäº‹åŠ¡å°±è¿›è¡Œå›æ»šçš„æ“ä½œï¼Œä½†å¦‚æœä½ æŠŠå¼‚å¸¸try catchäº†ï¼Œä¸”æ²¡æœ‰åœ¨catchå—é‡ŒæŠ›å‡ºRuntimeExceptionï¼Œè¿™ç§æƒ…å†µä¸‹å‡ºç°å¼‚å¸¸äº‹åŠ¡æ˜¯ä¸ä¼šè¿›è¡Œå›æ»šçš„ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceA</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// è¿™ç§æƒ…å†µä¸‹å‡ºç°å¼‚å¸¸æ˜¯ä¸ä¼šè¿›è¡Œäº‹åŠ¡å›æ»šçš„ã€‚</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token function">updateById</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token comment">// ä¼šè¿›è¡Œäº‹åŠ¡å›æ»šçš„å†™æ³•</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token function">updateById</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="è¯¦è§£-Transactionalæ³¨è§£"><a href="#è¯¦è§£-Transactionalæ³¨è§£" class="headerlink" title="è¯¦è§£@Transactionalæ³¨è§£"></a>è¯¦è§£@Transactionalæ³¨è§£</h2><h3 id="rollbackForå‚æ•°"><a href="#rollbackForå‚æ•°" class="headerlink" title="rollbackForå‚æ•°"></a>rollbackForå‚æ•°</h3><p>è¿™ä¸ªå‚æ•°æ˜¯è¡¨æ˜æ•è·ä»€ä¹ˆå¼‚å¸¸è¿›è¡Œå›æ»šæ•°æ®çš„ã€‚é»˜è®¤åªæœ‰æ•è·åˆ°RuntimeExceptionå’ŒErroræ‰ä¼šè¿›è¡Œå›æ»šï¼Œï¼ˆåŸºäºspringboot2.5.xï¼Œä¸åŒç‰ˆæœ¬å¯èƒ½æœ‰å·®å¼‚ï¼Œè¯·è‡ªå·±æŸ¥çœ‹ä»£ç ã€‚ï¼‰ä¸ä¼šå›æ»šçš„æ˜¯ä»€ä¹ˆå¼‚å¸¸å‘¢ï¼Œå°±æ˜¯é‚£ç§éœ€è¦å£°æ˜çš„å¼‚å¸¸ï¼Œspringbootäº‹åŠ¡æ§åˆ¶æ˜¯ä¸ä¼šæ•è·åˆ°ï¼Œå¹¶å›æ»šæ•°æ®çš„ï¼Œè‡³äºä¸ºå•¥ï¼Œå¾ˆç®€å•å•Šï¼Œå› ä¸ºå£°æ˜çš„å¼‚å¸¸ï¼Œå¤§å¤šéƒ½æ˜¯è‡ªå·±æ‰‹åŠ¨å¤„ç†çš„ï¼Œç»§ç»­å¾€ä¸ŠæŠ›æˆ–è€…Try Catchä¸€ä¸‹ï¼Œå¦‚æœä¸æ‰‹åŠ¨å¤„ç†ï¼Œç¨‹åºæ— æ³•ç¼–è¯‘ã€‚æ¯”å¦‚IOå¼‚å¸¸ï¼Œè¿™äº›æ˜¯ä¸ä¼šè¢«äº‹åŠ¡æ§åˆ¶æ•æ‰åˆ°çš„ã€‚</p><h3 id="propagationå‚æ•°"><a href="#propagationå‚æ•°" class="headerlink" title="propagationå‚æ•°"></a>propagationå‚æ•°</h3><p>propagation ä»£è¡¨äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œé»˜è®¤å€¼ä¸º<code>Propagation.REQUIRED</code>ï¼Œå…¶ä»–çš„å±æ€§ä¿¡æ¯å¦‚ä¸‹ï¼š</p><ul><li><p><code>Propagation.REQUIRED</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚( ä¹Ÿå°±æ˜¯è¯´å¦‚æœAæ–¹æ³•å’ŒBæ–¹æ³•éƒ½æ·»åŠ äº†æ³¨è§£ï¼Œåœ¨é»˜è®¤ä¼ æ’­æ¨¡å¼ä¸‹ï¼ŒAæ–¹æ³•å†…éƒ¨è°ƒç”¨Bæ–¹æ³•ï¼Œä¼šæŠŠä¸¤ä¸ªæ–¹æ³•çš„äº‹åŠ¡åˆå¹¶ä¸ºä¸€ä¸ªäº‹åŠ¡ ï¼‰</p></li><li><p><code>Propagation.SUPPORTS</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡çš„æ–¹å¼ç»§ç»­è¿è¡Œã€‚</p></li><li><p><code>Propagation.MANDATORY</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>Propagation.REQUIRES_NEW</code>ï¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œæš‚åœå½“å‰çš„äº‹åŠ¡ã€‚( å½“ç±»Aä¸­çš„ a æ–¹æ³•ç”¨é»˜è®¤Propagation.REQUIREDæ¨¡å¼ï¼Œç±»Bä¸­çš„ bæ–¹æ³•åŠ ä¸Šé‡‡ç”¨ Propagation.REQUIRES_NEWæ¨¡å¼ï¼Œç„¶ååœ¨ a æ–¹æ³•ä¸­è°ƒç”¨ bæ–¹æ³•æ“ä½œæ•°æ®åº“ï¼Œç„¶è€Œ aæ–¹æ³•æŠ›å‡ºå¼‚å¸¸åï¼Œbæ–¹æ³•å¹¶æ²¡æœ‰è¿›è¡Œå›æ»šï¼Œå› ä¸ºPropagation.REQUIRES_NEWä¼šæš‚åœ aæ–¹æ³•çš„äº‹åŠ¡ )</p></li></ul><p>-<code>Propagation.NOT_SUPPORTED</code>ï¼šä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œæš‚åœå½“å‰çš„äº‹åŠ¡ã€‚</p><ul><li><p><code>Propagation.NEVER</code>ï¼šä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>Propagation.NESTED</code> ï¼šå’Œ Propagation.REQUIRED æ•ˆæœä¸€æ ·ã€‚</p></li></ul><p>æ›´å¤šå‚æ•°å¯ä»¥ç™¾åº¦äº†è§£ã€‚</p><h2 id="å®é™…çš„é—®é¢˜"><a href="#å®é™…çš„é—®é¢˜" class="headerlink" title="å®é™…çš„é—®é¢˜"></a>å®é™…çš„é—®é¢˜</h2><p>æœ¬äººå¤„ç†ä¸€äº›é“¶è¡Œè´¦åŠ¡åŠ¨è´¦ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚ä¸€ä¸ªè®°è´¦æ“ä½œæ—¶ï¼Œæˆ‘éœ€è¦æŠŠéœ€è¦è®°è´¦çš„æ•°æ®çš„çŠ¶æ€å…ˆæ”¹æˆåœ¨å¤„ç†çš„çŠ¶æ€ï¼Œä¸”éœ€è¦æäº¤äº‹åŠ¡ï¼Œä¸”éœ€è¦ç¡®å®šä¸‹ä¸€ä¸ªäº‹åŠ¡å¼€å¯æ—¶éœ€è¦è®°è´¦çš„æ•°æ®çŠ¶æ€å·²ç»æ˜¯ä¿®æ”¹è¿‡åçš„çŠ¶æ€ï¼Œé˜²æ­¢é‡å¤æ“ä½œåŒä¸€ç¬”æ•°æ®ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œåœ¨ä½¿ç”¨springå£°æ˜äº‹åŠ¡æ§åˆ¶æ—¶ï¼Œå¦‚ä½•è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceA</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// æ£€æŸ¥æ•°æ®çŠ¶æ€æ˜¯å¦å¤„äºæ­£å¸¸çŠ¶æ€ï¼Œå¦‚æœåœ¨å¤„ç†ä¸­å°±ä¸è¿›è¡Œæ“ä½œ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ­¤æ•°æ®æ­£åœ¨ä¿®æ”¹ä¸­ï¼Œæ— æ³•æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ­¤æ—¶éœ€è¦æäº¤</span>        <span class="token comment">// ä¸‹é¢è¿›è¡Œä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œ</span>        <span class="token comment">//æ“ä½œç»“æŸå,è¿˜éœ€è¿›è¡Œä¸€äº›éœ€è¦äº‹åŠ¡æ§åˆ¶çš„æ“ä½œ</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¿™ç§æƒ…å†µå°±é»˜è®¤çš„äº‹åŠ¡æ§åˆ¶ä¸€ä¸ªæ–¹æ³•å†…åªèƒ½æœ‰ä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰€ä»¥ä¸­é—´é‚£æ­¥çš„æäº¤æ“ä½œä»¥æˆ‘çš„è§£å†³æ–¹å¼ï¼Œæ—¢ç„¶ä¸€ä¸ªæ–¹æ³•åªèƒ½æœ‰ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£æˆ‘æŠŠé€»è¾‘å•ç‹¬æä¸€ä¸ªæ–¹æ³•ä¸å°±è¡Œäº†ï¼Œè¯´å¹²å°±å¹²ï¼Œè¿™æ˜¯ä¿®æ”¹åçš„ä»£ç ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceA</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// æ£€æŸ¥æ•°æ®çŠ¶æ€æ˜¯å¦å¤„äºæ­£å¸¸çŠ¶æ€ï¼Œå¦‚æœåœ¨å¤„ç†ä¸­å°±ä¸è¿›è¡Œæ“ä½œ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ­¤æ•°æ®æ­£åœ¨ä¿®æ”¹ä¸­ï¼Œæ— æ³•æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token comment">// setStatus("2");</span>        <span class="token comment">// è°ƒç”¨æ–¹æ³•</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ­¤æ—¶éœ€è¦æäº¤</span>        <span class="token comment">// ä¸‹é¢è¿›è¡Œä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œ</span>        <span class="token comment">//æ“ä½œç»“æŸå,è¿˜éœ€è¿›è¡Œä¸€äº›éœ€è¦äº‹åŠ¡æ§åˆ¶çš„æ“ä½œ</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™ä¿¡å¿ƒæ»¡æ»¡çš„æ“ä½œå‘ç°setTest2æ–¹æ³•è°ƒç”¨è¿‡åï¼Œå‘ç°è¿˜æ˜¯åªæœ‰ä¸€ä¸ªäº‹åŠ¡ï¼Œä¸”setTest2çš„æ›´æ–°æ“ä½œè¿˜æ˜¯æ²¡æœ‰åˆ†å¼€æäº¤ï¼ŒåŸå› æ˜¯ï¼ŒJDKçš„åŠ¨æ€ä»£ç†ã€‚åœ¨SpringIoCå®¹å™¨ä¸­è¿”å›çš„è°ƒç”¨çš„å¯¹è±¡æ˜¯ä»£ç†å¯¹è±¡è€Œä¸æ˜¯çœŸå®çš„å¯¹è±¡ï¼Œåªæœ‰è¢«åŠ¨æ€ä»£ç†ç›´æ¥è°ƒç”¨çš„æ‰ä¼šäº§ç”Ÿäº‹åŠ¡ã€‚è¿™é‡Œçš„thisæ˜¯è‡ªèº«æ˜¯çœŸå®å¯¹è±¡è€Œä¸æ˜¯ä»£ç†å¯¹è±¡ï¼Œé—®é¢˜åˆ°è¿™é‡Œå·²ç»å¾ˆæ˜æœ—äº†ï¼Œè¿™æ ·å•Šï¼Œæ—¢ç„¶thisè°ƒç”¨çš„è¯äº‹åŠ¡ä¸èƒ½èµ·ä½œç”¨ï¼Œspringæœ€æ“…é•¿çš„ä¸å°±æ˜¯æ³¨å…¥ï¼Œæˆ‘æ³¨å…¥ä¸€ä¸ªï¼Œç„¶åä»£ç å¦‚ä¸‹ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceA</span><span class="token punctuation">&#123;</span>  <span class="token comment">// è¿™æ˜¯æˆ‘æ³¨å…¥çš„ï¼Œå®é™…å°±æ˜¯ä»å®¹å™¨é‡Œé¢å–å‡ºè‡ªå·±çš„ä»£ç†ç±»</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">ServiceA</span> serviceA<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// æ£€æŸ¥æ•°æ®çŠ¶æ€æ˜¯å¦å¤„äºæ­£å¸¸çŠ¶æ€ï¼Œå¦‚æœåœ¨å¤„ç†ä¸­å°±ä¸è¿›è¡Œæ“ä½œ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ­¤æ•°æ®æ­£åœ¨ä¿®æ”¹ä¸­ï¼Œæ— æ³•æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token comment">// setStatus("2");</span>        <span class="token comment">// è°ƒç”¨æ–¹æ³•</span>        <span class="token comment">// this.setTest2();</span>        <span class="token comment">// ä½¿ç”¨æ³¨å…¥çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œå°±èƒ½è§¦å‘äº‹åŠ¡äº†ï¼Œ</span>        serviceA<span class="token punctuation">.</span><span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ­¤æ—¶éœ€è¦æäº¤</span>        <span class="token comment">// ä¸‹é¢è¿›è¡Œä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œ</span>        <span class="token comment">//æ“ä½œç»“æŸå,è¿˜éœ€è¿›è¡Œä¸€äº›éœ€è¦äº‹åŠ¡æ§åˆ¶çš„æ“ä½œ</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åˆ°è¿™æ­¥ï¼Œå¿ƒé‡Œæƒ³ç€åº”è¯¥å°±å¯ä»¥äº†ï¼Œä½†å®é™…ä¸Šè¿˜æ˜¯ä¸è¡Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦çœ‹è¿™ä¸ªäº†<a href="#propagation%E5%8F%82%E6%95%B0">æ³¨è§£</a>ï¼Œé»˜è®¤çš„è§„åˆ™æ˜¯</p><div class="note note-info">            <p>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚</p>          </div><p>å¾ˆæ˜¾ç„¶è¿™ä¸ªä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œå› ä¸ºæˆ‘å°±æ˜¯éœ€è¦ä¸¤ä¸ªäº‹åŠ¡åˆ†åˆ«æäº¤ï¼Œä½ è¿˜ç»™æˆ‘åŠ å…¥åŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œé—¹å‘¢ï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œé…ç½®äº‹åŠ¡çš„éš”ç¦»æ€§é…ç½®ä¸º<code>Propagation.REQUIRES_NEW</code>ã€‚</p><div class="note note-info">            <p><code>REQUIRES_NEW</code>ï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œæš‚åœå½“å‰çš„äº‹åŠ¡ã€‚ä¸”æ–°å¢çš„äº‹åŠ¡å¤„ç†å®Œæˆååœ¨å¤„ç†å½“å‰çš„äº‹åŠ¡</p>          </div><p>ä»£ç å¦‚ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceA</span><span class="token punctuation">&#123;</span>   <span class="token annotation punctuation">@Resource</span>    <span class="token class-name">ServiceA</span> serviceA<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>propagation <span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span>REQUIRES_NEW<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// æ£€æŸ¥æ•°æ®çŠ¶æ€æ˜¯å¦å¤„äºæ­£å¸¸çŠ¶æ€ï¼Œå¦‚æœåœ¨å¤„ç†ä¸­å°±ä¸è¿›è¡Œæ“ä½œ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ­¤æ•°æ®æ­£åœ¨ä¿®æ”¹ä¸­ï¼Œæ— æ³•æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å…ˆæ›´æ–°ä¸€ä¸‹çŠ¶æ€</span>        <span class="token comment">// setStatus("2");</span>        <span class="token comment">// è°ƒç”¨æ–¹æ³•</span>        <span class="token comment">// this.setTest2();</span>        <span class="token comment">// ä½¿ç”¨æ³¨å…¥çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œå°±èƒ½è§¦å‘äº‹åŠ¡äº†ï¼Œ</span>        serviceA<span class="token punctuation">.</span><span class="token function">setTest2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ­¤æ—¶éœ€è¦æäº¤</span>        <span class="token comment">// ä¸‹é¢è¿›è¡Œä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œ</span>        <span class="token comment">//æ“ä½œç»“æŸå,è¿˜éœ€è¿›è¡Œä¸€äº›éœ€è¦äº‹åŠ¡æ§åˆ¶çš„æ“ä½œ</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ³¨æ„çœ‹æ§åˆ¶å°ï¼Œåº”è¯¥ä¼šå‡ºç°ä¸¤ä¸ªäº‹åŠ¡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘çš„éœ€æ±‚å°±ç®—æ˜¯å®Œæˆäº†ã€‚ç»™ä½ å¸¦æ¥æ–¹ä¾¿çš„äº‹åŠ¡æ€»ä¼šå¤šå¤šå°‘å°‘ç»™ä½ å¸¦æ¥äº›è®¸çš„ä¸ä¾¿ï¼Œè¿™äº›ä¸ä¾¿çš„åœ°æ–¹å«åšè§„åˆ™ï¼Œå› ä¸ºä½ ç”¨äº†åˆ«äººå¼€å‘çš„æŠ€æœ¯ï¼Œä½ å°±éœ€è¦ç ”ç©¶å’Œéµå®ˆåˆ«äººçš„å®šä¸‹çš„è§„åˆ™ã€‚ä¸€å¼€å§‹å¯èƒ½ä¼šè®©ä½ æŸæ‰‹æŸè„šçš„ï¼Œä½†æ˜¯ä¸€æ—¦ä½ æŒæ¡äº†è§„åˆ™ï¼Œä½ çš„ç¼–ç èƒ½åŠ›ä¼šå¾—åˆ°å¤§å¤§çš„æå‡ã€‚</p><h2 id="æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡"><a href="#æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡" class="headerlink" title="æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡"></a>æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡</h2><p>ä¸å»ºè®®ä½¿ç”¨ï¼Œåœ¨ä¸€äº›ç‰¹æ®Šçš„åœºæ™¯é‡Œå¯ä»¥ä½¿ç”¨ï¼Œå¦‚å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç›´æ¥çœ‹ä»£ç </p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// éœ€è¦æ³¨å…¥çš„å¯¹è±¡</span><span class="token annotation punctuation">@Autowired</span><span class="token keyword">private</span> <span class="token class-name">DataSourceTransactionManager</span> dataSourceTransactionManager<span class="token punctuation">;</span><span class="token annotation punctuation">@Autowired</span><span class="token keyword">private</span> <span class="token class-name">TransactionDefinition</span> transactionDefinition<span class="token punctuation">;</span><span class="token comment">// å¼€å¯äº‹åŠ¡</span><span class="token class-name">TransactionStatus</span> transactionStatus<span class="token operator">=</span>dataSourceTransactionManager<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span>transactionDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æäº¤äº‹åŠ¡</span>dataSourceTransactionManager<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span>transactionStatus<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å›æ»šäº‹åŠ¡</span>dataSourceTransactionManager<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span>transactionStatus<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å…·ä½“ä½¿ç”¨æ–¹æ³•æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥ç¼–å†™ä»£ç å°±å¯ä»¥äº†</p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax3.sinaimg.cn/large/005NNTS5ly1gw5ui05viuj33341wo1kz.jpg" alt="å¥³å­©å­ é£æ™¯ å¤–å»Š å†¬æ™¯è‰² å¤•é˜³ æ™šéœ"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>äº‹åŠ¡æ§åˆ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springbootæ‰“åŒ…äºŒä¸‰äº‹</title>
    <link href="/2021/10/20/java-03/"/>
    <url>/2021/10/20/java-03/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>çˆ±æƒ…æ˜¯ä¸¤ä¸ªå¼ºè€…ä¹‹é—´çš„é£èŠ±é›ªæœˆï¼Œè€Œä¸æ˜¯å¼±è€…ä¹‹é—´çš„è‹¦å¤§ä»‡æ·±ã€‚</p>          </div><p>ç®€å•çš„æ‰“åŒ…ï¼Œæ— éœ€å¤šè¨€å§ï¼Œideaé‡Œé¢ç›´æ¥ç‚¹ç‚¹ç‚¹å°±è¡Œã€‚å¯æƒœå‡¡äº‹å¤§éƒ½ä¸èƒ½æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ã€‚æ€»æœ‰ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„éœ€æ±‚ï¼Œä¼šè®©ä½ å¤´ç—›ä¸€ä¼šï¼Œä½†æ˜¯é‡åˆ°é—®é¢˜ä¹Ÿä¸ç”¨æ…Œï¼Œå®é™…æˆ‘ä»¬é‡åˆ°çš„å¤§å¤šé—®é¢˜ï¼Œç½‘ä¸Šä¸€æœä¸€å¤§ç¥¨è§£å†³æ–¹æ³•ï¼Œç„¶åè‡ªå·±æ ¹æ®è‡ªå·±çš„ç»éªŒä»é‡Œé¢æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ç»“æœå°±è¡Œã€‚</p><p>springbootæ‰“åŒ…é»˜è®¤çš„æƒ…å†µä¸‹æ‰“å®ŒåŒ…åä¼šè¿›è¡Œä¸€æ¬¡æµ‹è¯•ï¼Œæ‰€è°“æµ‹è¯•å°±æ˜¯å¯åœä¸€ä¸‹é¡¹ç›®ï¼Œè‡ªå·±æµ‹è¯•æ‰“åŒ…ç©çš„æ—¶å€™ï¼Œæ„Ÿè§‰å¹¶æ— å¤§ç¢ï¼Œæœ€å¤šåªæ˜¯æ‹–æ…¢ä¸€ç‚¹æ‰“åŒ…é€Ÿåº¦ã€‚ä½†å®é™…ä¸Šæ‰“åŒ…çš„çº¿ä¸Šé…ç½®å¾ˆéš¾å’Œæ‰“åŒ…ç¯å¢ƒåšåˆ°ä¸€è‡´ï¼Œå°±æ˜¯è¯´ä½ ç”¨çº¿ä¸Šçš„é…ç½®æ‰“åŒ…é¡¹ç›®ï¼Œé¡¹ç›®å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯è·‘ä¸èµ·æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé»˜è®¤çš„æµ‹è¯•æ­¥éª¤å°±æ²¡å•¥ç”¨ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½æ˜¯å…³é—­çš„ã€‚</p><h2 id="å…³é—­æ‰“åŒ…çš„æµ‹è¯•é…ç½®"><a href="#å…³é—­æ‰“åŒ…çš„æµ‹è¯•é…ç½®" class="headerlink" title="å…³é—­æ‰“åŒ…çš„æµ‹è¯•é…ç½®"></a>å…³é—­æ‰“åŒ…çš„æµ‹è¯•é…ç½®</h2><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- è·³è¿‡æµ‹è¯• --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skipTests</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skipTests</span><span class="token punctuation">></span></span>    ...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç»§ç»­èŠï¼ŒJavaé¡¹ç›®çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œå¦‚Mavenï¼Œåˆæˆ–è€…Gradleï¼Œç»™æˆ‘ä»¬å¸¦æ¥äº†æ–¹ä¾¿çš„åŒæ—¶ä¹Ÿæœ‰äº†ä¸€ç‚¹ç‚¹çš„å°é™åˆ¶ï¼Œå®é™…ä¸Šå¹¶ä¸èƒ½ç§°ä½œä¸ºé™åˆ¶ï¼Œåªæ˜¯éœ€æ±‚å¤ªè¯¡å¼‚å§ï¼Œæ¯”å¦‚æœ¬ç¨‹åºå‘˜å°±é‡åˆ°è¿‡ï¼Œé¡¹ç›®æ–°æ—§ç¢°æ’ï¼Œæœ‰ä¸€ä¸ªä¾èµ–åŠå…¶å¤è€ï¼Œå¤šè€ä¸æ¸…æ¥šï¼ŒMavenä¸­å¤®ä»“åº“é‡Œå·²ç»æ‰¾ä¸åˆ°è¿™ä¸ªç‰ˆæœ¬äº†ï¼Œåˆä¸æ•¢ç”¨åˆ«çš„ä¾èµ–æ›¿æ¢ï¼Œé‚£æ€ä¹ˆåŠï¼Œé¡¹ç›®æ€ä¹ˆè·‘èµ·æ¥å‘¢ï¼Œå¤§éƒ¨åˆ†IDEå·¥å…·ç©çš„ç†Ÿçš„äººï¼ŒçŸ¥é“æ€ä¹ˆå¼„ï¼Œæ‰‹åŠ¨æ·»åŠ classpathè·¯å¾„ï¼Œä¸åŒIDEæœ‰ä¸åŒçš„æ“ä½œæ–¹æ³•ï¼Œä¸ç»†è¯´ã€‚çŸ¥é“è¿™æ­¥çš„ï¼Œé¡¹ç›®å¼€å‘è°ƒè¯•è¿è¡Œæ²¡æœ‰é—®é¢˜äº†ï¼Œä½†æ˜¯ï¼Œæˆ‘æ—¢ç„¶éƒ½è¯´äº†ï¼Œé—®é¢˜è‚¯å®šè¿˜æ²¡è§£å†³ã€‚å¼€å‘çš„å·®ä¸å¤šäº†ï¼Œæ‰“åŒ…å‘å¸ƒï¼Œä¸€ä¸Šçº¿ï¼Œå’‹æŠ¥é”™äº†å‘¢ï¼Œä¸€èˆ¬ç¼ºå°‘ä¾èµ–æ—¶ï¼Œå¦‚æœä½ å¯åŠ¨è¿‡ç¨‹ä¸­æ²¡æœ‰ç”¨åˆ°è¿™ä¸ªä¾èµ–ï¼Œå®ƒä¸ä¼šæŠ¥é”™ï¼Œå½“ä½ æ‰§è¡Œæ–¹æ³•è¿‡ç¨‹ä¸­æŸä¸ªç±»ä¸­ç”¨åˆ°äº†è¿™ä¸ªä¾èµ–ï¼Œå®ƒæ‰ä¼šæŠ¥é”™ã€‚ä¸ºå•¥æŠ¥é”™å‘¢ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹å¼‚å¸¸ï¼Œæˆ‘ä¹Ÿè®°ä¸å¤ªæ¸…ï¼Œä¾èµ–ç¼ºå¤±çš„å¼‚å¸¸å«ä»€ä¹ˆClassNotFundä»€ä¹ˆä¹‹ç±»çš„å¼‚å¸¸ï¼Œå•è¯è®°å¾—ä¸æ¸…æ¥šï¼Œä¸­å¼è‹±è¯­ï¼’çº§æ°´å¹³çš„æˆ‘ç¿»è¯‘å°±æ˜¯æ‰¾ä¸åˆ°ç±»å¼‚å¸¸ã€‚è¿™æ—¶ï¼Œå¯¹äºSpringBootæ‰“çš„åŒ…ç†Ÿæ‚‰çš„äººå·²ç»å¼€å§‹æŸ¥çœ‹åŒ…é‡Œæ˜¯å¦æœ‰é—®é¢˜ï¼Œç®€å•çœ‹ä¸€ä¸‹ï¼Œå®šä½åˆ°é—®é¢˜äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ çš„ä¾èµ–ï¼Œå¹¶ä¸èƒ½è¢«SpringBootæ‰“åŒ…æ‰“è¿›å»ï¼Œé‚£æ€ä¹ˆåŠå‘¢ã€‚åˆ°ä¹Ÿä¸éš¾ï¼Œæ—¢ç„¶mavenä¸­çš„ä¾èµ–èƒ½æ‰“åŒ…è¿›å»ï¼Œæˆ‘ä»¬æŠŠä¾èµ–åœ¨Mavenä¸­é…ä¸€ä¸‹å°±è¡Œäº†å‘—ã€‚</p><h2 id="Mavenåœ¨pomä¸­åŠ è½½æœ¬åœ°ä¾èµ–æ–¹æ³•"><a href="#Mavenåœ¨pomä¸­åŠ è½½æœ¬åœ°ä¾èµ–æ–¹æ³•" class="headerlink" title="Mavenåœ¨pomä¸­åŠ è½½æœ¬åœ°ä¾èµ–æ–¹æ³•"></a>Mavenåœ¨pomä¸­åŠ è½½æœ¬åœ°ä¾èµ–æ–¹æ³•</h2><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.oracle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- è¿™ä¸ªéšä¾¿å¡«ï¼Œä¸€èˆ¬ç”¨å€’å†™åŸŸåçš„æ–¹å¼å§--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>ojdbc10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- è¿™ä¸ªåŒæ ·éšä¾¿å¡«ï¼Œä¸Šé¢åŠ è¿™ä¸ªå†…å®¹è¦ä¿è¯å…¨çƒå”¯ä¸€ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½ç”¨åŸŸåæ¥å†™--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- éšä¾¿å†™ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>system<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ä¸æ‡‚ï¼Œè¯·æœç´¢Mavenä¾èµ–scopeæ ‡ç­¾åšä»€ä¹ˆçš„--></span>    <span class="token comment">&lt;!-- æ ¸å¿ƒï¼š$&#123;project.basedir&#125;æŒ‡é¡¹ç›®æ ¹è·¯å¾„ï¼Œ /lib/ojdbc10.jarï¼Œä¸€èˆ¬æˆ‘æ˜¯åœ¨é¡¹ç›®æ ¹åºæ±Ÿä¸‹æ–°å»ºä¸€ä¸ªlibæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾jaråŒ…å³å¯ã€‚--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>systemPath</span><span class="token punctuation">></span></span>$&#123;project.basedir&#125;/lib/ojdbc10.jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>systemPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- å°†SystemScopeé…ç½®çš„ä¾èµ–æ‰“åŒ…åˆ°æ„å»ºåŒ…ä¸­ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includeSystemScope</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includeSystemScope</span><span class="token punctuation">></span></span>        ...    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>    ...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç»§ç»­è¯´å§ï¼Œè¿™ä¸¤ç§ä»¥åŠæ¶µç›–äº†ç™¾åˆ†ä¹‹å…«åä»¥ä¸Šæƒ…å†µï¼Œç»§ç»­è¯´æ‰“åŒ…ï¼Œspringbootçš„æ‰“åŒ…ï¼Œå¾ˆæ–¹ä¾¿ï¼Œä¸€ä¸ªæ•´ä½“çš„JaråŒ…ï¼Œä¸€è¡Œå‘½ä»¤å°±èƒ½ç›´æ¥è¿è¡Œå¯åŠ¨ï¼Œå¾ˆä¸é”™ã€‚ åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œå°±æ˜¯åœ¨ä½ ä¸æ–¹ä¾¿è®¿é—®çº¿ä¸Šæµ‹è¯•çš„ç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªäº”å…­åå…†çš„jarä¸Šä¼ å°†åŠå…¶éº»çƒ¦ï¼Œå°¤å…¶æ˜¯åœ¨çº¿ä¸Šæµ‹è¯•çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ¯æ¬¡å°±æ›´æ–°å‡ ä¸ªæ–‡ä»¶ï¼Œçº¿ä¸Šéƒ¨ç½²å´ä¾ç„¶éœ€è¦ä¸Šä¼ å¾ˆå¤§çš„ä¾èµ–ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¾èµ–å’ŒJaråŒ…åˆ†å¼€æ‰“åŒ…å°±æ˜¾å¾—ååˆ†æœ‰å¿…è¦äº†ã€‚</p><h2 id="SpringBooté¡¹ç›®JaråŒ…ä¾èµ–åˆ†ç¦»æ‰“åŒ…"><a href="#SpringBooté¡¹ç›®JaråŒ…ä¾èµ–åˆ†ç¦»æ‰“åŒ…" class="headerlink" title="SpringBooté¡¹ç›®JaråŒ…ä¾èµ–åˆ†ç¦»æ‰“åŒ…"></a>SpringBooté¡¹ç›®JaråŒ…ä¾èµ–åˆ†ç¦»æ‰“åŒ…</h2><p>è¿™ä¸ªéœ€è¦å‡ ä¸ªæ­¥éª¤ï¼Œé¦–å…ˆæˆ‘ä»¬æŒ‰æ­£å¸¸çš„æ–¹å¼é»˜è®¤æ‰“åŒ…ä¸€ä¸‹ï¼ŒæŠŠæ­£å¸¸çš„æ‰“åŒ…çš„JaråŒ…ä¸­çš„libæ–‡ä»¶å¤¹ç²˜è´´å‡ºæ¥ï¼Œç„¶åé…ç½®pomæ–‡ä»¶</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    ...        <span class="token comment">&lt;!--è¿™é‡Œå¯¹åº”é¡¹ç›®çš„ä¸»å…¥å£--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">></span></span>com.jy.frame.BootApplication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span><span class="token punctuation">></span></span>ZIP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>nothing<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>nothing<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>    ...    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>repackage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--end--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>é…ç½®å®Œæˆåé‡æ–°æ‰“åŒ…å¾—åˆ°çš„å°±æ˜¯æ²¡æœ‰ä¾èµ–çš„JaråŒ…äº†ï¼ŒæŠŠJarå’Œä¸Šé¢æ‹·å‡ºæ¥çš„libæ–‡ä»¶å¤¹æ”¾åœ¨åŒä¸€ç›®å½•ï¼Œè¿è¡Œçš„å‘½ä»¤éœ€è¦åŠ ä¸Šlibç›®å½•</p><div class="code-wrapper"><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">java -jar -Dloader.path&#x3D;.&#x2F;lib æ‰“å‡ºæ¥çš„JaråŒ…å.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva2.sinaimg.cn/large/005NNTS5ly1gvlxsfazirj62yo1o01l002.jpg" alt="çŸ­å‘å¥³å­©"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>maven</tag>
      
      <tag>package</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºæŠ€æœ¯</title>
    <link href="/2021/10/13/gossip-02/"/>
    <url>/2021/10/13/gossip-02/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>ç†æ€§çš„æ€ç»´å¹¶ä¸æ¯”æ„Ÿæ€§çš„æ€ç»´è¦é«˜çº§ï¼Œæˆ‘ä»¬çµé­‚çš„ç”»åƒä¸Šä¹Ÿç»ä¸åº”è¯¥åªå­˜åœ¨æŸä¸€ç§è‰²å½©ã€‚</p>          </div><p>è‡ªè®¤ä¸ºå¯¹æŠ€æœ¯æœ‰ç€æ— é™çš„çƒ­çˆ±ï¼Œèµšé’±åªæ˜¯é¡ºå¸¦ï¼Œè§£å†³é—®é¢˜å¯¹æˆ‘æ¥è¯´ï¼Œæ¯”èµšé’±æ›´æœ‰æ„æ€ï¼Œèµšé’±èƒ½åŠ›ï¼Œåªæ˜¯è¯æ˜ä¸€ä¸‹ï¼Œè‡ªå·±ä¸æ˜¯åºŸæå°±å¤Ÿäº†ï¼Œ</p><p>å®å›¾å¤§å¿—ä¹Ÿæ²¡æœ‰ï¼Œè‹Ÿä¸”å·ç”Ÿåˆ°ä¹Ÿä¸å±‘ã€‚æƒ³è‡ªåœ¨ï¼Œä¸ºè‡ªå·±è€Œæ´»ï¼Œå¯æ˜¯å•Šï¼Œäººå°±ä¸èƒ½å®Œå…¨çš„ä¸ºè‡ªå·±è€Œæ´»å•Šï¼Œå¦åˆ™é‚£å°±æ˜¯è‡ªç§ã€‚è½¬å¿µä¸€æƒ³è‡ªåœ¨ä¸¤ä¸ªå­—è¯´éš¾ä¹Ÿéš¾ï¼Œè¯´ç®€å•ä¹Ÿç®€å•ã€‚ç®€å•çš„æ–¹å¼ï¼Œèµšç‚¹é’±ç»™çˆ¶æ¯å…»è€ï¼Œç„¶åå’±ä»¬é‚£å°±äº”å°å±±å±±ä¸Šè§ï¼›éš¾çš„æ–¹å¼ï¼ŒèŠ±æ ·å°±å¤šäº†ï¼Œæˆ¿å­ï¼Œè½¦å­ï¼Œç¥¨å­ï¼Œå¥³å­ï¼Œæˆ‘æ˜¯ä¸€ä¸ªå­éƒ½æ²¡æœ‰å•ŠğŸ˜…ğŸ˜…</p><p>çŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå½“ä½ å‘ç°ä½ å¼•ä»¥ä¸ºè±ªçš„æŠ€æœ¯å…¶å®åªæ˜¯å·¥å…·è€Œå·²ï¼Œä½ ä¼šæ„Ÿåˆ°æ‚²å“€å—</p><p>æˆ‘éœ€è¦æ„Ÿåˆ°æ‚²å“€å˜›ï¼ŒæŠ€æœ¯æœ¬èº«å°±æ˜¯å·¥å…·ï¼Œåªæ˜¯è§£å†³é—®é¢˜çš„ä¸€ç§æ›´é«˜çº§çš„åšæ³•ï¼Œäººç±»ä»çŸ³å™¨æ—¶ä»£ï¼Œåˆ°é’é“œæ—¶ä»£ï¼Œå†åˆ°ç°åœ¨çš„é’¢é“æ—¶ä»£ï¼ŒæŠ€æœ¯å’Œå·¥å…·æ˜¯ç›¸è¾…ç›¸æˆçš„ã€‚å·¥å…·æ˜¯æŠ€æœ¯ï¼ŒæŠ€æœ¯æ˜¯å·¥å…·ï¼Œè¿™å¹¶ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯èƒ½ä¸èƒ½å·§å¦™çš„è§£å†³é—®é¢˜ã€‚</p><p>æœ‰æ¬¡æä¸ªJavaçš„Springbooté¡¹ç›®ï¼Œå¾€å‰ç«¯è¿›è¡ŒJsonæ ¼å¼è½¬æ¢çš„æ—¶å€™ï¼Œå‘ç°å±æ€§çš„å¤§å†™é¦–å­—æ¯å˜å°å†™äº†ï¼Œè¿™æå¤§çš„ä¸æ–¹ä¾¿å‰åä¸€è‡´æ€§ï¼Œå¤ªè‰¹è›‹äº†ã€‚å±æ€§åJSONåŒ–æ—¶ç«Ÿç„¶ä¼šæœ‰å˜åŒ–ï¼Œæ„Ÿè§‰Javaçš„å¾ˆå¤šæ¡†æ¶å¼€å‘è€…æœ‰ç‚¹æ­»è„‘ç­‹ï¼Œå‘½åè§„èŒƒè¿™ç©æ„å°±æ˜¯ä¸ªè§„èŒƒï¼Œä½ åšæ¡†æ¶åº•å±‚æ²¡å¿…è¦è¶Šå¨ä»£åº–ï¼Œå¼ºåˆ¶é‡‡ç”¨è¿™äº›è§„èŒƒã€‚åšåº•å±‚çš„ä¸œè¥¿å°±è¦æŠŠè‡ªç”±åº¦ç•™ç»™ä½¿ç”¨äººå‘˜ï¼Œåˆ«äººæ‰å¥½åœ¨æ­¤åŸºç¡€ä¸Šæ‰©å±•ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ä¸€äº›æ³¨è§£ä»€ä¹ˆçš„è§£å†³é—®é¢˜ï¼Œä½†æµªè´¹å¾ˆå¤šæ—¶é—´ã€‚æ•´ä½“ä¸Šæ¥è¯´ï¼Œæ— è®ºæ˜¯Javaçš„ä¸€äº›æ¡†æ¶è¿˜æ˜¯è¯­æ³•æœ¬èº«éƒ½ä¸ºäº†è§„èŒƒç‰ºç‰²äº†å¤ªå¤šçš„è‡ªç”±åº¦ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯åšäº›æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡çš„ä¸œè¥¿ã€‚</p><p>æ™ºèƒ½IDEï¼Œæ™ºèƒ½ç¼–ç¨‹è¯­è¨€çš„é£é€Ÿå‘å±•ï¼Œè®©æˆ‘æ„Ÿè§‰ç°åœ¨è¿™ä¸ªç¼–ç¨‹çš„é—¨æ§›çœŸçš„æ˜¯ä½åˆ°æ²¡è¯è¯´ï¼Œä½†æ˜¯å•Šï¼Œç¼–ç¨‹çš„è§„èŒƒï¼Œå·¥å…·å’Œè¯­è¨€å¯ä»¥å¸®ä½ åšåˆ°ï¼Œä½†æ˜¯ç¼–ç¨‹çš„çµé­‚ï¼Œæ€æƒ³ï¼Œå°±ä¸æ˜¯ä¸€æ—¶åŠä¼šèƒ½å¤Ÿå½¢æˆçš„ã€‚å¹¶ä¸èƒ½è¯´ä½ ç²¾é€šç¼–ç ï¼Œå°±èƒ½å†™å‡ºä»»ä½•ä¸œè¥¿ã€‚ä¸€ä¸ªç®€å•çš„æƒé™æ¡†æ¶ï¼Œå¦‚æœä½ ä¸çŸ¥é“æˆ–è€…ä¸ç†è§£ä¸€äº›ç®€å•çš„å¦‚RBACæƒé™æ¨¡å‹ï¼Œåªä¼šç”¨ifå’Œelseæ¥å†™ï¼Œä½ æ„Ÿè§‰è¿™å¯èƒ½å˜›ï¼Œå°±ç®—èƒ½ï¼Œå†™å‡ºæ¥çš„ä»£ç ä¹Ÿæ˜¯ä¸€ä¸ªå¤©å‘ï¼Œæ¯åŠ ä¸€ä¸ªæƒé™ä½ å°±è¦å¤šå†™ä¸€ä¸ªif,è¿™æ˜¯å™©æ¢¦ä¸€æ ·çš„ä»£ç ã€‚ä¸ç®¡ä½ ç Œç –ä½ ç Œçš„çš„å¤šå¥½ï¼Œåªä¼šç Œç –æ˜¯å»ºä¸å‡ºæ‘©å¤©å¤§æ¥¼çš„ã€‚</p><p>è¯´å›ç¼–ç¨‹è¯­è¨€ï¼Œæˆ‘å¯¹ç¼–ç¨‹è¯­è¨€å¾ˆæ˜¯æ„Ÿå…´è¶£ï¼Œæˆ‘å–œæ¬¢ç ”ç©¶ä¸åŒç±»å‹çš„è¯­è¨€ï¼ŒåŠ¨æ€è¯­è¨€ï¼Œé™æ€è¯­è¨€ï¼Œå¼±ç±»å‹ï¼Œå¼ºç±»å‹ã€‚Javaï¼ŒJavascriptç­‰ç­‰ï¼Œå¯¹äºJSè¿™ä¸ªè¯­è¨€å¾ˆå¥‡æ€ªï¼Œæˆ‘æœ‰ç‚¹æä¸å¤ªæ˜ç™½ï¼ŒåŠ¨æ€è¯­è¨€èŠ±æ ·å¤ªå¤šäº†ï¼Œä¸€ä¸ªthisçš„æŒ‡å‘é—®é¢˜ï¼Œå°±èƒ½è®©äººå¤´ç—›å¾ˆä¹…ï¼Œè¿˜æœ‰é—­åŒ…ï¼ŒJSçš„ä½œç”¨åŸŸå¯ä»¥è¯´æ˜¯è¯¡å¼‚åˆ°è®©äººéš¾ä»¥æ¥å—ã€‚å›è°ƒå‡½æ•°ï¼Œæˆ‘åˆ°ç°åœ¨éƒ½ä¸æ˜¯å¾ˆæ‡‚å›è°ƒå‡½æ•°çš„æ“ä½œåŸç†ï¼Œæ€ä¹ˆèƒ½æŠŠå€¼ä¼ è¿›å‡½æ•°çš„å‚æ•°é‡Œé¢ï¼Œè¿™å¯¹äºæˆ‘å­¦Javaå…¥é—¨çš„æˆ‘æ¥è¯´ï¼Œè¿™ç§æ“ä½œè¿™å¤ªä¸å¯æ€è®®äº†ã€‚æˆ‘è¿˜å¾—å­¦ä¹ ã€‚åˆ¤æ–­è‡ªå·±å¯¹JSçš„æŒæ¡ç¨‹åº¦ï¼Œå¯ä»¥å»çœ‹Jqueryçš„æºç ï¼ŒJqueryå®é™…ä¸Šç®—ä¸ä¸Šæ¡†æ¶ï¼Œæ›´å¤šåªæ˜¯ä¸€ä¸ªJSçš„è¯­æ³•ç³–å·¥å…·ï¼Œå¦‚æœèƒ½çœ‹æ‡‚é‡Œé¢ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„æ“ä½œï¼Œé‚£ä¹ˆä½ çš„JSæ°´å¹³å®é™…ä¸Šå·²ç»å¾ˆå¯ä»¥äº†ï¼Œå¯¹äºJSè¿™é—¨è¯­è¨€ï¼Œåˆçˆ±åˆæ¨ã€‚åæ¥åˆäº†è§£äº†TSï¼Œå¯¹äºå‰ç«¯æˆ‘æ˜¯å¾ˆç–‘æƒ‘çš„ï¼Œå› ä¸ºç°åœ¨æ²¡æœ‰ä¸€ä¸ªæ ‡å‡†ï¼Œå‰ç«¯å¼€å‘æœ‰JSå…šï¼Œè€Œç°åœ¨ä¸€äº›æ¡†æ¶åˆè½¬è€Œæ‹¥æŠ±TSï¼ŒTsç±»å‹è¯­è¨€éœ€è¦IDEçš„æ”¯æŒæ‰èƒ½å‘æŒ¥å‡ºé™æ€ç±»å‹çš„ä¼˜åŠ¿ï¼Œè€ŒVSCodeï¼Œè™½è¯´æ˜¯ä½¿ç”¨TSå¼€å‘çš„ï¼Œä½†æ˜¯è¯­æ³•æç¤ºå¹¶ä¸æ˜¯é‚£ä¹ˆå‹å¥½ï¼Œèµ·ç ç»™æˆ‘çš„æ„Ÿè§‰ä¸æ˜¯é‚£ä¹ˆå‹å¥½ã€‚æ¡†æ¶è™½å¤šï¼Œä½†è¦è®°ä½ï¼ŒåŸç”ŸJSçš„æ‰æ˜¯ä½ çš„ç«‹èº«ä¹‹æœ¬å•Šã€‚æ¡†æ¶å¯èƒ½ä¼šè¿‡æ—¶ï¼ŒåŸç”ŸJSä¹Ÿæœ‰å¯ä¼šè¿‡æ—¶ï¼Œä½†ç›¸è¾ƒæ¡†æ¶æ¥è¯´æ¦‚ç‡æä½ã€‚</p><p>Kotlinï¼Œç®—æ˜¯ä¸€ä¸ªæ™ºèƒ½è¯­è¨€ï¼Œè¿™è¯­è¨€å¯¹äºè‡ªç„¶è¯­è¨€ååˆ†å‹å¥½ï¼Œå¸¦æ¥çš„å‰¯ä½œç”¨å°±æ˜¯ï¼Œç¼–è¯‘æˆæœºå™¨è¯­è¨€æ—¶æœ‰ç‚¹æ…¢ã€‚æ™ºèƒ½ï¼Œç¬¦åˆç¼–ç¨‹è¯­è¨€çš„è®¾è®¡å“²å­¦ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œè°ç”¨è¿™ä¸ªè¯­è¨€ï¼Œå†™å‡ºæ¥çš„ä»£ç åŸºæœ¬éƒ½æ˜¯ååˆ†ç¬¦åˆç¼–ç¨‹è§„èŒƒçš„ä»£ç ï¼Œé¢å‘å¯¹è±¡è¯­è¨€çš„è®¾è®¡è§„åˆ™æ˜¯è¢«å®ƒç»™ç©æ˜ç™½äº†ã€‚Kotlinå’ŒJavaä¸€æ ·æ˜¯jvmè¯­è¨€ï¼Œå’ŒTså¯¹åº”JSä¸€æ ·ï¼ŒTsé‡Œé¢æ˜¯é€‚åº”JSçš„ï¼ŒKotliné‡Œä¹Ÿæ˜¯èƒ½å†™Javaçš„ã€‚è¿™æ˜¯ä¸€ç§åŒ…å®¹çš„å“²å­¦å§ã€‚</p><p>Javaï¼Œspringboot3.0æœ€ä½çš„JDKç‰ˆæœ¬ä¸º17.0ï¼Œä¸€äº›å›ºå®ˆJava8 çš„ä¼ä¸šå’Œå…¬å¸ï¼Œä½ å‘ä»»ä½ å‘å‘—ã€‚æŠ€æœ¯æ˜¯éœ€è¦åˆ›æ–°çš„ï¼ŒJavaä¸æ˜¯æ²¡æœ‰å‘å±•ï¼Œè€Œæ˜¯å‘å±•äº†ä¸€ç›´æ²¡äººç”¨ï¼Œä¸åœçš„åæ§½Jdk8çš„æ§½ç‚¹ï¼Œç„¶åé€ ä¸€äº›è½®å­ï¼Œå®é™…ä¸Šä¸€äº›ç—›ç‚¹ï¼Œä»¥åŠè½®å­ï¼ŒJavaæ–°ç‰¹æ€§ä¸­å·²ç»æœ‰äº†ï¼Œæ¯”å¦‚å¤§å®¶å¸¸ç”¨çš„Lombokæ’ä»¶ï¼ŒJDK17ä¸­å·²ç»ä¸éœ€è¦è¿™ä¸ªæ’ä»¶äº†ï¼Œçœ‹è¿‡æ¯ä¸ªç‰ˆæœ¬çš„æ–°ç‰¹æ€§ä»‹ç»ï¼Œå¿˜äº†ï¼Œæˆ‘ä¸å–œæ¬¢ç”¨Lombokæ‰€ä»¥æˆ‘å¯¹è¿™ä¸ªç‰¹æ€§æˆ‘è®°å¾—æ¯”è¾ƒæ¸…æ¥šã€‚å…¶ä»–çš„æ€§èƒ½ï¼Œå¤šçº¿ç¨‹ï¼ŒGCç­‰ç­‰ä¼˜åŒ–ï¼Œè¿™ä¸ªæˆ‘ä¸æ˜¯å¤ªæ‡‚ï¼Œä¹Ÿä¸éœ€è¦æ‡‚ï¼Œç¨‹åºè·‘çš„åŠ¨ï¼Œè·‘å¾—å¿«ï¼Œè·‘çš„ç¨³å°±è¡Œã€‚</p><p>å®é™…ä¸Šæ¯ç§è¯­è¨€ç±»å‹é‡Œä½ å­¦ä¸€ç§å°±è¡Œäº†ï¼Œå› ä¸ºåŒç±»å‹çš„è¯­è¨€å·®ä¸å¤šï¼Œç¼–ç¨‹è¯­è¨€æœ¬è´¨å°±ä¸‰ä¸ªä¸œè¥¿ï¼Œå˜é‡ï¼Œå¾ªç¯å’Œæ¡ä»¶æ§åˆ¶ã€‚æˆ‘ç»å¸¸è°ƒä¾ƒäººï¼Œä¸€ä¸ªç¼–ç¨‹è¯­è¨€æˆ‘ä¼šå®šä¹‰å˜é‡ï¼Œä¼šif,ä¼šfor,å°±å·²ç»æŒæ¡æ ¸å¿ƒæŠ€å·§äº†ï¼Œè‡³äºæ–¹æ³•å’Œå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå®é™…ä¸Šæ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œè¿™ä¸ªåº”è¯¥å¾ˆç®€å•ï¼Œä¸ç®¡å†™æ³•æ€ä¹ˆå˜ï¼Œæ ¸å¿ƒåœ¨é‚£ï¼Œç®¡ä½ æ€ä¹ˆå˜ã€‚å‚æ•°å€¼ï¼Œè¿”å›å€¼ï¼Œè®¿é—®åŸŸæ§åˆ¶ï¼Œè¿™äº›ä¸œè¥¿ä¸ä¼šå˜å§ã€‚</p><p>AOPï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œè¿™ä¸ªç¼–ç¨‹æ€æƒ³ä¸Šçš„ä¸ä¸€æ ·äº†ï¼Œä¸€èˆ¬éƒ½ç”¨æ¥å¼¥è¡¥é¢å‘å¯¹è±¡ä¸Šçš„ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼Œåœ¨ä¸æ”¹å˜æºç çš„æƒ…å†µä¸‹ï¼Œåšä¸€äº›å¢å¼ºæ“ä½œã€‚å¦‚æœä¸è€ƒè™‘å¤šäººå¼€å‘ï¼Œè¿™ä¸ªç©æ³•å°±å¤šäº†å»äº†ï¼Œä½ ç”šè‡³å¯ä»¥æ ¹æ®æ–¹æ³•åæˆ–å‡½æ•°åæ¥è¿›è¡Œå¢å¼ºæ“ä½œã€‚è€ƒè™‘å¤šäººå¼€å‘ï¼Œé‚£å°±è€è€å®å®çš„åŠ æ³¨è§£å§ã€‚</p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1gvdvmcqdh6j631a1uonpd02.jpg" alt="å¥³å­,å¤œæ™¯"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
      <tag>æŠ€æœ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æƒ³åˆ°ä»€ä¹ˆå°±è¯´äº›ä»€ä¹ˆ</title>
    <link href="/2021/10/10/other-03/"/>
    <url>/2021/10/10/other-03/</url>
    
    <content type="html"><![CDATA[<p>å£°éŸ³ï¼Œæ°”å‘³ï¼Œè§¦è§‰ï¼Œå®ƒä»¬æ˜¯å¯ä»¥æ‰¿è½½è®°å¿†çš„ï¼Œä¸€äº›æ­Œï¼Œä¸€äº›é¦™æ°´çš„å‘³é“ï¼Œä¸€ä¸ªä¸ç»æ„çš„åŠ¨ä½œã€‚è‹¦éš¾ä¼šæ”¾å¤§äººçš„æ„Ÿå®˜ã€‚ç±»ä¼¼äºå¿ƒç†å­¦ä¸­çš„åŠæ¡¥æ•ˆåº”ï¼Œä½†è¿œè¿œæ¯”åŠæ¡¥æ•ˆåº”æ¥çš„æ›´çœŸå®ï¼Œç ”ç©¶å¿ƒç†å­¦çš„äººå¤§å¤šåæ‰§ä¸”å‚²æ…¢ï¼Œæˆ‘ä¸å–œæ¬¢çœ‹è¿™ç©æ„ï¼Œè¿™ä¸œè¥¿å­¦å¤šäº†ï¼Œå°±æ²¡äººå‘³äº†ï¼ŒåŒé”€å† ï¼Œè¢«è¶Šæ¥è¶Šå¤šäººç†è§£çš„åè§ï¼Œå°±ä¸æ˜¯åè§äº†ï¼Œæ¯”å¦‚å¤§å®¶ä¸€æåˆ°æ¸©å·äººï¼Œç¬¬ä¸€ååº”å¤§å¤šéƒ½æ˜¯ï¼Œé ï¼Œæœ‰é’±äººã€‚</p><p>æˆ‘ä¸Šåˆä¸­çš„æ—¶å€™å°±ä½æ ¡äº†ï¼Œæˆ‘æ˜¯ä¸€ä¸ªå†œæ‘å¨ƒå¨ƒï¼Œå½“æ—¶åˆšä¸Šåˆä¸­ï¼Œç­ä¸Šçš„å¥³åŒå­¦å¥¹ä»¬éƒ½å¥½å‰å®³çš„ï¼Œæˆ‘ç©ä¸è¿‡å¥¹ä»¬ï¼Œæˆ‘çš„æ€§æ ¼ä¸æ˜¯å¾ˆå¥½ï¼Œå¯ä»¥è¯´æœ‰ç‚¹è‡­äº†ï¼Œæ²¡äººå¯ä»¥è¯´æ•™æˆ‘ï¼Œä¸å–œæ¬¢å¥³è€å¸ˆï¼Œé™¤éæ˜¯æˆ‘è‡ªå·±æƒ³åšï¼Œå¦åˆ™æˆ‘åªä¼šå’Œä½ å¯¹ç€å¹²ã€‚ä»¥ç°åœ¨çš„æˆ‘å¾€å›çœ‹é‚£æ—¶çš„æˆ‘ï¼Œå¤šé…·å•Šï¼Œç®€ç›´é…·åˆ°æ²¡æœ‹å‹ã€‚å“ˆå“ˆå“ˆï¼Œç”·äººè‡³æ­»æ˜¯å°‘å¹´ã€‚</p><p>æˆ‘å¬åˆ°ä¸€äº›ä¸Šé¢è¯´çš„è‹¦éš¾æ—¶æœŸå¬çš„æ­Œï¼Œè„‘æµ·ä¸­ä¼šæ§åˆ¶ä¸ä½æµ®ç°å½“æ—¶çš„ç”»é¢ï¼ŒåˆäºŒä¸Šå­¦æœŸï¼Œå¯’å†¬ï¼Œæ‰‹é‡Œé’±åˆä¸å¤šï¼Œåœ¨æ ¡å›­é‡Œé£˜è¡ï¼Œæ™šè‡ªä¹ æ•™å®¤ä¹Ÿæ²¡ç©ºè°ƒï¼Œæˆ‘è®°å¾—æœ€æ¸…æ¥šçš„å°±æ˜¯æˆ‘ä»¬æ•™å­¦æ¥¼å’Œå®¿èˆä¹‹é—´æœ‰ä¸ªå··å­ï¼Œé‚£é‡Œé¢çš„é£ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œå°±æ˜¯æ¯æ¬¡è·¯è¿‡éƒ½ä¼šè¯´ä¸€å¥ï¼Œè‰¹ï¼Œå¥½å†·ï¼å®¿èˆé‡Œé¢ä¹Ÿæ²¡æœ‰çƒ­æ°´ï¼Œåªèƒ½é ä¸€ä¸ªæš–æ°´ç“¶åˆ°é£Ÿå ‚é‡Œé¢æ‰“ç‚¹çƒ­æ°´ï¼Œäº”æ¯›é’±ä¸€ç“¶ï¼Œå¯¹å½“æ—¶çš„æˆ‘æ¥è¯´ï¼Œå¥½è´µï¼ï¼æœ‰æ—¶æ°´æ”¾æ—¶é—´é•¿äº†ï¼Œä¸çƒ­äº†ï¼Œæ³¡é¢æ³¡ä¸å¼€ï¼Œå°±å¤šæ³¡å‡ éï¼Œå°±æ˜¯æ³¡ä¸€éæŠŠæ°´å€’æ‰ï¼Œç„¶åç»§ç»­æ³¡ã€‚å“ˆå“ˆå½“æ—¶ç»å…¸ç‚¹çš„å¨±ä¹æ´»åŠ¨å°±æ˜¯åœ¨å¤–é¢ä¹°ç‚¹ç†Ÿé£Ÿï¼Œå›åˆ°å®¿èˆï¼Œåœ¨é˜³å°æŠŠæ¡Œå­ä¸€æ‘†ï¼Œå–ç‚¹å•¤é…’ï¼Œæ‰“æ‰“çº¸ç‰Œï¼Œä¸‹ä¸‹è±¡æ£‹ï¼Œè¿™äº›æ´»åŠ¨ä¸€èˆ¬éƒ½æ˜¯æ”¾å‡çš„å‰ä¸€æ™šã€‚å›æƒ³èµ·æ¥ï¼Œåˆ°ä¹Ÿä¸°å¯Œäº†å›å¿†ã€‚</p><p>å¤§å®¶å¯¹èŠ±éœ²æ°´çš„å‘³é“åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œä»¥å‰æœ‰ä¸ªäººè§‰å¾—èŠ±éœ²æ°´çš„å‘³é“å¾ˆå¥½é—»ï¼Œæˆ‘å½“æ—¶è¡¨æƒ…è®°ä¸æ¸…äº†ï¼Œå®è—å•Šï¼Œå°±æ˜¯è¿™ç§æ„Ÿè§‰å§ã€‚ä¹ƒè‡³äºæˆ‘åˆ°ç°åœ¨é—»åˆ°èŠ±éœ²æ°´çš„æ°”å‘³ï¼Œä¾¿èƒ½æƒ³åˆ°å¥¹ååœ¨è¢«çªé‡Œçš„ç”»é¢ï¼Œæˆ‘é—®å¥¹å±‹å­é‡Œä»€ä¹ˆå‘³ï¼Œå¥¹çœ¼ç›é‡Œå¥½åƒæœ‰å°æ˜Ÿæ˜Ÿä¸€æ ·é—ªé—ªå‘å…‰çœ‹ç€æˆ‘è¯´ï¼Œè¿™æ˜¯èŠ±éœ²æ°´çš„æ°”å‘³å•Šï¼Œä½ ä¸è§‰å¾—å¾ˆå¥½é—»å˜›ã€‚æˆ‘ç‚¹ç‚¹å¤´ã€‚</p><p>æˆ‘ä¸è€å¯’ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ€•å†·ï¼Œå»å¹´çš„è¿™ä¸ªæ—¶å€™ï¼Œå½“æ—¶çš„é‚£ä»½å·¥ä½œæ¯å¤©ä¸Šç­ä¸‹ç­æˆ‘éœ€è¦èµ°åå‡ åˆ†é’Ÿçš„è·¯æ‰èƒ½åˆ°å®¶ï¼Œè·¯ä¸Šæˆ‘ä¹ æƒ¯å¬å¬æ­Œï¼Œæ‰“å¼€ç½‘æŠ‘äº‘ï¼Œã€Šä¿®ç‚¼çˆ±æƒ…ã€‹ï¼Œã€Šæ€ä¹ˆäº†ã€‹ï¼Œä»¥è‡³äºç°åœ¨æˆ‘å¬åˆ°è¿™ä¸¤é¦–æ­Œï¼Œæˆ‘å°±èƒ½æƒ³åˆ°é‚£ä¸ªæ—¶å€™ï¼Œå¯èƒ½æ˜¯å¯’å†·æ”¾å¤§äº†æˆ‘å½“æ—¶çš„æ„Ÿå®˜ï¼Œå½¢æˆäº†æ°¸ä¹…è®°å¿†å§ã€‚</p><p>å…¬äº¤ç«™å°ï¼Œçº¢ç»¿ç¯ï¼Œç”µæ¢¯ï¼Œè·¯è¾¹æ‘Šï¼Œè·¯ä¸Šçš„æµæµªç‹—ï¼Œå‡ºç§Ÿå±‹ï¼Œè¿™äº›é›¶é›¶æ•£æ•£çš„ä¸œè¥¿æ„æˆäº†æˆ‘å½“æ—¶ç”Ÿæ´»çš„å…¨éƒ¨ï¼Œç„¶åä¸€ç§ç”±å¿ƒè€Œç”Ÿçš„è½å¯æ„Ÿæ§åˆ¶ä¸ä½çš„å‘æˆ‘è¢­æ¥ï¼Œæˆ‘ç°åœ¨æƒ³åˆ°ï¼Œæˆ‘åˆ°äº†è¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä¸€æ ·ã€‚</p><div class="note note-info">            <p>æˆ‘ä»¬å¬æ­Œçš„æ—¶å€™ï¼Œå…¶å®æš´éœ²çš„å¤§éƒ½ä¸è¿‡æ˜¯å°æƒ…ç»ªè€Œå·²ï¼Œæ‰€è°“å°æƒ…ç»ªï¼Œå°±æ˜¯å¹¶ä¸ä¼šå¯¹ç”Ÿæ´»é€ æˆå®è´¨æ€§å½±å“çš„ï¼Œåæ­£è½¨è¿¹ä¸ä¼šå˜ã€‚æ˜¯å§ï¼Œæ˜¯æˆ‘ä»¬æ˜¯ä»€ä¹ˆæ ·çš„äººå†³å®šäº†æˆ‘ä»¬å¬ä»€ä¹ˆæ ·çš„æ­Œï¼Œè€Œä¸æ˜¯å¬ä»€ä¹ˆæ ·çš„æ­Œå†³å®šæˆ‘ä»¬æ˜¯ä»€ä¹ˆæ ·çš„äºº^_^ï¼Œä¸è¦æ²‰æººäºå°æƒ…ç»ªä¹‹ä¸­ï¼Œä¹–å•Šã€‚</p><p>è¿™ä¸€è·¯æ—¶å…‰æ¸©æŸ”ä¹Ÿå¥½ï¼Œåå·å´å²–ä¹Ÿç½¢ï¼Œæ€»å¾—å‘å‰ã€‚</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1gopbvuf16wj32yo1o0e84.jpg" alt="ç¨‹æ½‡"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‚£æ—¶æˆ‘è¿˜ä¸æ˜ç™½</title>
    <link href="/2021/09/23/other-02/"/>
    <url>/2021/09/23/other-02/</url>
    
    <content type="html"><![CDATA[<p>ä¸­ç§‹èŠ‚ï¼Œå›¢åœ†å¤œï¼Œä¸‰å¤©å‡æœŸï¼Œæˆ‘ä¹Ÿæ˜¯å›äº†ä¸€è¶Ÿè€å®¶ï¼Œä¸Šæ¬¡å›å®¶æ˜¯ç«¯åˆèŠ‚ï¼Œå†œå†äº”æœˆåˆäº”åˆ°å…«æœˆåäº”ï¼Œä¸‰ä¸ªæœˆæ²¡æœ‰å›å®¶äº†ï¼Œä¸Šç­ï¼Œä¸‹ç­ï¼Œå‘¨æœ«ï¼Œæ²¡æœ‰æš‘å‡çš„å¤å¤©è¿‡çš„é£å¿«ã€‚</p><p>ä¸‹äº†è½¦ï¼Œåˆ°å®¶é—¨å£ï¼Œåœ¨å›å®¶çš„è·¯ä¸Šé€šè¿‡å®¶é‡Œå®‰è£…çš„ç½‘ç»œæ‘„åƒå¤´ï¼Œåœ¨æ‰‹æœºä¸Šæˆ‘ä¾¿çœ‹åˆ°äº†å®¶é‡Œå¤šäº†ä¸¤åªå°ç‹—ï¼Œæœä¸å…¶ç„¶ï¼Œåˆšè¸è¿›é™¢å­ï¼Œæ±ªæ±ªæ±ªï¼Œç‹—å­ä¾¿ä¸€é¢ ä¸€é¢ çš„è·‘å‡ºæ¥ï¼Œå¥¶å¥¶å¬è§ç‹—å«ï¼Œå—¯?ç‹—å«? ?ä¹Ÿå¾ˆè‡ªç„¶çš„å‡ºæ¥äº†ï¼Œå›å®¶çš„æ„Ÿè§‰ï¼Œåˆ«çš„æ„Ÿè§‰è¯´å‡ºä¸æ¥ï¼Œå°±æ˜¯ä¸€ç§å®‰å¿ƒçš„æ„Ÿè§‰ï¼Œå®¶é‡Œå¹³æ—¶åªæœ‰çˆ·çˆ·å¥¶å¥¶åœ¨å®¶ï¼Œäººä¸å¤šï¼Œå°‘äº†ç‚¹ç”Ÿæ°”ï¼Œå±‹å­é‡Œçš„è§’è§’è½è½ï¼Œåˆ°æ˜¯ç”Ÿäº†ä¸å°‘èœ˜è››ç½‘ï¼Œé—®é¢˜ä¸å¤§ï¼Œç”Ÿç‰©é™¤è™«ï¼Œä¸¤ä¸ªå­—ç¯ä¿ï¼Œæˆ‘åˆ°ä¹Ÿä¸å¿å¿ƒæ‰“æ‰°å®ƒä»¬çš„å®‰å®ã€‚å®¶é‡Œä¸€åªçŒ«ï¼Œä¹Ÿå…»äº†å¥½é•¿æ—¶é—´äº†ã€‚ä¼°è®¡ä¹Ÿè¿‡äº†ä¸€å¤§åŠçš„çŒ«ç”Ÿäº†ã€‚çŒ«ç”Ÿä¸æ˜“ï¼Œä¸”å–µä¸”çæƒœã€‚</p><p>å›å®¶ä¹ æƒ¯èˆ¬çš„æŠŠä¹¦åŒ…å¾€æ¥¼æ¢¯æ‰¶æ‰‹ä¸€æŒ‚ï¼Œæ–¹ä¾¿ä¸Šæ¥¼æ—¶å¸¦ç€ï¼Œä¸ç»æ„çœ‹äº†ä¸€çœ¼ä¸Šé¢çš„ç°å°˜ï¼Œæˆ‘ç¡®å®å¾ˆé•¿æ—¶é—´æ²¡å›å®¶äº†ã€‚</p><p>äººä»¬ä¹ æƒ¯è¯´ä¸‹æ¬¡å†è§ï¼Œä¸‹æ¬¡å†è§ï¼Œæ€»ä»¥ä¸ºæœªæ¥å¾ˆé•¿ï¼Œæ®Šä¸çŸ¥äººä¸äººä¹‹é—´æ˜¯è§ä¸€é¢å°‘ä¸€é¢çš„ï¼Œä½ ä¸çŸ¥é“çš„å“ªæ¬¡è§é¢ï¼Œä¹Ÿè®¸æ˜¯ä¸€ä¸ªé£å’Œæ—¥ä¸½çš„åˆåï¼Œä½ ç«™åœ¨æœˆå°ä¸Šé€ä»–ä¸Šè½¦ï¼Œç›®é€ä»–ç¦»å»ã€‚ä½ è‡ªå·±ä¹Ÿæ²¡æœ‰æƒ³åˆ°ï¼Œè‡³æ­¤ï¼Œä½ å°±å†ä¹Ÿæ²¡æœ‰è§è¿‡ä»–äº†ã€‚</p><p>å’Œå¥¶å¥¶èŠå¤©ï¼Œé‚»é‡Œé‚»å¤–ï¼Œæˆ‘å¥¶å¥¶çš„å¹´çºªèŠå¤©èŠçš„å¤šæ˜¯è¿™ä¸ªèµ°äº†ï¼Œé‚£ä¸ªèµ°äº†ï¼Œè¯´ç½¢ï¼Œå¥¶å¥¶å¾ˆè‡ªç„¶çš„æ¥ä¸€å¥ï¼Œäººæ´»è¿™ä¸€è¾ˆå­ï¼Œæ²¡æ„æ€ã€‚æˆ‘ä¹Ÿä¸æ‡‚ï¼Œå¥¶å¥¶è¯´çš„äººä¸­ï¼Œæœ‰ä¸€ä¸ªæˆ‘æœ‰å°è±¡ï¼Œå»å¹´è¿‡å¹´çš„æ—¶å€™ï¼Œè¿˜æ¥æˆ‘å®¶åšå®¢ï¼Œè§¥ç­¹äº¤é”™çš„å…‰å½±é‡Œæˆ‘è¿˜è®°å¾—ä»–çš„æ ·å­ï¼Œä¸–äº‹æ— å¸¸ï¼Œä¸çŸ¥é“ä½œä½•æ„Ÿæƒ³ï¼Œæˆ–éœ€è¦æœ‰ä½•æ„Ÿæƒ³ã€‚</p><p>ä¸–ä¿—çœ¼ä¸­ï¼Œä¸ç®¡ç”·å¥³ï¼Œä¸‰å››åå²çš„å¹´çºªæ²¡æœ‰å®¶å®¤ï¼Œæ˜¯æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä¹Ÿéš¾å…è½ä¿—ã€‚ä»¥å‰çš„æˆå®¶ç«‹ä¸šçš„ä¹ ä¿—æ”¾åœ¨ç°ä»£å¥½åƒä¸åˆé€‚äº†ï¼Œåœ¨ç¤¾ä¼šæ–¹æ–¹é¢é¢çš„æ½œç§»é»˜åŒ–ä¸­ï¼Œæˆ–æ˜¯ç”µè§†å‰§ï¼Œæˆ–æ˜¯ç”µå½±ä¸­ï¼Œä½ æ²¡æœ‰ä¸šï¼Œæ˜¯ä¸é…æ‹¥æœ‰çˆ±æƒ…çš„ã€‚å›½å†…çš„ç»å¤§éƒ¨åˆ†ç”µè§†å‰§ä¸­ç”·ä¸»æˆ–å¥³ä¸»å¿…é¡»è¦æœ‰ä¸€ä¸ªæœ‰é’±çš„ï¼Œä¸ç„¶å¯¼æ¼”ä¸ä¼šæ‹ã€‚</p><p>å¯ç°å®æ˜¯ï¼Œäº‹ä¸šå°šæœªæœ‰èµ·è‰²ï¼Œå®¶ä¹¡éš¾ä»¥å‰²èˆåˆéš¾ä»¥èå…¥ï¼Œè°ˆå©šè®ºå«å·±è‡³çœ¼å‰ã€‚</p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1gntu80rs7nj30xc0gxn7b.jpg" alt="ç²‰çº¢"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue3åŠ TSä½¿ç”¨Classå†™æ³•</title>
    <link href="/2021/09/01/vue-01/"/>
    <url>/2021/09/01/vue-01/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>è¿™ç§å†™æ³•ææ¡ˆè²Œä¼¼è¢«å–æ¶ˆäº†ï¼ŒGitHubä¸Šä¹Ÿåœç•™åœ¨rc1ç‰ˆæœ¬äº†ï¼Œå·²ç»ä¸€å¹´å·¦å³æ²¡æœ‰æäº¤ä»£ç äº†ï¼Œç¡®å®ç”¨Classå†™Vueç¡®å®æœ‰ç‚¹å¥‡æ€ªï¼Œç°åœ¨æœ‰æ›´ä¼˜çš„é€‰æ‹©ï¼Œå¦‚<code>&lt;script setup&gt;</code>å†™æ³•,åšå®¢é‡Œé¢å¯¹Vuexï¼Œä»¥åŠVue-Routerçš„å°è£…è¿˜å¯ä»¥ç”¨ï¼ŒClassçš„å†™æ³•ä¸æå€¡ä½¿ç”¨äº†ã€‚</p>          </div><p>æ€»åœ¨ç›¼æœ›ï¼Œæ€»åœ¨å¤±æœ›ï¼Œæ—¥å­è¿˜ä¸éƒ½è¿™æ ·ã€‚ä»£ç ä¹Ÿéœ€è¦é›…ä¿—å…±èµï¼Œåšå®¢äº¦å¦‚æ­¤ã€‚</p><p>é„™äººä¸å–„å‰ç«¯ï¼Œä½†æ˜¯åˆä¼šä¸€ç‚¹ï¼Œè¿‘æ—¥åç«¯å†™çš„ä¹å‘³ï¼Œä¾¿æ‹èµ·å‰ç«¯ç«¯è¯¦ç«¯è¯¦ï¼Œä¸€æ—¥ä¸è§å¦‚éš”ä¸‰ç§‹çš„Vueï¼Œè®©æˆ‘æ„Ÿè§‰åˆ°ç”Ÿç–ï¼ŒVue3çš„è¯­æ³•å¥‡å¥‡æ€ªæ€ªï¼Œå®˜ç½‘ä¸Šçš„å†™æ³•ï¼Œæˆ‘æ˜¯å¹¶ä¸èƒ½å¾ˆç†è§£ï¼Œæˆ–è€…è¯´å°±æ˜¯ä¸æ˜“äºåç«¯ç¨‹åºå‘˜ç†è§£ï¼ŒåŠ ä¸ŠTsè¿™ä¸ªJSçš„ç±»å‹ç³»ç»Ÿè¯­è¨€ï¼Œè®©æˆ‘æ·±æ·±çš„æ„Ÿè§‰åˆ°ï¼Œçœ‰çœ¼ä¸å¦‚åˆï¼Œè®©æˆ‘æ€æ•¢ç›¸è®¤ã€‚</p><p>ä½†æ˜¯å…‰è¯´ä¸ç»ƒï¼Œæ˜¯å¾ˆéš¾ä½“ä¼šåˆ°å…¶ä¸­çš„ç„å¦™çš„ï¼Œæˆ‘ä¾¿å¼€å§‹äº†æ—¶éš”å¥½å¤šæœˆçš„Vue3é‡é€¢ä¹‹æ—…ã€‚</p><p>æ‰“å¼€VsCode,æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥vue create vue3_demoã€‚ä¸€é¡¿æ¡†é€‰ï¼Œä¸»è¦è®°å¾—è¦é€‰æ‹©Vue3ä»¥åŠTSçš„æ”¯æŒã€‚ä¹‹åï¼Œçœ‹ç€è¿›åº¦æ¡ï¼Œä¸åœåœ¨å˜åŠ¨ï¼Œå˜´è§’ç–¯ç‹‚ä¸Šæ‰¬ï¼Œé‚ªé­…ä¸€ç¬‘ï¼Œè¿˜æ˜¯å†…å‘³ã€‚</p><p>è¿›åº¦æ¡åŠ è½½å®Œæ¯•ï¼ŒVsCode,æ–‡ä»¶-&gt; å°†æ–‡ä»¶å¤¹æ·»åŠ åˆ°å·¥ä½œåŒºï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œyarn run serveï¼Œå›è½¦ï¼Œå˜´è§’ç»§ç»­ç–¯ç‹‚ä¸Šæ‰¬ï¼Œ</p><p>ç»¿è‰²çš„ç¾å¥½æç¤º<code>Compiled successfully</code>ï¼Œé¡¹ç›®æˆåŠŸå¯åŠ¨ï¼Œå¤åˆ¶url, æµè§ˆå™¨æ‰“å¼€ï¼Œå›æ¥äº†ï¼Œä»–ä»¬éƒ½å›æ¥äº†ã€‚</p><p>å¨´ç†Ÿçš„æ‰“å¼€<code>Home.vue</code>è®©æˆ‘çœ‹çœ‹,è¿™å‡ æœˆæ²¡è§ï¼Œå˜æˆä»€ä¹ˆæ ·äº†ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-typescipt" data-language="typescipt"><code class="language-typescipt">import &#123; Vue &#125; from &#39;vue-class-component&#39;export default class Home extends Vue &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>çœ‹åˆ°äº†è¿™ä¸¤è¡Œä»£ç ï¼Œè®©æˆ‘é™·å…¥äº†æ·±æ€ï¼Œå—¯ï¼Œè¿™å•¥ç©æ„ï¼Œæœ€ä½³å®è·µå˜›ï¼Œæœ¬ç€å®è·µçš„æ€åº¦ï¼Œè¯•è¯•åŸºæœ¬çš„æ–‡æ¡£ä¸­çš„æ–°è¯­æ³•ï¼Œä¸è¿‡æœ‰ä¸€è¯´ä¸€æˆ‘ç”šè‡³ä¸çŸ¥é“ï¼Œæ–°è¯­æ³•çš„ä»£ç æˆ‘ç”šè‡³ä¸çŸ¥é“å¾€å“ªé‡Œå†™ï¼Œè¿™tmä¸æ˜¯æ¬ºè´Ÿè€å®äººå˜›ã€‚ç¨‹åºå‘˜å˜›ï¼Œå–œæ¬¢å­¦ä¹ ï¼Œæœç´¢<code>vue-class-component</code>ï¼ŒåŸæ¥æ˜¯ä»¥ç±»çš„æ–¹å¼å†™ä»£ç å•Šï¼ŒOverï¼ŒJavaå…¥é—¨çš„æˆ‘å†™èµ·TSåˆ°ä¹Ÿä¸è§‰å¾—ç”Ÿç–ï¼Œè¯­æ³•è™½æœ‰åŒºåˆ«ï¼Œä½†ç†å¿µéƒ½æ˜¯ä¸€æ ·çš„ã€‚å£°æ˜å˜é‡æ—¶éœ€è¦å£°æ˜å±æ€§ï¼Œå®šä¹‰æ–¹æ³•æ—¶éœ€è¦è§„å®šå…¥å‚æ ¼å¼å’Œè¿”å›å€¼æ ¼å¼ã€‚å†µä¸”Tsæ›´å¤šçš„æ—¶å€™åªæ˜¯ä¸€ç§çº¦æŸï¼Œå¹¶ä¸æ˜¯ä¸€ç§è§„åˆ™ã€‚è¿™å¥è¯å¾ˆé‡è¦ï¼Œè¿˜è®°å¾—SpringBootçš„ä¸€ä¸ªç»å…¸ç†è®ºï¼Œçº¦æŸå¤§äºè§„åˆ™ã€‚ç¼–ç¨‹çš„å“²å­¦æ˜¯é€šç”¨çš„ã€‚</p><p>å¤§è‡´çŸ¥é“äº†æ€ä¹ˆå†™ä¹‹åï¼Œå®¹æˆ‘æ–°èµ·ä¸€è¡Œï¼Œå‘å°±å¦‚çº¦è€Œè‡³ï¼Œçˆ¶å­ç»„ä»¶ä¼ å€¼çš„æ—¶å€™ï¼Œæˆ‘ä¸çŸ¥é“propsåœ¨ä»€ä¹ˆåœ°æ–¹å†™ï¼Œè¿˜æœ‰ç›‘å¬å±æ€§ç­‰ç­‰ã€‚è¿™äº›é—®é¢˜å¾…æˆ‘ä¸€ä¸€è§£ç­”</p><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><p>Vue3åŠ Tså¿…é¡»ï¼ŒVueRouterå’ŒVuexï¼Œä¸€èˆ¬æ¥è¯´é¡¹ç›®ä¸­éƒ½ä¼šç”¨åˆ°ï¼Œå°±éƒ½åŠ ä¸Šã€‚</p><p>æˆ‘å»ºè®®ä¸å¯ç”¨ä»£ç è´¨é‡æ£€æŸ¥å’ŒESlintï¼ŒåŸå› ï¼ŒVue3å’Œtsèƒ½å¾ˆå¥½çš„å…¼å®¹ï¼Œåœ¨<code>vue-class-component</code>çš„åŠ æŒä¸‹ï¼Œå®é™…é¡¹ç›®ä¸­å¯èƒ½ç™¾åˆ†ä¹‹ä¹åä¹çš„ä»£ç éƒ½æ˜¯ä½¿ç”¨TSç¼–å†™ï¼ŒTså¤©ç”Ÿå°±æœ‰é™æ€æ£€æŸ¥ï¼Œå†ä½¿ç”¨EsLintï¼Œåœ¨å¼€å‘ä¸­åå€’æ˜¯æœ‰ç‚¹å¾’å¢åŠŸè€—ã€‚</p><p>åœ¨Vueçš„å¯è§†åŒ–é¡¹ç›®åˆ›å»ºå¹³å°ä¸­ï¼Œå‹¾é€‰è¿™å‡ é¡¹å°±è¡Œã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘å¹¶æ²¡æœ‰æ‰“ç®—å†™ä¿å§†æ•™ç¨‹ã€‚<br><img src="https://tva3.sinaimg.cn/large/005NNTS5ly1gu201nkgakj30ny04xgmh.jpg" alt="åˆ›å»ºé¡¹ç›®"></p><p>è·¯ç”±æ¨¡å¼ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§ä¸€ç§æ˜¯å¸¦<code>#</code>çš„è¿˜æœ‰ä¸€ç§å°±æ˜¯ä¸å¸¦çš„ï¼Œçœ‹ä¸ªäººå–œå¥½ï¼Œæˆ‘ä¸è®¨åŒè¿™ä¸ª<code>#</code>ã€‚é»˜è®¤å°±æ˜¯å¸¦çš„ã€‚cssé¢„å¤„ç†å™¨ç¼–è¯‘ï¼Œä¸€èˆ¬éƒ½æ˜¯é€‰ç”¨node-sassã€‚å°±é€‰è¿™ä¸ªå°±è¡Œäº†ã€‚</p><h3 id="ç¬¬ä¸‰æ–¹åº“å’ŒCSSç»„ä»¶"><a href="#ç¬¬ä¸‰æ–¹åº“å’ŒCSSç»„ä»¶" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“å’ŒCSSç»„ä»¶"></a>ç¬¬ä¸‰æ–¹åº“å’ŒCSSç»„ä»¶</h3><p>ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼š<a href="https://element-plus.gitee.io/#/zh-CN">element-plus</a>è¿™ä¸ªç»„ä»¶åº“åœ¨å†™åå°ç®¡ç†ç³»ç»Ÿçš„æ—¶å€™æ¯”è¾ƒå¥½ç”¨ï¼Œæ›´å¤šçš„æ—¶å€™æ˜¯æä¾›ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶ä¸èƒ½ç”¨æ¥å†™æ ·å¼ã€‚è€Œä¸”æˆ‘æ˜¯æ‰“ç®—å†™ä¸€ä¸ªå·®ä¸å¤šçš„å‰å°å†…å®¹ç³»ç»Ÿï¼Œè€ƒè™‘åˆ°æš—é»‘æ¨¡å¼çš„å…¼å®¹ï¼Œæˆ‘å¹¶ä¸èƒ½ç›´æ¥å¼€ç®±å³ç”¨é‡Œé¢çš„ç»„ä»¶ã€‚</p><p>CSSæ¡†æ¶ï¼š<a href="https://windicss.org/">Windi CSS</a>ï¼Œè¢«ç§°ä½œä¸ºä¸‹ä¸€ä»£çš„CSSæ¡†æ¶ï¼Œå¤©ç„¶æ”¯æŒæš—é»‘æ¨¡å¼ï¼Œå¼¥è¡¥ä¸Šé¢ç»„ä»¶åº“æ ·å¼çš„ä¸è¶³ï¼Œè€Œä¸”å†™èµ·æ¥å¾ˆèˆ’æœã€‚</p><p>Jqueryï¼š<a href="https://jquery.com/">JQ</a>è¿™ä¸ªä¼šå¼•èµ·ä¸€ç‚¹äº‰è®®ï¼Œä¸è¦æåˆ°Jqueryå°±æ˜¯ä»€ä¹ˆè¿‡æ—¶å•¦ï¼Œéƒ½æ˜¯ä¸Šä¸ªä¸–çºªçš„ä¸œè¥¿äº†ã€‚Jqä¸€ç›´åœ¨æ›´æ–°ï¼ŒJqé€‚é…äº†Ts, Jqçš„å…¼å®¹æ€§å¾ˆå¥½ï¼ŒJQueryå’ŒVueèƒ½ä¸€èµ·ä½¿ç”¨ã€‚è™½è¯´æ„Ÿè§‰ä¼šå¾ˆlowï¼Œä½†æ˜¯èƒ½æŠ“åˆ°è€é¼ çš„çŒ«å°±æ˜¯å¥½çŒ«ï¼Œä¸»è¦åŸå› è¿˜æ˜¯ï¼Œé„™äººä¸å–„å‰ç«¯ï¼ï¼ã€‚</p><p>ä¸ºäº†å®ç°ä¸€ä¸ªå¤šè¡Œæ–‡æœ¬è¾“å…¥é«˜åº¦è‡ªé€‚åº”ï¼Œå—¯ï¼Œå°±æ˜¯å¾ˆå°´å°¬çš„é‚£ç§ã€‚æŒºéš¾çš„ï¼ŒElementå®ç°æ–¹å¼çš„æºç æˆ‘çœ‹äº†ï¼Œæœ‰ç‚¹çœ‹ä¸æ‡‚ï¼Œç›´æ¥ç”¨Jqueryèƒ½å®ç°ï¼Œä½†æ˜¯ä¸å®Œç¾ï¼Œå°±æ˜¯ä¸ºäº†è¿½æ±‚æˆ‘è®¤ä¸ºçš„å®Œç¾ï¼ŒæŒºéš¾çš„ã€‚</p><p>Axiosï¼šç”¨æ¥é€šä¿¡ï¼Œæ€§èƒ½ä¼˜å¼‚ï¼Œå¥½å¤„å¤šå¤šã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>packegt.json</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ql_blog"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.1.0"</span><span class="token punctuation">,</span>  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"serve"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service serve"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service build"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"@element-plus/icons"</span><span class="token operator">:</span> <span class="token string">"^0.0.11"</span><span class="token punctuation">,</span>    <span class="token property">"@types/jquery"</span><span class="token operator">:</span> <span class="token string">"^3.5.6"</span><span class="token punctuation">,</span>    <span class="token property">"axios"</span><span class="token operator">:</span> <span class="token string">"^0.21.1"</span><span class="token punctuation">,</span>    <span class="token property">"core-js"</span><span class="token operator">:</span> <span class="token string">"^3.6.5"</span><span class="token punctuation">,</span>    <span class="token property">"element-plus"</span><span class="token operator">:</span> <span class="token string">"^1.1.0-beta.8"</span><span class="token punctuation">,</span>    <span class="token property">"jquery"</span><span class="token operator">:</span> <span class="token string">"^3.6.0"</span><span class="token punctuation">,</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"vue-class-component"</span><span class="token operator">:</span> <span class="token string">"^8.0.0-0"</span><span class="token punctuation">,</span>    <span class="token property">"vue-router"</span><span class="token operator">:</span> <span class="token string">"^4.0.0-0"</span><span class="token punctuation">,</span>    <span class="token property">"vuex"</span><span class="token operator">:</span> <span class="token string">"^4.0.0-0"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"@vue/cli-plugin-babel"</span><span class="token operator">:</span> <span class="token string">"~4.5.0"</span><span class="token punctuation">,</span>    <span class="token property">"@vue/cli-plugin-router"</span><span class="token operator">:</span> <span class="token string">"~4.5.0"</span><span class="token punctuation">,</span>    <span class="token property">"@vue/cli-plugin-typescript"</span><span class="token operator">:</span> <span class="token string">"~4.5.0"</span><span class="token punctuation">,</span>    <span class="token property">"@vue/cli-plugin-vuex"</span><span class="token operator">:</span> <span class="token string">"~4.5.0"</span><span class="token punctuation">,</span>    <span class="token property">"@vue/cli-service"</span><span class="token operator">:</span> <span class="token string">"~4.5.0"</span><span class="token punctuation">,</span>    <span class="token property">"@vue/compiler-sfc"</span><span class="token operator">:</span> <span class="token string">"^3.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"node-sass"</span><span class="token operator">:</span> <span class="token string">"^4.12.0"</span><span class="token punctuation">,</span>    <span class="token property">"sass-loader"</span><span class="token operator">:</span> <span class="token string">"^8.0.2"</span><span class="token punctuation">,</span>    <span class="token property">"typescript"</span><span class="token operator">:</span> <span class="token string">"~4.1.5"</span><span class="token punctuation">,</span>    <span class="token property">"vue-cli-plugin-windicss"</span><span class="token operator">:</span> <span class="token string">"~1.0.4"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"browserslist"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"> 1%"</span><span class="token punctuation">,</span>    <span class="token string">"last 2 versions"</span><span class="token punctuation">,</span>    <span class="token string">"not dead"</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å¼•å…¥Jquery"><a href="#å¼•å…¥Jquery" class="headerlink" title="å¼•å…¥Jquery"></a>å¼•å…¥Jquery</h3><p>é¡¹ç›®æ ¹ç›®å½•ä¸­æœ‰çš„è¯æ·»åŠ é‡Œé¢çš„å†…å®¹å³å¯ï¼Œæ²¡æœ‰çš„è¯ç›´æ¥æ–°å»ºå³å¯ã€‚</p><p>vue.config.js</p><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token comment">// è¿™é‡Œåªåˆ—ä¸€éƒ¨åˆ†ï¼Œå…·ä½“é…ç½®å‚è€ƒæ–‡æ¡£</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// å¼€å‘æœåŠ¡å™¨ä»£ç†</span>  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token string-property property">'^/api'</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'http://localhost:8001'</span><span class="token punctuation">,</span>        <span class="token literal-property property">ws</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token comment">// å¼•å…¥Jquery</span>      <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">$</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>        <span class="token literal-property property">jQuery</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>        <span class="token string-property property">'windows.jQuery'</span><span class="token operator">:</span> <span class="token string">'jquery'</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="axiosç®€å•çš„å°è£…"><a href="#axiosç®€å•çš„å°è£…" class="headerlink" title="axiosç®€å•çš„å°è£…"></a>axiosç®€å•çš„å°è£…</h3><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> axios<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> AxiosInstance<span class="token punctuation">,</span> AxiosRequestConfig<span class="token punctuation">,</span> AxiosResponse <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span><span class="token keyword">import</span> qs <span class="token keyword">from</span> <span class="token string">'qs'</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ElMessage <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'element-plus'</span><span class="token keyword">let</span> axiosInstance<span class="token operator">:</span> AxiosInstance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  baseURL<span class="token operator">:</span> <span class="token string">'/api'</span><span class="token punctuation">,</span>  <span class="token comment">// å»¶è¿Ÿ</span>  timeout<span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// axioså®ä¾‹æ‹¦æˆªè¯·æ±‚</span>axiosInstance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>  <span class="token punctuation">(</span>config<span class="token operator">:</span> AxiosRequestConfig<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">removePending</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token comment">// åœ¨è¯·æ±‚å¼€å§‹å‰ï¼Œå¯¹ä¹‹å‰çš„è¯·æ±‚åšæ£€æŸ¥å–æ¶ˆæ“ä½œ</span>    <span class="token function">addPending</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token comment">// å°†å½“å‰è¯·æ±‚æ·»åŠ åˆ° pending ä¸­</span>    config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>sa_token <span class="token operator">=</span> <span class="token string">'ken'</span>    <span class="token keyword">return</span> config<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span>error<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯·æ±‚é”™è¯¯æ‹¦æˆª'</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// axioså®ä¾‹æ‹¦æˆªå“åº”</span>axiosInstance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>  <span class="token punctuation">(</span>response<span class="token operator">:</span> AxiosResponse<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token function">removePending</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment">// è¯·æ±‚å¤±è´¥</span>  <span class="token punctuation">(</span>error<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">isCancel</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'repeated request: '</span> <span class="token operator">+</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// handle error code</span>      <span class="token comment">// é”™è¯¯æŠ›åˆ°ä¸šåŠ¡ä»£ç </span>      error<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>      error<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'è¯·æ±‚è¶…æ—¶æˆ–æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜ï¼'</span>      ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å£°æ˜ä¸€ä¸ª Map ç”¨äºå­˜å‚¨æ¯ä¸ªè¯·æ±‚çš„æ ‡è¯† å’Œ å–æ¶ˆå‡½æ•°</span><span class="token keyword">const</span> pending <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">/** * æ·»åŠ è¯·æ±‚ * @param &#123;Object&#125; config  */</span><span class="token keyword">const</span> <span class="token function-variable function">addPending</span> <span class="token operator">=</span> <span class="token punctuation">(</span>config<span class="token operator">:</span> AxiosRequestConfig<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token punctuation">[</span>    config<span class="token punctuation">.</span>method<span class="token punctuation">,</span>    config<span class="token punctuation">.</span>url<span class="token punctuation">,</span>    qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>    qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>  config<span class="token punctuation">.</span>cancelToken <span class="token operator">=</span> config<span class="token punctuation">.</span>cancelToken <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">axios</span><span class="token punctuation">.</span><span class="token function">CancelToken</span><span class="token punctuation">(</span>cancel <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pending<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¦‚æœ pending ä¸­ä¸å­˜åœ¨å½“å‰è¯·æ±‚ï¼Œåˆ™æ·»åŠ è¿›å»</span>      pending<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> cancel<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">/** * ç§»é™¤è¯·æ±‚ * @param &#123;Object&#125; config  */</span><span class="token keyword">const</span> <span class="token function-variable function">removePending</span> <span class="token operator">=</span> <span class="token punctuation">(</span>config<span class="token operator">:</span> AxiosRequestConfig<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token punctuation">[</span>    config<span class="token punctuation">.</span>method<span class="token punctuation">,</span>    config<span class="token punctuation">.</span>url<span class="token punctuation">,</span>    qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>    qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>pending<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¦‚æœåœ¨ pending ä¸­å­˜åœ¨å½“å‰è¯·æ±‚æ ‡è¯†ï¼Œéœ€è¦å–æ¶ˆå½“å‰è¯·æ±‚ï¼Œå¹¶ä¸”ç§»é™¤</span>    <span class="token keyword">const</span> cancel <span class="token operator">=</span> pending<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token function">cancel</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>    pending<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * æ¸…ç©º pending ä¸­çš„è¯·æ±‚ï¼ˆåœ¨è·¯ç”±è·³è½¬æ—¶è°ƒç”¨ï¼‰ */</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">clearPending</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>url<span class="token punctuation">,</span> cancel<span class="token punctuation">]</span> <span class="token keyword">of</span> pending<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">cancel</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span>  pending<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">export</span> <span class="token keyword">default</span> axiosInstance<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è·¯ç”±çš„ç®€å•é…ç½®ï¼ˆVue-routerï¼‰"><a href="#è·¯ç”±çš„ç®€å•é…ç½®ï¼ˆVue-routerï¼‰" class="headerlink" title="è·¯ç”±çš„ç®€å•é…ç½®ï¼ˆVue-routerï¼‰"></a>è·¯ç”±çš„ç®€å•é…ç½®ï¼ˆVue-routerï¼‰</h3><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createRouter<span class="token punctuation">,</span> createWebHashHistory<span class="token punctuation">,</span> RouteRecordRaw <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token keyword">const</span> routes<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>RouteRecordRaw<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">&#123;</span>    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>    redirect<span class="token operator">:</span> <span class="token string">'/home'</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token punctuation">&#123;</span>    path<span class="token operator">:</span> <span class="token string">'/home/:type'</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    alias<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/home'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    props<span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token punctuation">&#123;</span>    path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">'About'</span><span class="token punctuation">,</span>    <span class="token comment">// route level code-splitting</span>    <span class="token comment">// this generates a separate chunk (about.[hash].js) for this route</span>    <span class="token comment">// which is lazy-loaded when the route is visited.</span>    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/About.vue'</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  routes<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// å…¨å±€å‰ç½®æ‹¦æˆª</span>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å…¨å±€å‰ç½®æ‹¦æˆª'</span><span class="token punctuation">)</span>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">export</span> <span class="token keyword">default</span> router<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å…¨å±€çš„çŠ¶æ€ç®¡ç†ï¼ˆVuexï¼‰"><a href="#å…¨å±€çš„çŠ¶æ€ç®¡ç†ï¼ˆVuexï¼‰" class="headerlink" title="å…¨å±€çš„çŠ¶æ€ç®¡ç†ï¼ˆVuexï¼‰"></a>å…¨å±€çš„çŠ¶æ€ç®¡ç†ï¼ˆVuexï¼‰</h3><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createStore<span class="token punctuation">,</span> Store <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'@vue/runtime-core'</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">interface</span> <span class="token class-name">Photo</span> <span class="token punctuation">&#123;</span>    src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">// declare your own store states</span>  <span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">&#123;</span>    dark<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>    count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>    user<span class="token operator">:</span> <span class="token punctuation">&#123;</span>      name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>      age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>      photoList<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>Photo<span class="token operator">></span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">// provide typings for `this.$store`</span>  <span class="token keyword">interface</span> <span class="token class-name">ComponentCustomProperties</span> <span class="token punctuation">&#123;</span>    $store<span class="token operator">:</span> Store<span class="token operator">&lt;</span>State<span class="token operator">></span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  state<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    dark<span class="token operator">:</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'dackModel'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'dackModel'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    count<span class="token operator">:</span> <span class="token number">112</span><span class="token punctuation">,</span>    user<span class="token operator">:</span> <span class="token punctuation">&#123;</span>      name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>      age<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>      photoList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>        src<span class="token operator">:</span> <span class="token string">'test'</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  getters<span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  mutations<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token function">switchDarkMode</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      state<span class="token punctuation">.</span>dark <span class="token operator">=</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>dark      <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>dark<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'dark'</span><span class="token punctuation">)</span>        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'dackModel'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'dark'</span><span class="token punctuation">)</span>        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'dackModel'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  actions<span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  modules<span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é¡¹ç›®çš„main-ts"><a href="#é¡¹ç›®çš„main-ts" class="headerlink" title="é¡¹ç›®çš„main.ts"></a>é¡¹ç›®çš„main.ts</h3><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createApp <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token keyword">import</span> ElementPlus <span class="token keyword">from</span> <span class="token string">'element-plus'</span><span class="token keyword">import</span> <span class="token string">'element-plus/dist/index.css'</span><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span><span class="token keyword">import</span> <span class="token string">'windi.css'</span><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span><span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementPlus<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1gpo8t35xs5j33341r8qv5.jpg" alt="å°‘å¥³é©¬å°¾è¾« å¤œæ™š ç”µè„‘ å¬éŸ³ä¹"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>typescipt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>yarnå’Œnpmæ“ä½œæŒ‡å—</title>
    <link href="/2021/08/30/vue-04/"/>
    <url>/2021/08/30/vue-04/</url>
    
    <content type="html"><![CDATA[<p>NPMè€ç‰Œå·¥å…·ï¼ŒYarnåèµ·ä¹‹ç§€ã€‚ä½œä¸ºä¸€ä¸ªåç«¯ç¨‹åºå‘˜ï¼Œå¯ä»¥ç†è§£æˆMavenå’ŒGradleã€‚Node.jsä¸ºJSè¿™ä¸ªåŸæœ¬åªèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„è¯­è¨€ï¼Œæä¾›äº†ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œä½ å¯ä»¥ç†è§£æˆJavaçš„JDKï¼Œä½¿åŸæœ¬è¢«æµè§ˆå™¨é™åˆ¶çš„JSæ”¾é£è‡ªæˆ‘äº†ã€‚</p><p>NPMå’ŒYarnéƒ½æ˜¯é¡¹ç›®ç®¡ç†å·¥å…·ã€‚æ ¸å¿ƒæ˜¯ç®¡ç†ä¾èµ–çš„åŠŸèƒ½ï¼Œä¸ºé¡¹ç›®çš„è¿è¡Œæä¾›ä¸€äº›æ”¯æŒã€‚</p><h2 id="æŸ¥çœ‹npmï¼Œyarnå…¨å±€å®‰è£…çš„åŒ…"><a href="#æŸ¥çœ‹npmï¼Œyarnå…¨å±€å®‰è£…çš„åŒ…" class="headerlink" title="æŸ¥çœ‹npmï¼Œyarnå…¨å±€å®‰è£…çš„åŒ…"></a>æŸ¥çœ‹npmï¼Œyarnå…¨å±€å®‰è£…çš„åŒ…</h2><p>npm</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> list -g --depth <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>yarn</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">yarn</span> global list<span class="token comment"># æˆ–è€…</span><span class="token function">yarn</span> global list --depth<span class="token operator">=</span><span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="nrmç›¸å…³å‘½ä»¤"><a href="#nrmç›¸å…³å‘½ä»¤" class="headerlink" title="nrmç›¸å…³å‘½ä»¤"></a>nrmç›¸å…³å‘½ä»¤</h2><p>nrm(npm registry manager )æ˜¯npmçš„é•œåƒæºç®¡ç†å·¥å…·ï¼Œæœ‰æ—¶å€™å›½å¤–èµ„æºå¤ªæ…¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ¥åˆ‡æ¢é•œåƒæºã€‚<br><strong>å®‰è£…nrm</strong></p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g nrm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="åˆ—å‡ºå¯ç”¨æº"><a href="#åˆ—å‡ºå¯ç”¨æº" class="headerlink" title="åˆ—å‡ºå¯ç”¨æº"></a>åˆ—å‡ºå¯ç”¨æº</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nrm <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="åˆ‡æ¢æº"><a href="#åˆ‡æ¢æº" class="headerlink" title="åˆ‡æ¢æº"></a>åˆ‡æ¢æº</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nrm use taobao<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="npm-x2F-yarnæŸ¥çœ‹å½“å‰ä½¿ç”¨æºä¸è®¾ç½®å…¶å®ƒæº"><a href="#npm-x2F-yarnæŸ¥çœ‹å½“å‰ä½¿ç”¨æºä¸è®¾ç½®å…¶å®ƒæº" class="headerlink" title="npm&#x2F;yarnæŸ¥çœ‹å½“å‰ä½¿ç”¨æºä¸è®¾ç½®å…¶å®ƒæº"></a>npm&#x2F;yarnæŸ¥çœ‹å½“å‰ä½¿ç”¨æºä¸è®¾ç½®å…¶å®ƒæº</h2><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æŸ¥çœ‹npmå½“å‰é•œåƒæº</span><span class="token function">npm</span> config get registry  <span class="token comment"># è®¾ç½®npmå½“å‰é•œåƒæº</span><span class="token function">npm</span> config <span class="token builtin class-name">set</span> registry https://registry.npmjs.org<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="yarn"><a href="#yarn" class="headerlink" title="yarn"></a>yarn</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æŸ¥çœ‹yarnå½“å‰é•œåƒæº</span><span class="token function">yarn</span> config get registry<span class="token comment"># è®¾ç½®yarnå½“å‰é•œåƒæº</span><span class="token function">yarn</span> config <span class="token builtin class-name">set</span> registry https://registry.yarnpkg.com <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><p>è¿™ä¸ªæˆ‘æ˜¯çœŸçš„ä¸æ˜¯å¾ˆæƒ³å†™ï¼Œå› ä¸ºè¿™ä¸œè¥¿å®˜ç½‘ä¸Šå¾ˆè¯¦ç»†ï¼Œè€Œä¸”ä¸€ç‚¹è¿›å»å°±èƒ½çœ‹åˆ°ï¼Œæœ‰äº›ä¸œè¥¿ï¼Œåœ¨å®˜ç½‘ä¸Šè—å¾—æ¯”è¾ƒæ·±ï¼Œåˆæˆ–è€…è¯­è¨€ä¸åŒçš„é—®é¢˜ã€‚yarnæœ‰ä¸ªæ•·è¡çš„ä¸­æ–‡å®˜ç½‘ï¼Œnpmè¿æ•·è¡éƒ½ä¸æ•·è¡ï¼Œå¤§å®¶ä¼˜å…ˆç”¨å“ªä¸ªçŸ¥é“äº†ä¹ˆğŸ¤£ğŸ¤£ğŸ¤£</p><h3 id="yarnå¸¸ç”¨"><a href="#yarnå¸¸ç”¨" class="headerlink" title="yarnå¸¸ç”¨"></a>yarnå¸¸ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å…¨å±€æ·»åŠ ä¾èµ–ï¼Œæ·»åŠ å…¨å±€ä¾èµ–å»ºè®®yarnå’Œnpmä¸¤è€…é€‰å…¶ä¸€ï¼Œ</span><span class="token comment"># å¦‚æœåŒæ—¶éƒ½æ·»åŠ äº†å…¨å±€ä¾èµ–ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å“ªä¸ªä¼˜å…ˆã€‚</span><span class="token comment"># æ‰€ä»¥äºŒè€…é€‰å…¶ä¸€å³å¯</span><span class="token function">yarn</span> global <span class="token function">add</span> <span class="token operator">&lt;</span>package<span class="token punctuation">..</span>.<span class="token operator">></span><span class="token comment"># æ­£å¸¸é¡¹ç›®ä¸­çš„æ·»åŠ ä¾èµ–ï¼ˆé»˜è®¤æ·»åŠ åˆ°è¿è¡Œä¾èµ–ä¸­ï¼‰</span><span class="token function">yarn</span> <span class="token function">add</span> <span class="token operator">&lt;</span>package<span class="token punctuation">..</span>.<span class="token operator">></span><span class="token comment"># ä½¿ç”¨--devæˆ–-Då°†åœ¨æ‚¨çš„ å¼€å‘ä¾èµ–ä¸­ï¼Œå’Œè¿è¡Œä¾èµ–çš„åŒºåˆ«å°±æ˜¯æ‰“åŒ…æ—¶å¼€å‘ä¾èµ–ä¸æ‰“åŒ…è¿›å»</span><span class="token function">yarn</span> <span class="token function">add</span> <span class="token operator">&lt;</span>package<span class="token punctuation">..</span>.<span class="token operator">></span> <span class="token punctuation">[</span>--dev/-D<span class="token punctuation">]</span><span class="token comment"># åˆ é™¤ä¾èµ–ï¼ŒåŒæ—¶åˆ é™¤å¼€å‘ä¾èµ–å’Œè¿è¡Œä¾èµ–</span><span class="token function">yarn</span> remove <span class="token operator">&lt;</span>package<span class="token punctuation">..</span>.<span class="token operator">></span><span class="token comment"># å®‰è£…æœ¬åœ°node_modulesæ–‡ä»¶å¤¹ä¸­package.jsonä¸­åˆ—å‡ºçš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚(è¿™ç™¾åº¦ç¿»è¯‘ç¿»è¯‘çš„å¯ä»¥å•Š)</span><span class="token function">yarn</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="npmå¸¸ç”¨"><a href="#npmå¸¸ç”¨" class="headerlink" title="npmå¸¸ç”¨"></a>npmå¸¸ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¯¹åº” yarn install</span><span class="token function">npm</span> <span class="token function">install</span><span class="token comment"># å¯¹åº” yarn add &lt;package...></span><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span>package<span class="token punctuation">]</span> --save<span class="token comment"># å¯¹åº” yarn add &lt;package...> [--dev/-D]</span><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span>package<span class="token punctuation">]</span> --save-dev<span class="token comment"># å¯¹åº” yarn global add &lt;package...></span><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span>package<span class="token punctuation">]</span> --global<span class="token comment"># å¯¹åº” yarn remove &lt;package...></span><span class="token function">npm</span> uninstall <span class="token punctuation">[</span>package<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹ï¼Œè¯¦ç»†çš„å¯ä»¥å»å®˜ç½‘ä¸Šè‡ªè¡ŒæŸ¥çœ‹ï¼Œè¿™é‡Œåªåˆ—ä¸¾äº†ä¸€äº›å¸¸ç”¨çš„ã€‚</p><h2 id="å¿«é€Ÿåˆ é™¤node-modulesæ–‡ä»¶"><a href="#å¿«é€Ÿåˆ é™¤node-modulesæ–‡ä»¶" class="headerlink" title="å¿«é€Ÿåˆ é™¤node_modulesæ–‡ä»¶"></a>å¿«é€Ÿåˆ é™¤node_modulesæ–‡ä»¶</h2><h3 id="ä½¿ç”¨rimrafæ¨¡å—çš„å‘½ä»¤"><a href="#ä½¿ç”¨rimrafæ¨¡å—çš„å‘½ä»¤" class="headerlink" title="ä½¿ç”¨rimrafæ¨¡å—çš„å‘½ä»¤"></a>ä½¿ç”¨rimrafæ¨¡å—çš„å‘½ä»¤</h3><p>å…¨å±€å®‰è£…rimrafæ¨¡å—ï¼Œç„¶åé€šè¿‡å…¶å‘½ä»¤æ¥å¿«é€Ÿåˆ é™¤node_modulesç›®å½•ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> rimraf -g<span class="token comment"># è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ä¸­</span>rimraf node_modules<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ä½¿ç”¨å‘½ä»¤æ¥åˆ é™¤ç›®å½•"><a href="#ä½¿ç”¨å‘½ä»¤æ¥åˆ é™¤ç›®å½•" class="headerlink" title="ä½¿ç”¨å‘½ä»¤æ¥åˆ é™¤ç›®å½•"></a>ä½¿ç”¨å‘½ä»¤æ¥åˆ é™¤ç›®å½•</h3><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><p>é¦–å…ˆåœ¨cmdçª—å£ä¸­è¿›å…¥åˆ°node_modulesæ–‡ä»¶å¤¹æ‰€åœ¨çš„è·¯å¾„ï¼Œæ¥ç€æ‰§è¡Œå‘½ä»¤ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rmdir</span> /s/q node_modules<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="linuxä¸‹"><a href="#linuxä¸‹" class="headerlink" title="linuxä¸‹"></a>linuxä¸‹</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rm</span> -f /node_modules<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva4.sinaimg.cn/large/005NNTS5ly1gt3p80og1jj338q1o0b2a.jpg" alt="ç¾å°‘å¥³"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yarn</tag>
      
      <tag>npm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excelå¯¼å…¥å¯¼å‡ºã€‚</title>
    <link href="/2021/08/16/java-02/"/>
    <url>/2021/08/16/java-02/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>ä»‹ç»ä¸€ä¸‹Excelçš„å¯¼å…¥å¯¼å‡ºï¼Œç”¨åˆ°çš„å¼€æºé¡¹ç›®MyExcelï¼Œè¿™æ˜¯ä¸ªååˆ†å¥½ç”¨çš„è½®å­ï¼Œå¼€å‘è€…çš„ä»£ç åŠŸåº•ååˆ†äº†å¾—ï¼Œ</p><p>è¯´èµ·è¿™ä¸ªâ€™äº†å¾—â€˜ï¼Œæœ‰æ„æ€çš„æ˜¯äº†å¾—å’Œäº†ä¸å¾—ï¼Œæ˜¯ä¸€ä¸ªæ„æ€ã€‚ä»£ç åŠŸåº•ååˆ†äº†å¾—ï¼Œä»£ç åŠŸåº•ååˆ†äº†ä¸å¾—ï¼Œè¡¨è¾¾çš„æ˜¯ä¸€ä¸ªæ„æ€ã€‚ä¸­å›½çš„æ–‡å­—ï¼Œç¡®å®æœ‰ç‚¹éš¾ä¸ºè€å¤–ã€‚</p><p>è¿™ä¸ªé¡¹ç›®çš„æ–‡æ¡£å·²ç»è¯¦ç»†åˆ°ä¸€ç§è®©äººæ„Ÿè§‰åˆ°å•°å—¦çš„åœ°æ­¥ï¼ŒåŠŸèƒ½ä¹Ÿååˆ†å¥å£®ï¼Œæ¶µç›–äº†å„ç§ä½¿ç”¨åœºæ™¯ã€‚è¯ä¸å¤šè¯´ã€‚è¿›å…¥æ­£æ–‡</p>          </div><h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><blockquote><p>ç‰ˆæœ¬å·å»ºè®®ä¸€è‡´ï¼Œé¡¹ç›®ä¸­å¦‚æœæœ‰ä¹‹å‰çš„POIçš„ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´ç‰ˆæœ¬å†²çªï¼Œè§£å†³ä¾èµ–å†²çªçš„æ–¹æ³•ï¼Œè¯·è‡ªè¡Œç™¾åº¦ã€‚</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--excelå¯¼å…¥å¯¼å‡º--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.github.liaochong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>myexcel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.11.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ä½¿ç”¨æ¨¡æ¿å¯¼å‡ºæ—¶è¿‡ç¨‹ä¸­å¦‚æœæŠ¥åŒ…å«Ognlå…³é”®å­—çš„å¼‚å¸¸ï¼Œå¯¼å…¥æ­¤ä¾èµ–--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ognl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>ognl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.2.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Excelå¯¼å…¥"><a href="#Excelå¯¼å…¥" class="headerlink" title="Excelå¯¼å…¥"></a>Excelå¯¼å…¥</h2><p>å¯¼å…¥åˆ†ä¸ºä¸€èˆ¬å¯¼å…¥ã€saxå¯¼å…¥ï¼ŒäºŒè€…çš„åŒºåˆ«åœ¨äºsaxå¯¼å…¥æ›´å…³æ³¨å†…å­˜ï¼Œå†…å­˜ä½¿ç”¨æ›´å°‘ï¼Œä¸”saxæ–¹å¼å¯¼å…¥åŠŸèƒ½å¢å¼ºï¼Œå»ºè®®ä½¿ç”¨saxæ–¹å¼å¯¼å…¥ï¼ˆå¯è¯»å–å…¬å¼å€¼ï¼‰</p><h3 id="ä¸€èˆ¬å¯¼å…¥ï¼ˆä¸æ”¯æŒcsvæ–‡ä»¶å¯¼å…¥ï¼Œæ”¯æŒå›¾ç‰‡è¯»å–ï¼‰"><a href="#ä¸€èˆ¬å¯¼å…¥ï¼ˆä¸æ”¯æŒcsvæ–‡ä»¶å¯¼å…¥ï¼Œæ”¯æŒå›¾ç‰‡è¯»å–ï¼‰" class="headerlink" title="ä¸€èˆ¬å¯¼å…¥ï¼ˆä¸æ”¯æŒcsvæ–‡ä»¶å¯¼å…¥ï¼Œæ”¯æŒå›¾ç‰‡è¯»å–ï¼‰"></a>ä¸€èˆ¬å¯¼å…¥ï¼ˆä¸æ”¯æŒcsvæ–‡ä»¶å¯¼å…¥ï¼Œæ”¯æŒå›¾ç‰‡è¯»å–ï¼‰</h3><p>ä¸€èˆ¬å¯¼å…¥åˆåˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¸¤ç§æ–¹å¼çš„åŒºåˆ«ï¼š</p><ul><li>å…¨éƒ¨è¯»å–ï¼šé€Ÿåº¦å¿«ï¼Œç›¸å¯¹ä¸€è¡Œä¸€è¡Œè¯»å–è¦å å†…å­˜ä¸€ç‚¹</li><li>ä¸€è¡Œä¸€è¡Œè¯»å–ï¼šçœå†…å­˜ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ä¸æ˜“å¼•å‘OOM</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">URL</span> htmlToExcelEampleURL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">"/templates/read_example.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Path</span> path <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>htmlToExcelEampleURL<span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ–¹å¼ä¸€ï¼šå…¨éƒ¨è¯»å–åå¤„ç†</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token class-name">DefaultExcelReader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 0ä»£è¡¨ç¬¬ä¸€ä¸ªï¼Œå¦‚æœä¸º0ï¼Œå¯çœç•¥è¯¥æ“ä½œï¼Œä¹Ÿå¯sheet("åç§°")è¯»å–</span>        <span class="token punctuation">.</span><span class="token function">rowFilter</span><span class="token punctuation">(</span>row <span class="token operator">-></span> row<span class="token punctuation">.</span><span class="token function">getRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// å¦‚æ— éœ€è¿‡æ»¤ï¼Œå¯çœç•¥è¯¥æ“ä½œï¼Œ0ä»£è¡¨ç¬¬ä¸€è¡Œ</span>        <span class="token punctuation">.</span><span class="token function">beanFilter</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token operator">::</span><span class="token function">isDance</span><span class="token punctuation">)</span> <span class="token comment">// beanè¿‡æ»¤</span>        <span class="token punctuation">.</span><span class="token function">startSheet</span><span class="token punctuation">(</span>sheet<span class="token operator">-></span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// åœ¨å¼€å§‹è¯»å–sheetå‰æ‰§è¡ŒæŒ‡å®šæ“ä½œ</span>        <span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¯æ¥æ”¶inputStream</span><span class="token comment">// æ–¹å¼äºŒï¼šè¯»å–ä¸€è¡Œå¤„ç†ä¸€è¡Œï¼Œå¯è‡ªè¡Œå†³å®šç»ˆæ­¢æ¡ä»¶</span><span class="token comment">// readThenæœ‰ä¸¤ç§é‡å†™æ¥å£ï¼Œè¿”å›Booleanå‹æ¥å£å…è®¸åœ¨è¿”å›Falseæƒ…å†µä¸‹ç›´æ¥ç»ˆæ­¢è¯»å–</span><span class="token class-name">DefaultExcelReader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 0ä»£è¡¨ç¬¬ä¸€ä¸ªï¼Œå¦‚æœä¸º0ï¼Œå¯çœç•¥è¯¥æ“ä½œï¼Œä¹Ÿå¯sheet("åç§°")è¯»å–</span>        <span class="token punctuation">.</span><span class="token function">rowFilter</span><span class="token punctuation">(</span>row <span class="token operator">-></span> row<span class="token punctuation">.</span><span class="token function">getRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// å¦‚æ— éœ€è¿‡æ»¤ï¼Œå¯çœç•¥è¯¥æ“ä½œï¼Œ0ä»£è¡¨ç¬¬ä¸€è¡Œ</span>        <span class="token punctuation">.</span><span class="token function">beanFilter</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token operator">::</span><span class="token function">isDance</span><span class="token punctuation">)</span> <span class="token comment">// beanè¿‡æ»¤</span>        <span class="token punctuation">.</span><span class="token function">readThen</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>artCrowd <span class="token operator">-></span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>artCrowd<span class="token punctuation">.</span>getName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¯æ¥æ”¶inputStream</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArtCrowd</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// indexä»£è¡¨åˆ—ç´¢å¼•ï¼Œä»0å¼€å§‹</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> age<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>format<span class="token operator">=</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-info">            <p>å¯ä¸ä½¿ç”¨@ExcelColumnæ³¨è§£ï¼Œå¦‚ä¸ä½¿ç”¨ï¼Œåˆ™ä½¿ç”¨å­—æ®µé»˜è®¤é¡ºåºè¯»å–ï¼Œæ„æ€æ˜¯ã€‚excelä¸­ä»å·¦åˆ°å³ï¼Œå¯¹åº”beanä¸­ä»ä¸Šåˆ°ä¸‹ã€‚</p>          </div><h2 id="Excelé»˜è®¤å¯¼å‡º"><a href="#Excelé»˜è®¤å¯¼å‡º" class="headerlink" title="Excelé»˜è®¤å¯¼å‡º"></a>Excelé»˜è®¤å¯¼å‡º</h2><p>é»˜è®¤å¯¼å‡ºé‡‡ç”¨æ™®é€šæ–¹å¼å¯¼å‡ºList&lt; Bean &gt;ï¼Œé€‚åˆå°æ•°æ®é‡åœºæ™¯ï¼Œå¦‚æ•°æ®é‡å¾ˆå¤§-10ä¸‡+ï¼Œå»ºè®®ä½¿ç”¨DefaultStreamExcelBuilderï¼Œé¿å…å†…å­˜å ç”¨è¿‡å¤šã€‚<br><strong>å¯¼å‡ºéœ€ä½¿ç”¨åˆ°å¦‚ä¸‹æ³¨è§£</strong></p><ul><li>@ExcelModel(includeAllField,excludeParent,workbookType,sheetName,useFieldNameAsTitle,defaultValue)ï¼ˆå¯é€‰ï¼Œç”¨äºå…¨å±€è®¾å®šï¼Œ ä¸€èˆ¬æƒ…å†µä¸‹åªéœ€è¦ä½¿ç”¨sheetNameï¼‰</li><li>@IgnoreColumnï¼ˆå¯é€‰ï¼Œç”¨äºæ’å‡ºä¸éœ€è¦å¯¼å‡ºçš„å­—æ®µï¼‰</li><li>@ExcelColumn(title,order,format,groups,defaultValue,style)</li></ul><blockquote><p>é»˜è®¤å¯¼å‡ºé»˜è®¤è®¡ç®—å®½åº¦ã€æ–‘é©¬çº¿èƒŒæ™¯è‰²ï¼Œè‹¥æ— éœ€ä¸Šè¿°æ ·å¼ï¼Œè¯·è°ƒç”¨ noStyle() æ–¹æ³•</p></blockquote><p>å¯¹åº”æ³¨è§£è¯¦æƒ…è¯·è§ï¼š<a href="#%E6%B3%A8%E8%A7%A3">æ³¨è§£</a></p><p><code>é™„ä»¶å¯¼å‡ºç¤ºä¾‹ï¼š</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/default/excel/example"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">defaultBuild</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">"è‰ºæœ¯ç”Ÿä¿¡æ¯"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>é™„ä»¶åŠ å¯†å¯¼å‡ºç¤ºä¾‹ï¼š</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/default/excel/example"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">defaultBuild</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">encryptExport</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">"è‰ºæœ¯ç”Ÿä¿¡æ¯"</span><span class="token punctuation">,</span> response<span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>æ–‡ä»¶å¯¼å‡ºç¤ºä¾‹ï¼š</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>         <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">FileExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/User/demo.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>æ–‡ä»¶åŠ å¯†å¯¼å‡ºç¤ºä¾‹ï¼š</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>         <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">FileExportUtil</span><span class="token punctuation">.</span><span class="token function">encryptExport</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/User/demo.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>å•çº¯æ•°æ®è·å–ï¼š</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> <span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ArtCrowd</span> artCrowd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArtCrowd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"æå››"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">"Woman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setPaintingLevel</span><span class="token punctuation">(</span><span class="token string">"ä¸€çº§è¯ä¹¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setDance</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setAssessmentTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         artCrowd<span class="token punctuation">.</span><span class="token function">setHobby</span><span class="token punctuation">(</span><span class="token string">"é’“é±¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>artCrowd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> dataList<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@ExcelModel</span><span class="token punctuation">(</span>sheetName <span class="token operator">=</span> <span class="token string">"è‰ºæœ¯ç”Ÿ"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArtCrowd</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"å§“å"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"å¹´é¾„"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"æ€§åˆ«"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>title <span class="token operator">=</span> <span class="token string">"ç»˜ç”»ç­‰çº§"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> paintingLevel<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"æ˜¯å¦ä¼šè·³èˆ"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> dance<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"è€ƒæ ¸æ—¶é—´"</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> assessmentTime<span class="token punctuation">;</span>    <span class="token annotation punctuation">@IgnoreColumn</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> hobby<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Excelæ¨¡æ¿æ„å»º"><a href="#Excelæ¨¡æ¿æ„å»º" class="headerlink" title="Excelæ¨¡æ¿æ„å»º"></a>Excelæ¨¡æ¿æ„å»º</h2><blockquote><p>æ‰€æœ‰Excelæ„å»ºå™¨å‡ä¸å¯å•ä¾‹åŒ–ï¼ŒåŠ¡å¿…æ³¨æ„ï¼ï¼ï¼<br>æ¨¡æ¿æ„å»ºï¼Œæ ¸å¿ƒåŸç†æ˜¯æ ¹æ®æ¨¡æ¿å¼•æ“æ¸²æŸ“å‡ºç¬¦åˆéœ€æ±‚å¸ƒå±€çš„Html Tableå…ƒç´ ï¼Œæ„å»ºå™¨è¿­ä»£tableå…ƒç´ ä¸­çš„å•å…ƒæ ¼æ¸²æŸ“å‡ºExcelå•å…ƒæ ¼ã€‚</p></blockquote><h3 id="å¯¼å‡ºæ¨¡æ¿å¼•æ“é€‰å®š"><a href="#å¯¼å‡ºæ¨¡æ¿å¼•æ“é€‰å®š" class="headerlink" title="å¯¼å‡ºæ¨¡æ¿å¼•æ“é€‰å®š"></a>å¯¼å‡ºæ¨¡æ¿å¼•æ“é€‰å®š</h3><blockquote><p>ä»¥ä¸‹æ¨¡æ¿å¼•æ“é»˜è®¤å‡æœªè¢«å¼•å…¥ï¼Œä½¿ç”¨è€…å¯æ ¹æ®è‡ªèº«éœ€è¦é€‰æ‹©åœ¨pom.xmlä¸­å£°æ˜å¼•å…¥ã€‚<br>ä»¥ä¸‹æ¨¡æ¿å¼•æ“ç‰ˆæœ¬ä¸ºæœ€ä½ç‰ˆæœ¬å·ã€‚</p></blockquote><p>ä½¿ç”¨æ—¶æ ¹æ®å®é™…éœ€è¦è‡ªè¡Œé€‰æ‹©å°±è¡Œäº†ï¼Œæˆ–è€…ä½ ä¼šå“ªä¸ªå¼•æ“å°±ç”¨å“ªä¸ªå¼•æ“å°±Okã€‚</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ibeetl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>beetl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.7.23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.codehaus.groovy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>groovy-templates<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.4.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.velocity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>velocity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.jfinal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>enjoy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Workbookç”Ÿæˆ"><a href="#Workbookç”Ÿæˆ" class="headerlink" title="Workbookç”Ÿæˆ"></a>Workbookç”Ÿæˆ</h3><p>å·²å­˜åœ¨Htmlæ–‡ä»¶æ—¶ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ï¼ŒHtmlæ–‡ä»¶ä¸å±€é™äºæ”¾åœ¨é¡¹ç›®çš„classpathï¼ˆå¦‚ï¼šresourcesï¼‰ä¸‹ï¼Œä¹Ÿæ— éœ€æ¨¡æ¿å¼•æ“</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// get html file</span><span class="token class-name">File</span> htmlFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/Users/liaochong/Downloads/example.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// read the html file and use default excel style to create excel</span><span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">HtmlToExcelFactory</span><span class="token punctuation">.</span><span class="token function">readHtml</span><span class="token punctuation">(</span>htmlFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">useDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// this is a example,you can write the workbook to any valid outputstream</span><span class="token class-name">FileExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/Users/liaochong/Downloads/excel.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä½¿ç”¨å†…ç½®çš„Freemarkerç­‰æ¨¡æ¿å¼•æ“Excelæ„å»ºå™¨ï¼Œæ¨¡æ¿æ–‡ä»¶åº”å½“å­˜æ”¾åœ¨classpathä¸‹ï¼Œå…·ä½“è¯·å‚ç…§é¡¹ç›®ä¸­çš„example</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*** use non-default-style excel builder* æ¨¡æ¿æ–‡ä»¶æ”¾ç½®åœ¨resourcesä¸‹** @param response response*/</span><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/freemarker/example"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> dataMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ExcelBuilder</span> excelBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FreemarkerExcelBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> excelBuilder                   <span class="token comment">// fileTemplate(dirPath,fileName)</span>                   <span class="token punctuation">.</span><span class="token function">classpathTemplate</span><span class="token punctuation">(</span><span class="token string">"/templates/freemarkerToExcelExample.ftl"</span><span class="token punctuation">)</span>                   <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">"freemarker_excel"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** use default-style excel builder* æ¨¡æ¿æ–‡ä»¶æ”¾ç½®åœ¨resourcesä¸‹** @param response response*/</span><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/freemarker/defaultStyle/example"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildWithDefaultStyle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> dataMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ExcelBuilder</span> excelBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FreemarkerExcelBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> excelBuilder                  <span class="token comment">// fileTemplate(dirPath,fileName)</span>                  <span class="token punctuation">.</span><span class="token function">classpathTemplate</span><span class="token punctuation">(</span><span class="token string">"/templates/freemarkerToExcelExample.ftl"</span><span class="token punctuation">)</span>                  <span class="token punctuation">.</span><span class="token function">useDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">"freemarker_excel"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">getDataMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sheetName"</span><span class="token punctuation">,</span> <span class="token string">"freemarker_excel_example"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> titles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    titles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"Category"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    titles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"Product Name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    titles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"Count"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"titles"</span><span class="token punctuation">,</span> titles<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            product<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">"è”¬èœ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å°ç™½èœ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            product<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            product<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">"ç”µå­äº§å“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"ipad"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            product<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> dataMap<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="æ¨¡æ¿ç¤ºä¾‹"><a href="#æ¨¡æ¿ç¤ºä¾‹" class="headerlink" title="æ¨¡æ¿ç¤ºä¾‹"></a>æ¨¡æ¿ç¤ºä¾‹</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caption</span><span class="token punctuation">></span></span>$&#123;sheetName&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caption</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span> #6495ED</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">colspan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span><span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>äº§å“ä»‹ç»<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">titles</span> <span class="token attr-name">as</span> <span class="token attr-name">title</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>$&#123;title&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">data</span> <span class="token attr-name">as</span> <span class="token attr-name">item</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$&#123;item.category&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$&#123;item.name&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>$&#123;item.count&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">url</span><span class="token punctuation">></span></span>ç™¾åº¦åœ°å€<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ¨¡æ¿ä¸­çš„æ ·å¼è¯·çœ‹è¿™é‡Œ<a href="#%E6%A0%B7%E5%BC%8F%E6%94%AF%E6%8C%81">æ ·å¼æ”¯æŒ</a></p><h2 id="csvæ–‡ä»¶å¯¼å‡º"><a href="#csvæ–‡ä»¶å¯¼å‡º" class="headerlink" title="csvæ–‡ä»¶å¯¼å‡º"></a>csvæ–‡ä»¶å¯¼å‡º</h2><h3 id="ä¸€èˆ¬æ–¹å¼å¯¼å‡º"><a href="#ä¸€èˆ¬æ–¹å¼å¯¼å‡º" class="headerlink" title="ä¸€èˆ¬æ–¹å¼å¯¼å‡º"></a>ä¸€èˆ¬æ–¹å¼å¯¼å‡º</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">Csv</span> csv <span class="token operator">=</span> <span class="token class-name">CsvBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>csv<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"test.csv"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// csv.write(Paths.get("/User/append.csv"));</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Mapå¯¼å‡º"><a href="#Mapå¯¼å‡º" class="headerlink" title="Mapå¯¼å‡º"></a>Mapå¯¼å‡º</h3><blockquote><p>Mapç±»å‹ä¸ºMap&lt;String,Object&gt;</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">Csv</span> csv <span class="token operator">=</span> <span class="token class-name">CsvBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token function">getMapList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>csv<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"test.csv"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// csv.write(Paths.get("/User/append.csv"));</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è¿½åŠ æ–¹å¼å¯¼å‡º"><a href="#è¿½åŠ æ–¹å¼å¯¼å‡º" class="headerlink" title="è¿½åŠ æ–¹å¼å¯¼å‡º"></a>è¿½åŠ æ–¹å¼å¯¼å‡º</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">CsvBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CsvPeople</span><span class="token punctuation">></span></span> csvBuilder <span class="token operator">=</span> <span class="token class-name">CsvBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        csvBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">Csv</span> csv <span class="token operator">=</span> csvBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>csv<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"test.csv"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// csv.write(Paths.get("/User/append.csv"));</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="äºŒæ¬¡æ–‡ä»¶è¿½åŠ "><a href="#äºŒæ¬¡æ–‡ä»¶è¿½åŠ " class="headerlink" title="äºŒæ¬¡æ–‡ä»¶è¿½åŠ "></a>äºŒæ¬¡æ–‡ä»¶è¿½åŠ </h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">CsvBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CsvPeople</span><span class="token punctuation">></span></span> csvBuilder <span class="token operator">=</span> <span class="token class-name">CsvBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noTitles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        csvBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">Csv</span> csv <span class="token operator">=</span> csvBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¯¥ç§æ–¹å¼ä¼šåœ¨åŸappend.csvæ–‡ä»¶ç»§ç»­è¿½åŠ æ•°æ®ï¼Œè€Œä¸æ˜¯è¦†ç›–</span>    csv<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/User/append.csv"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>Beanå®šä¹‰</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">People</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"å§“å"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"å¹´é¾„"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"æ€§åˆ«"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä¸excelå¯¼å‡ºæ³¨è§£ç›¸æ¯”ï¼Œæ”¯æŒå±æ€§å‡å°‘ï¼Œwidthã€styleå±æ€§å°†ä¸è¢«æ”¯æŒï¼Œæ³¨è§£è¯·ç§»æ­¥: <a href="#%E6%B3%A8%E8%A7%A3">æ³¨è§£</a></p></blockquote><h2 id="å¤šsheetå¯¼å…¥"><a href="#å¤šsheetå¯¼å…¥" class="headerlink" title="å¤šsheetå¯¼å…¥"></a>å¤šsheetå¯¼å…¥</h2><p>å¤šsheetå¯¼å…¥ï¼ŒæŒ‡çš„æ˜¯SaxExcelReaderå¤šsheetå¯¼å…¥ï¼Œä¸åŒ…å«DefaultExcelReaderã€‚</p><h3 id="æŒ‰sheetç´¢å¼•å¤šsheetå¯¼å…¥"><a href="#æŒ‰sheetç´¢å¼•å¤šsheetå¯¼å…¥" class="headerlink" title="æŒ‰sheetç´¢å¼•å¤šsheetå¯¼å…¥"></a>æŒ‰sheetç´¢å¼•å¤šsheetå¯¼å…¥</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">SaxExcelReader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheets</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>excelFile<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="æŒ‰sheetåç§°å¤šsheetå¯¼å…¥"><a href="#æŒ‰sheetåç§°å¤šsheetå¯¼å…¥" class="headerlink" title="æŒ‰sheetåç§°å¤šsheetå¯¼å…¥"></a>æŒ‰sheetåç§°å¤šsheetå¯¼å…¥</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">SaxExcelReader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheets</span><span class="token punctuation">(</span><span class="token string">"sheetåç§°1"</span><span class="token punctuation">,</span><span class="token string">"sheetåç§°2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>excelFile<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="å¤šsheetå¯¼å‡º"><a href="#å¤šsheetå¯¼å‡º" class="headerlink" title="å¤šsheetå¯¼å‡º"></a>å¤šsheetå¯¼å‡º</h2><h3 id="DefaultExcelBuilderã€DefaultStreamExcelBuilder"><a href="#DefaultExcelBuilderã€DefaultStreamExcelBuilder" class="headerlink" title="DefaultExcelBuilderã€DefaultStreamExcelBuilder"></a>DefaultExcelBuilderã€DefaultStreamExcelBuilder</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Workbook</span> workbook1<span class="token operator">=</span><span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// of(class,workbook)</span><span class="token class-name">Workbook</span> workbook2<span class="token operator">=</span><span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">,</span> workbook1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h3 id="æ¨¡æ¿å¯¼å‡º"><a href="#æ¨¡æ¿å¯¼å‡º" class="headerlink" title="æ¨¡æ¿å¯¼å‡º"></a>æ¨¡æ¿å¯¼å‡º</h3><p>æ¨¡æ¿å¯¼å‡ºæƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªtableå°±æ˜¯ä¸€ä¸ªsheetã€‚</p><blockquote><p>å¦‚éœ€å¤štableå¯¼å‡ºåœ¨åŒä¸€sheetä¸­ï¼Œä½¿ç”¨sheetStrategy(SheetStrategy.ONE_SHEET)</p></blockquote><h2 id="è‡ªå®šä¹‰æ ·å¼"><a href="#è‡ªå®šä¹‰æ ·å¼" class="headerlink" title="è‡ªå®šä¹‰æ ·å¼"></a>è‡ªå®šä¹‰æ ·å¼</h2><blockquote><p>æœ¬æ¨¡å—ä»…é’ˆå¯¹DefaultExcelBuilderã€DefaultStreamExcelBuilderï¼Œæ¨¡æ¿æ„å»ºå¤©ç„¶æ”¯æŒã€‚</p></blockquote><h3 id="æ ‡é¢˜ï¼ˆtitleï¼‰æ ·å¼è‡ªå®šä¹‰"><a href="#æ ‡é¢˜ï¼ˆtitleï¼‰æ ·å¼è‡ªå®šä¹‰" class="headerlink" title="æ ‡é¢˜ï¼ˆtitleï¼‰æ ·å¼è‡ªå®šä¹‰"></a>æ ‡é¢˜ï¼ˆtitleï¼‰æ ·å¼è‡ªå®šä¹‰</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"title->color:red"</span><span class="token punctuation">,</span><span class="token string">"cell->color:green"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> age<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="å†…å®¹è¡Œæ ·å¼è‡ªå®šä¹‰"><a href="#å†…å®¹è¡Œæ ·å¼è‡ªå®šä¹‰" class="headerlink" title="å†…å®¹è¡Œæ ·å¼è‡ªå®šä¹‰"></a>å†…å®¹è¡Œæ ·å¼è‡ªå®šä¹‰</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token string">"cell->color:green"</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> age<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="æ–¹æ³•è°ƒç”¨è®¾å®šæ ·å¼"><a href="#æ–¹æ³•è°ƒç”¨è®¾å®šæ ·å¼" class="headerlink" title="æ–¹æ³•è°ƒç”¨è®¾å®šæ ·å¼"></a>æ–¹æ³•è°ƒç”¨è®¾å®šæ ·å¼</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>                   <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">"title->color:red"</span><span class="token punctuation">,</span><span class="token string">"background-color:green;"</span><span class="token punctuation">)</span>                   <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>ä½¿ç”¨ -&gt; åˆ†éš”ç¬¦ï¼š</p><ul><li>titleæ ‡æ˜è¯¥æ ·å¼é’ˆå¯¹æ ‡é¢˜ï¼›</li><li>cellæ ‡æ˜è¯¥æ ·å¼é’ˆå¯¹å†…å®¹è¡Œï¼›</li><li>oddæ ‡æ˜è¯¥æ ·å¼é’ˆå¯¹å¥‡æ•°å†…å®¹è¡Œï¼›</li><li>evenæ ‡æ˜è¯¥æ ·å¼é’ˆå¯¹å¶æ•°å†…å®¹è¡Œï¼›</li></ul><p>å…·ä½“æ ·å¼æ”¯æŒï¼Œè¯·ç§»æ­¥<a href="#%E6%A0%B7%E5%BC%8F%E6%94%AF%E6%8C%81">æ ·å¼æ”¯æŒ</a></p><h2 id="å•å…ƒæ ¼å†…æ¢è¡Œ"><a href="#å•å…ƒæ ¼å†…æ¢è¡Œ" class="headerlink" title="å•å…ƒæ ¼å†…æ¢è¡Œ"></a>å•å…ƒæ ¼å†…æ¢è¡Œ</h2><h3 id="DefaultExcelBuilder-x2F-DefaultSteamExcelBuilder"><a href="#DefaultExcelBuilder-x2F-DefaultSteamExcelBuilder" class="headerlink" title="DefaultExcelBuilder&#x2F;DefaultSteamExcelBuilder"></a>DefaultExcelBuilder&#x2F;DefaultSteamExcelBuilder</h3><p>é»˜è®¤ä¸Šè¿°æ„å»ºå™¨ä¼šè‡ªåŠ¨æ¢è¡Œï¼Œ@ExcelModel(wrapText&#x3D;true)</p><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><p>å¦‚éœ€åœ¨æ¨¡æ¿çš„å•å…ƒæ ¼å†…æ¢è¡Œï¼Œè¯·ä½¿ç”¨<code>&lt;br/&gt;</code>æˆ–pæ ‡ç­¾ã€‚</p><h2 id="å›¾ç‰‡å¯¼å‡º"><a href="#å›¾ç‰‡å¯¼å‡º" class="headerlink" title="å›¾ç‰‡å¯¼å‡º"></a>å›¾ç‰‡å¯¼å‡º</h2><h3 id="DefaultExcelBuilderã€DefaultStreamExcelBuilderå›¾ç‰‡å¯¼å‡º"><a href="#DefaultExcelBuilderã€DefaultStreamExcelBuilderå›¾ç‰‡å¯¼å‡º" class="headerlink" title="DefaultExcelBuilderã€DefaultStreamExcelBuilderå›¾ç‰‡å¯¼å‡º"></a>DefaultExcelBuilderã€DefaultStreamExcelBuilderå›¾ç‰‡å¯¼å‡º</h3><p>å›¾ç‰‡å¯¼å‡ºå±æ€§å®šä¹‰ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>fileType <span class="token operator">=</span> <span class="token class-name">FileType</span><span class="token punctuation">.</span>IMAGE<span class="token punctuation">)</span><span class="token class-name">File</span> image<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>å±æ€§ç±»å‹å¿…é¡»æ˜¯Fileï¼Œåç»­ä¼šå¢åŠ å…¶ä»–ç±»å‹æ”¯æŒã€‚</p><h3 id="æ¨¡æ¿å›¾ç‰‡å¯¼å‡º"><a href="#æ¨¡æ¿å›¾ç‰‡å¯¼å‡º" class="headerlink" title="æ¨¡æ¿å›¾ç‰‡å¯¼å‡º"></a>æ¨¡æ¿å›¾ç‰‡å¯¼å‡º</h3><p>tdå•å…ƒæ ¼å†…å«å›¾ç‰‡å³å¯</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>å›¾ç‰‡ç»å¯¹è·¯å¾„<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h2 id="å›¾ç‰‡å¯¼å…¥"><a href="#å›¾ç‰‡å¯¼å…¥" class="headerlink" title="å›¾ç‰‡å¯¼å…¥"></a>å›¾ç‰‡å¯¼å…¥</h2><p>å›¾ç‰‡å¯¼å…¥ä»…DefaultExcelReaderæ”¯æŒï¼Œå±æ€§ç±»å‹ä¸ºInputStreamï¼Œå®é™…èµ‹å€¼ç±»å‹ä¸ºByteArrayInputStreamã€‚</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">People</span> <span class="token punctuation">&#123;</span>   <span class="token annotation punctuation">@ExcelColumn</span><span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token class-name">InputStream</span> picture<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å•å…ƒæ ¼è®¾ç½®"><a href="#å•å…ƒæ ¼è®¾ç½®" class="headerlink" title="å•å…ƒæ ¼è®¾ç½®"></a>å•å…ƒæ ¼è®¾ç½®</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ¤åˆ«å•å…ƒæ ¼å†…å®¹ç±»å‹ï¼Œç›®å‰è‡ªåŠ¨è¯†åˆ«ç±»å‹æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li>String</li><li>Double</li><li>Boolean</li></ul><p>å¦‚æœStringçš„å†…å®¹å…¨ä¸ºæ•°å­—æ—¶ï¼Œå¯¼å‡ºæ—¶æœ‰å¯èƒ½ä¼šè¢«ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•å±•ç¤ºã€‚è§£å†³è¿™ç§æƒ…å†µå¼ºåˆ¶ä½¿ç”¨Stringçš„æ–¹å¼æ„å»ºå³å¯ã€‚</p><h3 id="è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"><a href="#è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ" class="headerlink" title="è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"></a>è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ</h3><p>åœ¨tdä¸Šå¢åŠ å±æ€§stringè®¾ç½®è¯¥å•å…ƒæ ¼ç±»å‹ä¸ºå­—ç¬¦ä¸²</p><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">string</span><span class="token punctuation">></span></span>19<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è®¾ç½®ä¸ºæ•°å€¼ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"><a href="#è®¾ç½®ä¸ºæ•°å€¼ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ" class="headerlink" title="è®¾ç½®ä¸ºæ•°å€¼ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"></a>è®¾ç½®ä¸ºæ•°å€¼ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">double</span><span class="token punctuation">></span></span>19<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è®¾ç½®ä¸ºå¸ƒå°”ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"><a href="#è®¾ç½®ä¸ºå¸ƒå°”ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ" class="headerlink" title="è®¾ç½®ä¸ºå¸ƒå°”ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ"></a>è®¾ç½®ä¸ºå¸ƒå°”ç±»å‹æ•°æ®å¯åšå¦‚ä¸‹æ“ä½œ</h3><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">boolean</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ·»åŠ æ°´å°"><a href="#æ·»åŠ æ°´å°" class="headerlink" title="æ·»åŠ æ°´å°"></a>æ·»åŠ æ°´å°</h2><blockquote><p>ä¸æ”¯æŒ.xlsæ–‡ä»¶æ·»åŠ æ°´å°ï¼Œæ”¯æŒXSSFã€SXSSFæ¨¡å¼ä¸‹æ·»åŠ æ°´å°ï¼Œå¦‚æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œè¯·æ³¨æ„âš ï¸</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>liaochong<span class="token punctuation">.</span>myexcel<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">WatermarkUtil</span></span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">></span></span> dataList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">DefaultExcelBuilder</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ArtCrowd</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä½¿ç”¨æ°´å°å·¥å…·æ·»åŠ æ°´å°</span><span class="token class-name">WatermarkUtil</span><span class="token punctuation">.</span><span class="token function">addWatermark</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span><span class="token string">"è‰ºæœ¯ç”Ÿæ°´å°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AttachmentExportUtil</span><span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token string">"è‰ºæœ¯ç”Ÿä¿¡æ¯"</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ¨¡æ¿ç›¸å…³"><a href="#æ¨¡æ¿ç›¸å…³" class="headerlink" title="æ¨¡æ¿ç›¸å…³"></a>æ¨¡æ¿ç›¸å…³</h2><h3 id="åœ¨htmlä¸­è®¾ç½®excelçš„sheetåç§°"><a href="#åœ¨htmlä¸­è®¾ç½®excelçš„sheetåç§°" class="headerlink" title="åœ¨htmlä¸­è®¾ç½®excelçš„sheetåç§°"></a>åœ¨htmlä¸­è®¾ç½®excelçš„sheetåç§°</h3><blockquote><p>è®¾ç½®sheet nameï¼šåœ¨è¡¨æ ¼é‡Œæ·»åŠ <code>&lt;caption&gt;</code>sheetåç§°</caption></p></blockquote><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caption</span><span class="token punctuation">></span></span>sheetåç§°<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caption</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ ·å¼æ”¯æŒ"><a href="#æ ·å¼æ”¯æŒ" class="headerlink" title="æ ·å¼æ”¯æŒ"></a>æ ·å¼æ”¯æŒ</h2><div class="note note-info">            <h3 id="å®½åº¦ï¼ˆwidhtï¼‰"><a href="#å®½åº¦ï¼ˆwidhtï¼‰" class="headerlink" title="å®½åº¦ï¼ˆwidhtï¼‰"></a>å®½åº¦ï¼ˆwidhtï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>width</td><td>æ•°å€¼ï¼Œå¦‚15px</td><td>style&#x3D;â€width: 15pxâ€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="é«˜åº¦ï¼ˆheightï¼‰"><a href="#é«˜åº¦ï¼ˆheightï¼‰" class="headerlink" title="é«˜åº¦ï¼ˆheightï¼‰"></a>é«˜åº¦ï¼ˆheightï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>height</td><td>æ•°å€¼ï¼Œå¦‚15pxï¼Œç‰¹åˆ«æ³¨æ„âš ï¸ï¼šå¦‚æ¨¡æ¿ä½¿ç”¨ï¼Œè¯¥æ ·å¼åªèƒ½æ”¾ç½®åœ¨ tr ä¸Š</td><td>style&#x3D;â€height: 15pxâ€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="èƒŒæ™¯è‰²ï¼ˆbackgroundï¼‰"><a href="#èƒŒæ™¯è‰²ï¼ˆbackgroundï¼‰" class="headerlink" title="èƒŒæ™¯è‰²ï¼ˆbackgroundï¼‰"></a>èƒŒæ™¯è‰²ï¼ˆbackgroundï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>background-color</td><td>åå…­è¿›åˆ¶ï¼š#FFFFFFã€RGBï¼šrgb(0,255,255)ã€å¸¸ç”¨èƒŒæ™¯è‰²åç§°ï¼šgreenï¼Œæ¨èä½¿ç”¨åå…­è¿›åˆ¶</td><td>style&#x3D;â€background-color:#ABFF00â€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="è¾¹æ¡†ï¼ˆborderï¼‰"><a href="#è¾¹æ¡†ï¼ˆborderï¼‰" class="headerlink" title="è¾¹æ¡†ï¼ˆborderï¼‰"></a>è¾¹æ¡†ï¼ˆborderï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>border-style</td><td>thinã€dashedã€mediumã€dottedã€thickã€doubleã€hairã€medium_dashedã€dash_dot</td><td>style&#x3D;â€border-style:thinâ€</td></tr><tr><td>border-top-style</td><td>thinã€dashedã€mediumã€dottedã€thickã€doubleã€hairã€medium_dashedã€dash_dot</td><td>style&#x3D;â€border-top-style:thinâ€</td></tr><tr><td>border-right-style</td><td>thinã€dashedã€mediumã€dottedã€thickã€doubleã€hairã€medium_dashedã€dash_dot</td><td>style&#x3D;â€border-right-style:thinâ€</td></tr><tr><td>border-bottom-style</td><td>thinã€dashedã€mediumã€dottedã€thickã€doubleã€hairã€medium_dashedã€dash_dot</td><td>style&#x3D;â€border-bottom-style:thinâ€</td></tr><tr><td>border-left-style</td><td>thinã€dashedã€mediumã€dottedã€thickã€doubleã€hairã€medium_dashedã€dash_dot</td><td>style&#x3D;â€border-left-style:thinâ€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="å­—ä½“ï¼ˆfontï¼‰"><a href="#å­—ä½“ï¼ˆfontï¼‰" class="headerlink" title="å­—ä½“ï¼ˆfontï¼‰"></a>å­—ä½“ï¼ˆfontï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>color</td><td>green</td><td>style&#x3D;â€color:green;â€</td></tr><tr><td>font-size</td><td>æ•°å€¼ï¼š14pxï¼ˆåªä¼šæˆªå–æ•°å€¼ï¼Œéæ•°å€¼éƒ¨åˆ†ä¼šè¢«åˆ é™¤ï¼‰</td><td>style&#x3D;â€font-size:14pxâ€</td></tr><tr><td>font-family</td><td>Times New Romanï¼ˆä¸æ”¯æŒå¤‡é€‰å­—ä½“ï¼‰</td><td>style&#x3D;â€font-family:Times New Romanâ€</td></tr><tr><td>font-style</td><td>italic</td><td>style&#x3D;â€font-style:italicâ€</td></tr><tr><td>font-weight</td><td>bold</td><td>style&#x3D;â€font-weight:boldâ€</td></tr><tr><td>text-decoration</td><td>text-decoration</td><td>style&#x3D;â€text-decoration: underlineâ€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="å¯¹é½æ–¹å¼ï¼ˆalignï¼‰"><a href="#å¯¹é½æ–¹å¼ï¼ˆalignï¼‰" class="headerlink" title="å¯¹é½æ–¹å¼ï¼ˆalignï¼‰"></a>å¯¹é½æ–¹å¼ï¼ˆalignï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>text-align</td><td>general,left,center,right,fill,justify,center_selection,distributed</td><td>style&#x3D;â€text-align:centerâ€</td></tr><tr><td>vertical-align</td><td>top,center,bottom,justify,distributed</td><td>style&#x3D;â€vertical-align:centerâ€</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="éšè—ï¼ˆvisibilityï¼‰"><a href="#éšè—ï¼ˆvisibilityï¼‰" class="headerlink" title="éšè—ï¼ˆvisibilityï¼‰"></a>éšè—ï¼ˆvisibilityï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>visibility</td><td>hiddenï¼šéšè—ï¼Œç›®å‰ä»…è®¾ç½®åœ¨trä¸Šç”Ÿæ•ˆ</td><td>&lt; tr style&#x3D;â€visibility: hiddenâ€ &gt;</td></tr></tbody></table>          </div><div class="note note-info">            <h3 id="è‡ªåŠ¨æ¢è¡Œï¼ˆword-breakï¼‰"><a href="#è‡ªåŠ¨æ¢è¡Œï¼ˆword-breakï¼‰" class="headerlink" title="è‡ªåŠ¨æ¢è¡Œï¼ˆword-breakï¼‰"></a>è‡ªåŠ¨æ¢è¡Œï¼ˆword-breakï¼‰</h3><table><thead><tr><th>CSS</th><th>Value</th><th>Example</th></tr></thead><tbody><tr><td>word-break</td><td>break-allï¼šè‡ªåŠ¨æ¢è¡Œ</td><td>&lt; tr style&#x3D;â€word-break: break-allâ€ &gt;ã€&lt; td style&#x3D;â€word-break: break-allâ€ &gt;</td></tr></tbody></table>          </div><h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><p>æ³¨è§£è¯´æ˜</p><ul><li>æ³¨è§£</li></ul><blockquote><p>@ExcelModel</p></blockquote><ul><li>ä½ç½®</li></ul><blockquote><p>Class</p></blockquote><ul><li><p>æ–¹æ³•</p><ul><li>includeAllFieldï¼šæ˜¯å¦å¯¼å‡ºè¯¥ç±»çš„æ‰€æœ‰å­—æ®µï¼Œé»˜è®¤ä¸ºtrue</li><li>excludeParentï¼šæ˜¯å¦æ’é™¤çˆ¶ç±»å­—æ®µï¼Œé»˜è®¤ä¸ºfalse</li><li>workbookTypeï¼šè®¾ç½®å·¥ä½œç°¿ç±»å‹ï¼Œé»˜è®¤WorkbookType.SXLSXï¼Œä¸å»ºè®®ä¿®æ”¹</li><li>sheetNameï¼šè®¾ç½®å¯¼å‡ºçš„å·¥ä½œç°¿sheetåç§°</li><li>useFieldNameAsTitleï¼šè®¾ç½®æ˜¯å¦ç›´æ¥ä½¿ç”¨å­—æ®µåç§°ä½œä¸ºå¯¼å‡ºæ ‡é¢˜ï¼Œé»˜è®¤false</li><li>defaultValueï¼šè®¾ç½®å…¨å±€å¯¼å‡ºæ—¶ï¼Œå­—æ®µä¸ºNullæ—¶çš„é»˜è®¤å€¼ï¼Œå¦‚å­—æ®µä¹ŸåŒ…å«defaultValueï¼Œåˆ™è¿›è¡Œè¦†ç›–</li><li>wrapTextï¼šæ˜¯å¦å¼€å¯è‡ªåŠ¨æ¢è¡Œï¼Œé»˜è®¤å¼€å¯</li></ul></li><li><p>dateFormatï¼šè®¾ç½®å…¨å±€LocalDateæ ¼å¼ï¼Œé»˜è®¤ä¸ºyyyy-MM-dd</p></li><li><p>dateTimeFormatï¼šè®¾ç½®å…¨å±€Date\LocalDateTimeæ ¼å¼ï¼Œé»˜è®¤ä¸ºyyyy-MM-dd HH:mm:ss</p></li><li><p>ignoreStaticFieldsï¼šæ˜¯å¦å¿½ç•¥é™æ€å­—æ®µå¯¼å‡ºï¼Œé»˜è®¤å¿½ç•¥</p></li><li><p>titleSeparatorï¼šæ ‡é¢˜åˆ†ç¦»å™¨ï¼Œç”¨äºå¤šçº§æ ‡é¢˜ï¼Œé»˜è®¤ä¸ºâ€œ-&gt;â€</p></li><li><p>|è®¾ç½®å¯¼å‡ºExcelçš„å…¬å…±å±æ€§ @ExcelColumn|Field|</p></li><li><p>titleï¼šå¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œè¯¥å­—æ®µå¯¹åº”å¯¼å‡ºåˆ—æ ‡é¢˜</p></li><li><p>orderï¼šå¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œè¯¥å­—æ®µå¯¹åº”çš„å¯¼å‡ºå±•ç¤ºé¡ºåºï¼Œåˆå§‹ä¸º0ï¼Œå»ºè®®æŒ‰åˆ—é¡ºåºè®¾ç½®ï¼Œå¦‚å­—æ®µé¡ºåºå°±æ˜¯åˆ—é¡ºåºï¼Œå¯ä¸è®¾ç½®</p></li><li><p>formatï¼šå¯¼å…¥å¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œå½“å­—æ®µç±»å‹ä¸ºæ—¶é—´ç±»å‹ã€é‡‘é’±ç±»å‹æ—¶ç”Ÿæ•ˆï¼Œç”¨äºè®¾ç½®è¯¥æ—¶é—´ç±»å‹å­—æ®µæ ¼å¼åŒ–ï¼Œå¦‚<code>yyyy-MM-dd HH:mm:ss</code></p></li><li><p>groupsï¼šå¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œå½“å‰å­—æ®µæ‰€å±åˆ†ç»„ï¼Œæ„å»ºæ—¶æ ¹æ®ä¼ å…¥çš„åˆ†ç»„é€‰æ‹©å¯¼å‡ºçš„å­—æ®µ</p></li><li><p>indexï¼šå¯¼å…¥æ—¶ä½¿ç”¨ï¼Œç”¨äºæ ‡å¿—è¯¥å­—æ®µå¯¹åº”çš„Excelåˆ—ï¼Œä»0å¼€å§‹ï¼Œä¸å…è®¸é‡å¤</p></li><li><p>defaultValueï¼šå¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œè®¾ç½®å¯¼å‡ºæ—¶å­—æ®µä¸ºNullæ—¶çš„é»˜è®¤å€¼</p></li><li><p>widthï¼šå¯¼å‡ºæ—¶ä½¿ç”¨ï¼Œç”¨äºè‡ªå®šä¹‰å•å…ƒæ ¼å®½åº¦ï¼Œé…åˆAutoWidthStrategy.CUSTOM_WIDTHä½¿ç”¨</p></li><li><p>styleï¼šè‡ªå®šä¹‰æ ·å¼</p></li><li><p>è®¾ç½®å¯¼å…¥ã€å¯¼å‡ºå­—æ®µå±æ€§ @IgnoreColumn,æ’é™¤è¯¥å­—æ®µçš„å¯¼å‡º</p></li></ul><h2 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h2><p><a href="https://github.com/liaochong/myexcel">myexcel</a></p><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax3.sinaimg.cn/large/005NNTS5ly1grgj7do4e0j32yo1o04qp.jpg" alt="ä¼´æˆ‘åŒè¡Œ"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>java8çš„streamçš„ä½¿ç”¨æ–¹æ³•</title>
    <link href="/2021/08/12/java-01/"/>
    <url>/2021/08/12/java-01/</url>
    
    <content type="html"><![CDATA[<h2 id="Streamçš„ç”±æ¥"><a href="#Streamçš„ç”±æ¥" class="headerlink" title="Streamçš„ç”±æ¥"></a>Streamçš„ç”±æ¥</h2><div class="note note-info">            <p>æˆ‘ä»¬æ­£å¸¸å¤„ç†é›†åˆé‡Œçš„æ•°æ®æ—¶ï¼Œç¬¬ä¸€æƒ³åˆ°çš„æ˜¯ä¸æ˜¯å°±æ˜¯forå¾ªç¯ï¼Œåˆ«é—®ï¼Œé—®å°±æ˜¯forå¾ªç¯å¤§æ³•ã€‚ç¡®å®ï¼Œé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€ç»´ï¼Œè®©æˆ‘ä»¬ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªå¾ªç¯ç„¶åè¿›è¡Œä¸€äº›è¿‡æ»¤ï¼ŒæŸ¥æ‰¾ï¼Œåˆ†ç±»æ“ä½œã€‚åœ¨Javaæ²¡æœ‰è¿™ä¸ªæµä¹‹å‰ï¼Œå¤§å®¶ä¼™éƒ½è¿™ä¹ˆåšçš„ã€‚</p><p>ä¸ºä»€ä¹ˆJava8è¦æ¨å‡ºæµè¿™ä¸ªä¸œè¥¿å‘¢ï¼Œè‚¯å®šæ˜¯è¿™ç§æ–¹æ³•æœ‰ä¼˜è¶Šæ€§ã€‚ä¹‹å‰çš„å¾ªç¯å¤§æ³•ä»æœ€ç»ˆçš„ç»“æœæ¥çœ‹å’Œæµæ“ä½œçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œéƒ½å¯ä»¥å®ŒæˆåŠŸèƒ½ã€‚æµçš„æ“ä½œæ¥æºäºLambdaè¡¨è¾¾å¼ï¼Œå¦‚æœæ²¡æœ‰Lambdaè¡¨è¾¾å¼ä¹Ÿä¸ä¼šæœ‰è¿™ä¸ªä¸œè¥¿ã€‚ä½¿ç”¨æµå¯ä»¥æå‡ä»£ç çš„ç®€æ´åº¦ï¼Œè¿™ä¸ªæå‡æ˜¯è´¨çš„é£è·ƒï¼Œä»¥å‰åå‡ è¡Œä»£ç ç”šè‡³æ›´å¤šï¼Œç°åœ¨å¯èƒ½åªéœ€è¦ä¸€è¡Œä»£ç å°±èƒ½å®Œæˆï¼Œè¿™æ˜¯å°±æœ‰ä¸åŒçš„æ„è§äº†ï¼Œè¯´è¿™ç§ä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œæˆ‘æ„Ÿè§‰å®ŒæˆåŒæ ·çš„åŠŸèƒ½ï¼Œä»£ç è¶Šå°‘æ˜¯è¶Šå®¹æ˜“ç»´æŠ¤çš„ï¼Œä¸€ä¸ªä¸‰ç™¾è¡Œä»£ç çš„æ–¹æ³•å’Œä¸€ä¸ªä¸‰åè¡Œçš„æ–¹æ³•ï¼Œç»´æŠ¤æˆæœ¬ä¸æ˜¯ä¸€ä¸ªé‡çº§çš„ã€‚</p>          </div><h2 id="Streamæµçš„ç”¨æ³•"><a href="#Streamæµçš„ç”¨æ³•" class="headerlink" title="Streamæµçš„ç”¨æ³•"></a>Streamæµçš„ç”¨æ³•</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LocalDateTimeDemoTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token function">getUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è¿‡æ»¤</span><span class="token comment">// å¹´é¾„å¤§äº10çš„</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> collect <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åå­—æœ€åæ˜¯2çš„</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> collect1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç»„åˆè¿‡æ»¤</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> collect2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æŸ¥æ‰¾åä¸ºç‹0çš„ï¼Œå¦‚æœæœ‰é‡åçš„å–ç¬¬ä¸€ä¸ª,å¦‚æœä¸ºç©ºåˆ™åˆå§‹åŒ–ä¸€ä¸ª(è¿™ç§å†™æ³•ä¸»è¦æ˜¯è®©ç¨‹åºæ›´åŠ å¥å£®ï¼Œé¿å…çš„ç©ºæŒ‡é’ˆ)ã€‚</span><span class="token class-name">User</span> user1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"ç‹0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿™ç§ä¹Ÿæ˜¯è·å–ç¬¬ä¸€ä¸ª,è¿™ä¸ªçš„æ•ˆç‡æ¯”ä¸Šé¢çš„é«˜ï¼Œä¸€èˆ¬æŸ¥æ‰¾å”¯ä¸€æ•°æ®ï¼Œç”¨è¿™ä¸ªæ¯”è¾ƒå¿«ã€‚</span><span class="token class-name">User</span> user2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"ç‹0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æŒ‰å¹´é¾„ä»å°åˆ°å¤§æ’åº</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> collect7 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æŒ‰å¹´é¾„ä»å¤§åˆ°å°æ’åº</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> collect8 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reversed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="åˆ†ç»„"><a href="#åˆ†ç»„" class="headerlink" title="åˆ†ç»„"></a>åˆ†ç»„</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åˆ†ç»„</span><span class="token comment">// ä»¥ç­çº§åˆ†ç»„, è¿”å›ä¸€ä¸ªmap,keyä¸ºéƒ¨é—¨IDï¼Œvalueä¸ºåˆ†ç»„çš„é›†åˆ</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span><span class="token punctuation">></span></span> collect3 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getGradeId</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¤šçº§åˆ†ç»„ è¿™ä¸ªå°±æ¯”è¾ƒå¥½ç©äº†ï¼ŒMapé‡Œé¢åµŒå¥—Mapï¼Œå“ˆå“ˆå’Œä¸Šé¢ä¸€æ ·ï¼Œå…ˆä»¥ç­çº§åˆ†ç»„ï¼Œç„¶åå†æŒ‰å¹´é¾„åˆ†ç»„</span><span class="token comment">// å¤–å±‚çš„Mapçš„Keyä¸ºç­çº§IDï¼Œé‡Œé¢çš„Mapçš„Keyä¸ºå¹´é¾„ã€‚</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span><span class="token punctuation">></span><span class="token punctuation">></span></span> collect4 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getGradeId</span><span class="token punctuation">,</span> <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åˆ†ç»„åŠ æ±‡æ€»ï¼Œä»¥ç­çº§ä¸ºå•ä½æ€»è–ªé…¬</span><span class="token comment">// Mapçš„Key ä¸ºç­çº§IDï¼ŒValueä¸ºåˆ†è¿‡ç»„åçš„æ€»å’Œï¼Œæ³¨æ„è¿™é‡Œå–”ï¼Œ</span><span class="token comment">// ç›´æ¥ç”¨doubleæ¥è¿›è¡Œæ€»å’Œè®¡ç®—ï¼Œä¸€èˆ¬æ¥è¯´è‚¯å®šä¼šå‘ç”Ÿç²¾åº¦ä¸¢å¤±ã€‚æ‰€ä»¥è¿™ç§è¿™ç§doubleè¿ç®—ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯ä¸å¯ä»¥ç›´æ¥sumçš„</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">></span></span> collect5 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getGradeId</span><span class="token punctuation">,</span> <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">summingDouble</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getSalary</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å½’æ€»"><a href="#å½’æ€»" class="headerlink" title="å½’æ€»"></a>å½’æ€»</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token comment">// å½’æ€»ï¼Œ</span>    <span class="token comment">// ä½•ä¸ºå½’æ€»ï¼Œå°±æ˜¯ç»“æœé›†æ˜¯ä¸€ä¸ªã€‚</span>    <span class="token comment">//æ±‚æ‰€æœ‰äººå¹´é¾„æ€»å’Œï¼ˆå¥½åƒæ²¡å•¥æ„ä¹‰ï¼Œï¼‰</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">mapToInt</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ä¹Ÿå¯ä»¥å…ˆè¿‡æ»¤ç­çº§ç¼–å·ä¸º3çš„åŒå­¦å†è¿›è¡Œå¹´é¾„æ±‚å’Œ</span>    <span class="token keyword">int</span> sum1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user <span class="token operator">-></span> user<span class="token punctuation">.</span><span class="token function">getGradeId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mapToInt</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ‰¾åˆ°å¹´é¾„æœ€å°çš„åŒå­¦</span>    <span class="token class-name">User</span> user <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ‰¾åˆ°å¹´é¾„æœ€å¤§çš„åŒå­¦å¹¶è¾“å‡ºæœ€å°å¹´é¾„æ˜¯å¤šå°‘ï¼ˆå¼ºè¡Œå‡‘ä»£ç ï¼Œå“ˆå“ˆï¼‰</span>    <span class="token keyword">int</span> age <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è·å–æŒ‰ç­çº§åˆ†ç»„åå¹´é¾„æ€»å’Œæœ€å°å€¼æ˜¯å¤šå°‘ï¼ˆä¹ä¸€å¬æ„Ÿè§‰å¾ˆç»•ï¼Œå®é™…æœ‰å•¥ç»•çš„,è‡ªå·±å†™äº†ä¸€ä¸‹ï¼Œç¡®å®æœ‰ç‚¹ç»•ï¼Œæ·¦ã€‚ï¼‰</span>    <span class="token comment">// å®é™…æ„ä¹‰å¾…æ–Ÿé…Œå•Šã€‚ã€‚</span>    <span class="token class-name">Integer</span> integer <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getGradeId</span><span class="token punctuation">,</span>     <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">summingInt</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ¼”ç¤ºä¸€ä¸‹BigDecimalçš„è¿ç®—å§ï¼Œå·®ç‚¹å¿˜äº†,</span>    <span class="token comment">// å•¥ä¹Ÿä¸å¹²ç›´æ¥å°±æ˜¯ç®—é‡‘é¢æ€»å’Œ</span>    <span class="token class-name">BigDecimal</span> bigDecimal <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getMoney</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token operator">::</span><span class="token function">add</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å…ˆè¿›è¡Œç®€å•çš„è¿‡æ»¤ï¼Œå†è¿›è¡Œè®¡ç®—</span>    <span class="token class-name">BigDecimal</span> bigDecimal1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user3 <span class="token operator">-></span> user3<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getMoney</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token operator">::</span><span class="token function">add</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¡ç®—æ‰€æœ‰åŒå­¦çš„å¹´é¾„</span>    <span class="token keyword">int</span> sum2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mapToInt</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¡ç®—Doubleå‹çš„Salary,è¿™é‡Œè‚¯å®šä¼šå‘ç”Ÿç²¾åº¦ä¸¢å¤±ï¼Œå…·ä½“æ€ä¹ˆå¤„ç†ï¼Œå¤§å®¶å¯ä»¥ç™¾åº¦ä¸€ä¸‹ï¼Œæç¤ºè¦æƒ³ä¸ä¸¢ç²¾åº¦ï¼Œè‚¯å®šæ˜¯è¦ç”¨BigDecimalçš„</span>    <span class="token keyword">double</span> sum3 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mapToDouble</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getSalary</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¡ç®—å¹´è½»å¹³å‡æ•°</span>    <span class="token class-name">Double</span> collect6 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">averagingDouble</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getAge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// çœ‹çœ‹å§“ç‹åŒå­¦æœ‰å‡ ä¸ª.</span>    <span class="token keyword">long</span> count <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>user3 <span class="token operator">-></span> user3<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"ç‹"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// anyMatchè¡¨ç¤ºï¼Œåˆ¤æ–­çš„æ¡ä»¶é‡Œï¼Œä»»æ„ä¸€ä¸ªå…ƒç´ æˆåŠŸï¼Œè¿”å›true</span>    <span class="token comment">// è¿™é‡Œå°±æ˜¯å¦‚æœåŒå­¦ä¸­æœ‰ä¸€ä¸ªå°äºå…­å²çš„åˆ™è¿”å›true</span>    <span class="token keyword">boolean</span> b <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span>i <span class="token operator">-></span> i<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// allMatchè¡¨ç¤ºï¼Œåˆ¤æ–­æ¡ä»¶é‡Œçš„å…ƒç´ ï¼Œæ‰€æœ‰çš„éƒ½æ˜¯ï¼Œè¿”å›true</span>    <span class="token comment">// åˆ¤æ–­åŒå­¦é‡Œé¢æ˜¯ä¸æ˜¯æ‰€æœ‰äººçš„å¹´é¾„éƒ½å°äºå…­åå²ï¼Œå¦‚æœéƒ½å°äºå…­åå²åˆ™è¿”å›true</span>    <span class="token keyword">boolean</span> b1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span>i <span class="token operator">-></span> i<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// noneMatchè·ŸallMatchç›¸åï¼Œåˆ¤æ–­æ¡ä»¶é‡Œçš„å…ƒç´ ï¼Œæ‰€æœ‰çš„éƒ½ä¸æ˜¯ï¼Œè¿”å›true</span>    <span class="token comment">// åˆ¤æ–­åŒå­¦çš„å¹´é¾„æ˜¯ä¸æ˜¯éƒ½ä¸å¤§äºå…­åå²ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå¤§äºå…­åå²  è¿”å›false</span>    <span class="token keyword">boolean</span> b2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span>i <span class="token operator">-></span> i<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="ç”¨æ¥æµ‹è¯•çš„æ•°æ®"><a href="#ç”¨æ¥æµ‹è¯•çš„æ•°æ®" class="headerlink" title="ç”¨æ¥æµ‹è¯•çš„æ•°æ®"></a>ç”¨æ¥æµ‹è¯•çš„æ•°æ®</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token comment">// æ¨¡æ‹Ÿæ•°æ®ç»„ï¼ŒçœŸæ˜¯æ•°æ®è¿œè¿œæ¯”è¿™å¤æ‚ï¼Œä½†æ˜¯ä½ åªéœ€è¦ç”¨å…³é”®æ•°æ®å³å¯ã€‚</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">getUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"ç‹0"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">12.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"ç‹1"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">11.7</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1300</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"ç‹2"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">16.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"ç‹3"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"ç‹4"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">11.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">2344</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"ç‹5"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1120</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">"ç‹6"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">19.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">9980</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">"ç‹7"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">111.3</span><span class="token punctuation">,</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1112</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="æ¨¡æ‹Ÿæ•°æ®å®ä½“ç±»"><a href="#æ¨¡æ‹Ÿæ•°æ®å®ä½“ç±»" class="headerlink" title="æ¨¡æ‹Ÿæ•°æ®å®ä½“ç±»"></a>æ¨¡æ‹Ÿæ•°æ®å®ä½“ç±»</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * ä¸»é”®Id     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token comment">/**     * ç”¨æˆ·å     */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>    <span class="token comment">/**     * ç­çº§ID     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> gradeId<span class="token punctuation">;</span>    <span class="token comment">/**     * å¹´é¾„     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token comment">/**     * è–ªé…¬     */</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>    <span class="token comment">/**     * å¼ºè¡Œå¢åŠ ä¸€ä¸ªé‡‘é¢ï¼Œç”¨æ¥æ¼”ç¤ºBigDecimalè¿ç®—     */</span>    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> userName<span class="token punctuation">,</span> <span class="token keyword">int</span> gradeId<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>userName <span class="token operator">=</span> userName<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>gradeId <span class="token operator">=</span> gradeId<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>money <span class="token operator">=</span> money<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">/**  * çœç•¥get,setæ–¹æ³• */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å°¾"><a href="#å°¾" class="headerlink" title="å°¾"></a>å°¾</h2><div class="note note-info">            <p>å…¶å®è¿™äº›æ–¹æ³•ï¼Œä¸ç”¨æ­»è®°ç¡¬èƒŒï¼Œéœ€è¦çš„æ—¶å€™æŸ¥è¯¢ä¸€ä¸‹å°±è¡Œäº†ï¼Œå½“ç”¨çš„å¤šäº†è‡ªç„¶è€Œç„¶çš„å°±è®°ä½äº†ã€‚æ­»è®°ç¡¬èƒŒï¼Œå½“æ—¶æ˜¯èƒŒä¸‹æ¥äº†ï¼Œä¸å¸¸ç”¨åˆ°çš„è¯ï¼Œä¹Ÿä¼šå¾ˆå¿«çš„é—å¿˜ã€‚</p><p>å®é™…ä¸Šåœ¨æŸ¥è¯¢æ•°æ®è¿™æ–¹é¢ï¼Œsqlæ˜¯å…¨çƒç¬¬ä¸€çš„ã€‚ä¸è¦å°çœ‹ä»»ä½•ä¸€æ¬¾æ•°æ®åº“è½¯ä»¶ã€‚æ•°æ®åº“è½¯ä»¶ï¼Œå¯ä»¥è¯´æ˜¯äººç±»æ™ºæ…§çš„ç»“æ™¶ï¼Œæ˜¯ä¸€ç¾¤æ™ºå•†é¡¶å°–çš„äººï¼Œå¹¶å°†æ•°æ®ç»“æ„å’Œç®—æ³•ç”¨åˆ°æè‡´æ‰å¼€å‘å‡ºæ¥çš„ä¸œè¥¿ã€‚ä¸€ä¸ªå‡ ç™¾å…†çš„ä½“ç§¯çš„æ•°æ®åº“è½¯ä»¶å¯ä»¥æ¯«ä¸è´¹åŠ›çš„ç®¡ç†å¤§äºè‡ªèº«å‡ ç™¾å€ä½“ç§¯çš„æ•°æ®ã€‚è¿™ç§èƒ½åŠ›æ˜¯çœŸæ­£ç¼–ç¨‹çš„ç¾ä¸½ã€‚</p><p>æˆ‘åœ¨æ•´ç†è¿™ä¸ªæµçš„æ“ä½œæ—¶ï¼Œå¦‚æœæˆ‘ä»¬æŠŠé›†åˆçœ‹æˆæ•°æ®åº“é‡Œçš„ä¸€è¡Œè¡Œæ•°æ®ï¼ŒJavaè¿™ä¸ªå¯¹é›†åˆçš„æµå›ºç„¶å¼ºå¤§ï¼Œå¯å’ŒSQLä¸€æ¯”ï¼Œä¹Ÿèƒ½ç†è§£ï¼Œæ¯•ç«Ÿé—»é“æœ‰å…ˆåï¼Œæœ¯ä¸šæœ‰ä¸“æ”»ã€‚</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax2.sinaimg.cn/large/005NNTS5ly1gl42sgpf56j32yo1o0kjl.jpg" alt="å¡å°”è²å¨…"></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>stream</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¸©æŸ”çš„å“²æ€</title>
    <link href="/2021/08/11/gossip-01/"/>
    <url>/2021/08/11/gossip-01/</url>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>æ‰“ç®—ä¸¥æ ¼åŒºåˆ†å¼€æ¥ç¢ç¢å¿µå’ŒæŠ€æœ¯æ€§çš„åšå®¢ï¼Œä¸è¦æ­£å„¿å…«ç»æŠ€æœ¯åšå®¢é‡Œé¢æ··æ‚ç€å…¶ä»–å¥‡å¥‡æ€ªæ€ªçš„æ–‡å­—ï¼ŒæŠ€æœ¯ å˜›ï¼Œçº¯ç²¹ä¸€ç‚¹ï¼Œä¸æ˜¯ä»€ä¹ˆåäº‹å•¦ï¼Œç¢ç¢å¿µï¼Œä¹Ÿçº¯ç¢ä¸€ç‚¹å’¯ã€‚</p>          </div><h2 id="ä¸»"><a href="#ä¸»" class="headerlink" title="ä¸»"></a>ä¸»</h2><div class="note note-info">            <p>æ¯•ç«Ÿä¹Ÿæ²¡ä»€ä¹ˆå¥½æ¯•ç«Ÿçš„ï¼Œå¤§å­¦æœŸé—´çš„ä¸€äº›çç¢ã€‚</p><p>åˆä¸Šå¤§å­¦ï¼Œå½“æ—¶æˆ‘çš„æˆç»©å¹¶ä¸ç†æƒ³ï¼Œç”¨å¹¶ä¸ç†è§£æ˜¯ä¸ºäº†è‡ªå·±ç»™è‡ªå·±ç•™ä¸€ç‚¹é¢å­ã€‚æŠ¥è€ƒä¸“ä¸šçš„æ—¶å€™ï¼Œå—åˆ°ä¸çŸ¥é“å“ªä½å®¶é•¿çš„æ’ºæ‡ï¼Œä¸€è¾¹ç¨€é‡Œç³Šæ¶‚ï¼Œä¸€éæ˜æ˜ç™½ç™½çš„æŠ¥äº†åœŸæœ¨ç›¸å…³çš„ä¸“ä¸šï¼Œäº‹å®è¯æ˜æˆ‘ä¸æ„Ÿå…´è¶£åŠ äººäººéƒ½å­¦çš„çš„ä¸œè¥¿æˆ‘çœŸçš„å¾ˆéš¾å­¦å¾—è¿›å»ï¼Œäºæ˜¯æˆ‘è¯¾ä¸Šçš„ä¸å¤šï¼ŒæŒ‚ç§‘ä¹Ÿå¾ˆä¸¥é‡ï¼Œä¸è¿‡è€ƒè™‘æˆ‘æ˜¯ä¸“ç§‘ï¼Œæˆ‘æœ‰å •è½çš„èµ„æœ¬ï¼Œè¾…å¯¼å‘˜ä¹Ÿä¸è‡³äºè·Ÿä¸€ä¸ªä¸“ç§‘ç”Ÿè¿‡ä¸å»ï¼Œå¤§å­¦é‡Œé¢çœ‹é‡çš„åˆä¸ä»…ä»…æ˜¯æˆç»©ã€‚å½“ç„¶å…¶ä»–çš„æ–¹é¢å’Œæˆ‘çš„æˆç»©ä¹Ÿæ˜¯å¹³åˆ†ç§‹è‰²ğŸ˜…ğŸ˜…ï¼Œä¸å¥½å¤šè¯´ï¼Œåæ­£ä»å°åˆ°å¤§ï¼Œå®¶é•¿è¶Šæ˜¯æœŸå¾…ä»€ä¹ˆæˆ‘å°±è¶Šä¼šæç ¸ï¼Œæˆ‘æ€»æ˜¯è¯´è‡ªå·±ä»€ä¹ˆå›é€†ï¼Œå…¶å®ä¸æ˜¯å›é€†ï¼Œåªæ˜¯æˆ‘çš„æŠ—å‹èƒ½åŠ›å®åœ¨ä¸å¼ºï¼Œèº«ä¸Šä¸€æœ‰å‹åŠ›ï¼Œæˆ‘å°±åšä¸å¥½äº‹æƒ…äº†ã€‚ä¹Ÿåœ¨ç»ƒä¹ å•¦ï¼Œæ³°å±±å´©äºå‰é¢ä¸æ”¹è‰²æˆ‘èƒ½åšåˆ°ï¼Œå¯å¿ƒçš„ç °ç °çš„è·³ï¼Œæˆ‘æ§åˆ¶ä¸ä½ã€‚</p><p>åœ¨å¤§å­¦ä¹‹å‰ï¼Œæœ‰è€³é—»å¤§å­¦ä¸­çš„å„ç§å­¦ç”Ÿç»„ç»‡è²Œä¼¼æŒºæœ‰è¶£çš„ï¼Œå¤§å­¦é‡Œæˆ‘åŠ äº†ä¸€ä¸ªå­¦ç”Ÿä¼šï¼Œåšä¸€ä¸ªç®€ç®€å•å•çš„ç°å……ï¼ˆç°å®ç”Ÿæ´»å……å®çš„äººï¼‰ï¼Œä¸å·®çš„äººå“ï¼ŒåŠ ä¸Šæ­£å¸¸çš„å¤–å½¢ï¼ŒåŠ ä¸Šéå¸¸èƒ½å­å­ï¼Œæ‰€ä»¥æˆ‘çš„å¥³äººç¼˜ä¸ç®—å·®ï¼Œæˆ‘åœ¨å¤§å­¦é‡Œæˆ‘ç”šè‡³è¿ç­ä¸Šçš„åŒå­¦çš„åå­—éƒ½æ²¡è®°å…¨ï¼Œä½†æ˜¯æˆ‘å´è®°ä½äº†éƒ¨é—¨ä¸­çš„æ¯ä¸ªäººã€‚ä¸€èµ·ç»å†äº†ä¸¤å±Šè¿åŠ¨ä¼šï¼Œå‚ä¸ç»„ç»‡äº†å¤§å¤§å°å°çš„æ´»åŠ¨ï¼Œä¸€èµ·ä¸ºéƒ¨é—¨åº†ç”Ÿï¼Œéƒ¨é—¨åˆå¹¶æ”¹ååä½†åŸç­äººé©¬åŠé›†åˆç‚¹è¿˜åœ¨çš„çªƒå–œï¼Œä¸€èµ·èšé¤ï¼Œä¸€èµ·åœ¨æ“åœºä¸Šç©è€ï¼Œè¿™æ˜¯æˆ‘åœ¨å¤§å­¦é‡Œæœ€å®è´µçš„å›å¿†äº†ã€‚</p><p>å¤§ä¸€æˆ‘æ˜¯éƒ¨å‘˜ï¼Œå¤§äºŒæˆ‘æ˜¯éƒ¨é•¿ï¼Œå¤§ä¸‰æˆ‘ä¾¿å°±æ²¡æœ‰è¿‡å¤šçš„å‚ä¸å­¦ç”Ÿä¼šäº†ï¼Œå› ä¸ºæˆ‘è¦æ¯•ä¸šäº†ï¼Œæˆ‘å¿…é¡»è¦èŠ±ç‚¹æ—¶é—´æ€è€ƒæˆ‘æ¯•ä¸šäº†åšä»€ä¹ˆï¼Œæ˜¯æœ¬ä¸“ä¸šè¿˜æ˜¯å­¦ä¹ è‡ªå·±æƒ³å­¦çš„ï¼Œå‰ä¸¤å¹´çš„å‚åŠ éƒ¨é—¨æ´»åŠ¨ï¼Œæœ€åä¸€å¹´çš„æ€è€ƒï¼Œæœ‰äº†è¿™äº›äº‹æƒ…æˆ‘å¹¶æ²¡æœ‰åœ¨å®¿èˆé‡Œé¢å¾…å¾ˆé•¿æ—¶é—´ï¼Œå¤§å­¦çš„å®¿èˆæ˜¯æ»‹ç”Ÿé¢“åºŸçš„æ¸©åºŠï¼Œæœ€åçš„æœ€åè¿·èŒ«è¿‡ï¼Œä½†ä¹Ÿæœ€ç»ˆèµ°ä¸Šäº†æ­£é€”.</p><p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘åº”è¯¥éœ€è¦æ„Ÿè°¢ç”Ÿå‘½ä¸­çš„ä¸€ä¸ªäººï¼Œè¦ä¸æ˜¯å¥¹çš„å‡ºç°åˆæ¶ˆå¤±ï¼Œæˆ‘å¯èƒ½ä¹Ÿä¸ä¼šé™ä¸‹å¿ƒæ¥åšå®šè‡ªå·±çš„é€‰æ‹©ã€‚è¿‡ç¨‹æˆ–å–œæˆ–æ‚²å·²ç»ä¸é‡è¦äº†ï¼Œè¯´å¾—è¿‡å»çš„ç»“å±€ï¼Œæœ€åã€‚è°¢è°¢ï¼</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tvax4.sinaimg.cn/large/005NNTS5ly1gn29xi0hq6j328f1cknpe.jpg" alt="é¬¼åˆ€"></p>]]></content>
    
    
    <categories>
      
      <category>ç¢ç¢å¿µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–°çš„å¼€å§‹</title>
    <link href="/2021/08/10/other-01/"/>
    <url>/2021/08/10/other-01/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸»"><a href="#ä¸»" class="headerlink" title="ä¸»"></a>ä¸»</h2><div class="note note-info">            <p>æµæ°´è´¦ä¸€æ ·çš„åšå®¢å¹¶ä¸ä¼šç»™äººç•™ä¸‹çˆ±å­¦ä¹ ä»¥åŠçˆ±è®°å½•çš„å°è±¡ï¼Œåè€Œæ˜¯å‡åˆ†é¡¹ï¼Œè¯·åŠ¡å¿…è®¤çœŸå¯¹å¾…è‡ªå·±çš„æ¯ä¸€ç¯‡åšå®¢ï¼Œå¦‚æœä½ æƒ³è¢«äººé˜…è¯»çš„è¯ã€‚</p><p>è®°äºï¼š2021-08-10æ™š11ç‚¹æ•´</p>          </div><div class="note note-primary">            <p>ç”Ÿæ´»éœ€è¦å®šæœŸæ•´ç†ï¼Œåšå®¢ä¹Ÿéœ€è¦å®šæœŸæ•´ç†ï¼Œå®ç¼ºå‹¿æ»¥ï¼Œæ–­èˆç¦»ä¸€ç›´æ˜¯æˆ‘çš„äººç”Ÿç®´è¨€ã€‚</p><p>ä»¥å†™åšå®¢ä¾‹ï¼Œæˆ‘å®é™…ä¸Šæˆ‘ä¹ŸèŠ±äº†æ—¶é—´å†™åšå®¢ï¼Œå†™äº†ä¸€äº›æµæ°´è´¦ä¸€æ ·çš„åšå®¢ï¼Œæœ‰æ„ä¹‰å˜›ï¼Œè‚¯å®šæœ‰æ„ä¹‰ï¼Œä½†æ˜¯æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ï¼Œä½†æ˜¯è¿™äº›æµæ°´è´¦ä¸€æ ·çš„åšå®¢å®ƒä¹Ÿä¼šå ç”¨äº†æˆ‘çš„æ—¶é—´ï¼Œæˆ‘çš„ç²¾åŠ›ï¼Œäººçš„ç²¾åŠ›æ˜¯æœ‰é™çš„ï¼Œæˆ‘å¯èƒ½å°±æ²¡æœ‰ç²¾åŠ›å†™å‡ºè‡ªå·±å–œæ¬¢çš„åšå®¢ã€‚</p><p>æƒ³èµ·ä»¥å‰çš„ä¸€ä¸ªé“ç†ï¼Œå¦‚æœä½ æ•·è¡äº†ç”Ÿæ´»ä¸­å¾ˆå¤šçš„å°äº‹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„å…³æ³¨ç‚¹å¯èƒ½å°±ä¸æ˜¯æ¯ä»¶å°äº‹çš„ç»“æœä¸Šï¼Œå…³æ³¨ç‚¹åœ¨è€Œæ˜¯æˆ‘ä»¬æ²¡æœ‰æ—¶é—´å»åšå¤§äº‹äº†ã€‚</p>          </div><h2 id="å°"><a href="#å°" class="headerlink" title="å°"></a>å°</h2><p><img src="https://tva1.sinaimg.cn/large/005NNTS5ly1gtc325zazej32yo1o0b29.jpg" alt="è‹±é›„è”ç›ŸLOLæ˜Ÿç±æ­Œå§¬ KDA ALL OUT åŒäºº è¨å‹’èŠ¬å¦®"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚æ–‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
